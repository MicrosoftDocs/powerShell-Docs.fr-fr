---
ms.date: 06/12/2017
ms.topic: conceptual
keywords: wmf,powershell,configuration
title: Améliorations apportées à la gestion des packages dans WMF 5.1
ms.openlocfilehash: cb19c2d71391b5729ce9d73fc6b033270f8db307
ms.sourcegitcommit: 6545c60578f7745be015111052fd7769f8289296
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/22/2020
ms.locfileid: "71325116"
---
# <a name="improvements-to-package-management-in-wmf-51"></a><span data-ttu-id="9d579-103">Améliorations apportées à la gestion des packages dans WMF 5.1</span><span class="sxs-lookup"><span data-stu-id="9d579-103">Improvements to Package Management in WMF 5.1</span></span>

<span data-ttu-id="9d579-104">Voici les corrections apportées dans WMF 5.1 :</span><span class="sxs-lookup"><span data-stu-id="9d579-104">The following are the fixes made in the WMF 5.1:</span></span>

## <a name="version-alias"></a><span data-ttu-id="9d579-105">Alias de version</span><span class="sxs-lookup"><span data-stu-id="9d579-105">Version Alias</span></span>

<span data-ttu-id="9d579-106">**Scénario** : Si vous avez installé les versions 1.0 et 2.0 d’un package P1 sur votre système et que vous souhaitez désinstaller la version 1.0, vous devez exécuter `Uninstall-Package -Name P1 -Version 1.0`, et la version 1.0 devrait normalement être désinstallée après l’exécution de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="9d579-106">**Scenario**: If you have version 1.0 and 2.0 of a package, P1, installed on your system, and you want to uninstall version 1.0, you would run `Uninstall-Package -Name P1 -Version 1.0` and expect version 1.0 to be uninstalled after running the cmdlet.</span></span> <span data-ttu-id="9d579-107">Toutefois, le résultat est que la version 2.0 est désinstallée.</span><span class="sxs-lookup"><span data-stu-id="9d579-107">However the result is that version 2.0 gets uninstalled.</span></span>

<span data-ttu-id="9d579-108">Cela se produit, car le paramètre `-Version` est un alias du paramètre `-MinimumVersion`.</span><span class="sxs-lookup"><span data-stu-id="9d579-108">This occurs because the `-Version` parameter is an alias of the `-MinimumVersion` parameter.</span></span> <span data-ttu-id="9d579-109">Quand PackageManagement recherche un package qualifié avec la version minimale 1.0, il retourne la dernière version.</span><span class="sxs-lookup"><span data-stu-id="9d579-109">When PackageManagement is looking for a qualified package with the minimum version of 1.0, it returns the latest version.</span></span> <span data-ttu-id="9d579-110">Ce comportement est attendu dans les cas normaux, car la recherche de la version la plus récente est généralement le résultat souhaité.</span><span class="sxs-lookup"><span data-stu-id="9d579-110">This behavior is expected in normal cases because finding the latest version is usually the desired result.</span></span> <span data-ttu-id="9d579-111">Toutefois, il ne devrait pas s’appliquer en cas d’utilisation de la commande `Uninstall-Package`.</span><span class="sxs-lookup"><span data-stu-id="9d579-111">However, it should not apply to the `Uninstall-Package` case.</span></span>

<span data-ttu-id="9d579-112">**Solution** : L’alias de `-Version` a été entièrement supprimé dans PackageManagement (également appelé</span><span class="sxs-lookup"><span data-stu-id="9d579-112">**Solution**:removed `-Version` alias entirely in PackageManagement (a.k.a.</span></span> <span data-ttu-id="9d579-113">OneGet) et PowerShellGet.</span><span class="sxs-lookup"><span data-stu-id="9d579-113">OneGet) and PowerShellGet.</span></span>

## <a name="multiple-prompts-for-bootstrapping-the-nuget-provider"></a><span data-ttu-id="9d579-114">Invites multiples pour le démarrage du fournisseur NuGet</span><span class="sxs-lookup"><span data-stu-id="9d579-114">Multiple prompts for bootstrapping the NuGet provider</span></span>

<span data-ttu-id="9d579-115">**Scénario** : Quand vous exécutez `Find-Module`, `Install-Module` ou d’autres applets de commande PackageManagement sur votre ordinateur pour la première fois, PackageManagement tente de démarrer le fournisseur NuGet.</span><span class="sxs-lookup"><span data-stu-id="9d579-115">**Scenario**: When you run `Find-Module` or `Install-Module` or other PackageManagement cmdlets on your computer for the first time, PackageManagement tries to bootstrap the NuGet provider.</span></span> <span data-ttu-id="9d579-116">En effet, le fournisseur PowerShellGet utilise également le fournisseur NuGet pour télécharger les modules PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9d579-116">It does this because the PowerShellGet provider also uses the NuGet provider to download PowerShell modules.</span></span>
<span data-ttu-id="9d579-117">PackageManagement invite ensuite l’utilisateur à autoriser l’installation du fournisseur NuGet.</span><span class="sxs-lookup"><span data-stu-id="9d579-117">PackageManagement then prompts the user for permission to install the NuGet provider.</span></span> <span data-ttu-id="9d579-118">Une fois que l’utilisateur a répondu « Oui » à la demande de démarrage, la version la plus récente du fournisseur NuGet est installée.</span><span class="sxs-lookup"><span data-stu-id="9d579-118">After the user selects "yes" for the bootstrapping, the latest version of the NuGet provider will be installed.</span></span>

<span data-ttu-id="9d579-119">Dans certains cas, quand une ancienne version du fournisseur NuGet est installée sur votre ordinateur, celle-ci est parfois chargée en premier dans la session PowerShell (il s’agit de la condition de concurrence dans PackageManagement).</span><span class="sxs-lookup"><span data-stu-id="9d579-119">However, in some cases, when you have an old version of NuGet provider installed on your computer, the older version of NuGet sometimes gets loaded first into the PowerShell session (that's the race condition in PackageManagement).</span></span> <span data-ttu-id="9d579-120">Toutefois, le fonctionnement de PowerShellGet nécessite la dernière version du fournisseur NuGet. Ainsi, PowerShellGet demande à PackageManagement de redémarrer le fournisseur NuGet.</span><span class="sxs-lookup"><span data-stu-id="9d579-120">However PowerShellGet requires the later version of the NuGet provider to work, so PowerShellGet asks PackageManagement to bootstrap the NuGet provider again.</span></span>
<span data-ttu-id="9d579-121">Cela entraîne l’affichage de plusieurs invites de démarrage du fournisseur NuGet.</span><span class="sxs-lookup"><span data-stu-id="9d579-121">This results in multiple prompts for bootstrapping the NuGet provider.</span></span>

<span data-ttu-id="9d579-122">**Solution** : Dans WMF 5.1, PackageManagement charge la dernière version du fournisseur NuGet pour éviter l’affichage de plusieurs invites de démarrage du fournisseur NuGet.</span><span class="sxs-lookup"><span data-stu-id="9d579-122">**Solution**: In WMF5.1, PackageManagement loads the latest version of the NuGet provider to avoid multiple prompts for bootstrapping the NuGet provider.</span></span>

<span data-ttu-id="9d579-123">Vous pouvez également contourner ce problème en supprimant manuellement l’ancienne version du fournisseur NuGet (NuGet-Anycpu.exe), si elle existe, dans $env:ProgramFiles\PackageManagement\ProviderAssemblies $env:LOCALAPPDATA\PackageManagement\ProviderAssemblies.</span><span class="sxs-lookup"><span data-stu-id="9d579-123">You could also work around this issue by manually deleting the old version of the NuGet provider (NuGet-Anycpu.exe) if exists from $env:ProgramFiles\PackageManagement\ProviderAssemblies $env:LOCALAPPDATA\PackageManagement\ProviderAssemblies</span></span>

## <a name="support-for-packagemanagement-on-computers-with-intranet-access-only"></a><span data-ttu-id="9d579-124">Prise en charge de PackageManagement sur les ordinateurs avec accès à l’intranet uniquement</span><span class="sxs-lookup"><span data-stu-id="9d579-124">Support for PackageManagement on computers with Intranet access only</span></span>

<span data-ttu-id="9d579-125">**Scénario** : Pour le scénario d’entreprise, les utilisateurs travaillent dans un environnement où seul un accès à l’intranet est disponible.</span><span class="sxs-lookup"><span data-stu-id="9d579-125">**Scenario**: For the enterprise scenario, people are working under an environment where there is no Internet access but Intranet only.</span></span> <span data-ttu-id="9d579-126">PackageManagement ne prenait pas en charge ce scénario dans WMF 5.0.</span><span class="sxs-lookup"><span data-stu-id="9d579-126">PackageManagement did not support this case in WMF 5.0.</span></span>

<span data-ttu-id="9d579-127">**Scénario** : Dans WMF 5.0, PackageManagement ne prenait pas en charge les ordinateurs ayant uniquement un accès à l’intranet (et non à Internet).</span><span class="sxs-lookup"><span data-stu-id="9d579-127">**Scenario**: In WMF 5.0, PackageManagement did not support computers that have only Intranet (but not Internet) access.</span></span>

<span data-ttu-id="9d579-128">**Solution** : Dans WMF 5.1, procédez comme suit pour permettre aux ordinateurs connectés à l’intranet d’utiliser PackageManagement :</span><span class="sxs-lookup"><span data-stu-id="9d579-128">**Solution**: In WMF 5.1, you can follow these steps to allow Intranet computers to use PackageManagement:</span></span>

1. <span data-ttu-id="9d579-129">Téléchargez le fournisseur NuGet sur un autre ordinateur disposant d’une connexion Internet à l’aide de la commande `Install-PackageProvider -Name NuGet`.</span><span class="sxs-lookup"><span data-stu-id="9d579-129">Download the NuGet provider using another computer that has an Internet connection by using `Install-PackageProvider -Name NuGet`.</span></span>

2. <span data-ttu-id="9d579-130">Recherchez le fournisseur NuGet sous `$env:ProgramFiles\PackageManagement\ProviderAssemblies\nuget` ou `$env:LOCALAPPDATA\PackageManagement\ProviderAssemblies\nuget`.</span><span class="sxs-lookup"><span data-stu-id="9d579-130">Find the NuGet provider under either `$env:ProgramFiles\PackageManagement\ProviderAssemblies\nuget` or `$env:LOCALAPPDATA\PackageManagement\ProviderAssemblies\nuget`.</span></span>

3. <span data-ttu-id="9d579-131">Copiez les fichiers binaires dans un dossier ou un emplacement de partage réseau auquel peut accéder l’ordinateur connecté à l’intranet, puis installez le fournisseur NuGet avec `Install-PackageProvider -Name NuGet -Source <Path to folder>`.</span><span class="sxs-lookup"><span data-stu-id="9d579-131">Copy the binaries to a folder or network share location that the Intranet computer can access, and then install the NuGet provider with `Install-PackageProvider -Name NuGet -Source <Path to folder>`.</span></span>


## <a name="event-logging-improvements"></a><span data-ttu-id="9d579-132">Améliorations de la journalisation des événements</span><span class="sxs-lookup"><span data-stu-id="9d579-132">Event logging improvements</span></span>

<span data-ttu-id="9d579-133">Quand vous installez des packages, vous modifiez l’état de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="9d579-133">When you install packages, you are changing the state of the computer.</span></span> <span data-ttu-id="9d579-134">Dans WMF 5.1, PackageManagement consigne désormais des événements dans le journal des événements Windows pour les activités `Install-Package`, `Uninstall-Package` et `Save-Package`.</span><span class="sxs-lookup"><span data-stu-id="9d579-134">In WMF 5.1, PackageManagement now logs events to the Windows event log for `Install-Package`, `Uninstall-Package`, and `Save-Package` activities.</span></span> <span data-ttu-id="9d579-135">Le journal des événements est le même que pour PowerShell, à savoir `Microsoft-Windows-PowerShell, Operational`.</span><span class="sxs-lookup"><span data-stu-id="9d579-135">The Event log is the same as for PowerShell, that is, `Microsoft-Windows-PowerShell, Operational`.</span></span>

## <a name="support-for-basic-authentication"></a><span data-ttu-id="9d579-136">Prise en charge de l’authentification de base</span><span class="sxs-lookup"><span data-stu-id="9d579-136">Support for basic authentication</span></span>

<span data-ttu-id="9d579-137">Dans WMF 5.1, PackageManagement prend en charge la recherche et l’installation de packages à partir d’un référentiel qui nécessite l’authentification de base.</span><span class="sxs-lookup"><span data-stu-id="9d579-137">In WMF 5.1, PackageManagement supports finding and installing packages from a repository that requires basic authentication.</span></span> <span data-ttu-id="9d579-138">Vous pouvez fournir vos informations d’identification aux applets de commande `Find-Package` et `Install-Package`.</span><span class="sxs-lookup"><span data-stu-id="9d579-138">You can supply your credentials to the `Find-Package` and `Install-Package` cmdlets.</span></span> <span data-ttu-id="9d579-139">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="9d579-139">For example:</span></span>

```powershell
Find-Package -Source <SourceWithCredential> -Credential (Get-Credential)
```

## <a name="support-for-using-packagemanagement-behind-a-proxy"></a><span data-ttu-id="9d579-140">Prise en charge de l’utilisation de PackageManagement derrière un proxy</span><span class="sxs-lookup"><span data-stu-id="9d579-140">Support for using PackageManagement behind a proxy</span></span>

<span data-ttu-id="9d579-141">Dans WMF 5.1, PackageManagement accepte désormais les nouveaux paramètres de proxy `-ProxyCredential` et `-Proxy`.</span><span class="sxs-lookup"><span data-stu-id="9d579-141">In WMF 5.1, PackageManagement now takes new proxy parameters `-ProxyCredential` and `-Proxy`.</span></span> <span data-ttu-id="9d579-142">À l’aide de ces paramètres, vous pouvez spécifier l’URL et les informations d’identification de proxy aux applets de commande PackageManagement.</span><span class="sxs-lookup"><span data-stu-id="9d579-142">Using these parameters, you can specify the proxy URL and credentials to PackageManagement cmdlets.</span></span> <span data-ttu-id="9d579-143">Par défaut, les paramètres proxy du système sont utilisés.</span><span class="sxs-lookup"><span data-stu-id="9d579-143">By default, system proxy settings are used.</span></span> <span data-ttu-id="9d579-144">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="9d579-144">For example:</span></span>

```powershell
Find-Package -Source https://www.nuget.org/api/v2/ -Proxy http://www.myproxyserver.com -ProxyCredential (Get-Credential)
```
