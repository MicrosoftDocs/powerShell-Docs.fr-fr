---
ms.date: 2017-06-05
keywords: powershell,applet de commande
title: "Compréhension du pipeline Windows PowerShell"
ms.assetid: 6be50926-7943-4ef7-9499-4490d72a63fb
ms.openlocfilehash: 6d152e52d2fcfb9dd592eb9ac40500615f2186cb
ms.sourcegitcommit: 74255f0b5f386a072458af058a15240140acb294
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/03/2017
---
# <a name="understanding-the-windows-powershell-pipeline"></a><span data-ttu-id="18e82-103">Compréhension du pipeline Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="18e82-103">Understanding the Windows PowerShell Pipeline</span></span>
<span data-ttu-id="18e82-104">Le piping fonctionne pratiquement partout dans Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="18e82-104">Piping works virtually everywhere in Windows PowerShell.</span></span> <span data-ttu-id="18e82-105">Même si vous voyez du texte à l’écran, Windows PowerShell ne canalise pas de texte entre des commandes.</span><span class="sxs-lookup"><span data-stu-id="18e82-105">Although you see text on the screen, Windows PowerShell does not pipe text between commands.</span></span> <span data-ttu-id="18e82-106">Au lieu de cela, il canalise des objets.</span><span class="sxs-lookup"><span data-stu-id="18e82-106">Instead, it pipes objects.</span></span>

<span data-ttu-id="18e82-107">La notation utilisée pour les pipelines est similaire à celle utilisée dans d’autres interpréteurs de commandes. Ainsi, à première vue, les nouveautés de Windows PowerShell peuvent ne pas sembler évidentes.</span><span class="sxs-lookup"><span data-stu-id="18e82-107">The notation used for pipelines is similar to that used in other shells, so at first glance, it may not be apparent that Windows PowerShell introduces something new.</span></span> <span data-ttu-id="18e82-108">Par exemple, si vous utilisez l’applet de commande **Out-Host** pour forcer un affichage page par page de la sortie d’une autre commande, la sortie ressemble exactement au texte normal affiché à l’écran, mais divisé en pages :</span><span class="sxs-lookup"><span data-stu-id="18e82-108">For example, if you use the **Out-Host** cmdlet to force a page-by-page display of output from another command, the output looks just like the normal text displayed on the screen, broken up into pages:</span></span>

```
PS> Get-ChildItem -Path C:\WINDOWS\System32 | Out-Host -Paging

    Directory: Microsoft.Windows PowerShell.Core\FileSystem::C:\WINDOWS\system32

Mode                LastWriteTime     Length Name
----                -------------     ------ ----
-a---        2005-10-22  11:04 PM        315 $winnt$.inf
-a---        2004-08-04   8:00 AM      68608 access.cpl
-a---        2004-08-04   8:00 AM      64512 acctres.dll
-a---        2004-08-04   8:00 AM     183808 accwiz.exe
-a---        2004-08-04   8:00 AM      61952 acelpdec.ax
-a---        2004-08-04   8:00 AM     129536 acledit.dll
-a---        2004-08-04   8:00 AM     114688 aclui.dll
-a---        2004-08-04   8:00 AM     194048 activeds.dll
-a---        2004-08-04   8:00 AM     111104 activeds.tlb
-a---        2004-08-04   8:00 AM       4096 actmovie.exe
-a---        2004-08-04   8:00 AM     101888 actxprxy.dll
-a---        2003-02-21   6:50 PM     143150 admgmt.msc
-a---        2006-01-25   3:35 PM      53760 admparse.dll
<SPACE> next page; <CR> next line; Q quit
...
```

<span data-ttu-id="18e82-109">La commande Out-Host -Paging est un élément de pipeline utile chaque fois que vous avez une sortie longue que vous souhaitez afficher lentement.</span><span class="sxs-lookup"><span data-stu-id="18e82-109">The Out-Host -Paging command is a useful pipeline element whenever you have lengthy output that you would like to display slowly.</span></span> <span data-ttu-id="18e82-110">Elle est particulièrement utile si l’opération nécessite une utilisation importante du processeur.</span><span class="sxs-lookup"><span data-stu-id="18e82-110">It is especially useful if the operation is very CPU-intensive.</span></span> <span data-ttu-id="18e82-111">Étant donné que le traitement est transféré à l’applet de commande Out-Host quand une page complète est prête pour affichage, les applets de commande précédentes dans le pipeline suspendent l’opération jusqu’à ce que la page de sortie suivante est disponible.</span><span class="sxs-lookup"><span data-stu-id="18e82-111">Because processing is transferred to the Out-Host cmdlet when it has a complete page ready to display, cmdlets that precede it in the pipeline halt operation until the next page of output is available.</span></span> <span data-ttu-id="18e82-112">Vous pouvez voir cela si vous utilisez le Gestionnaire des tâches de Windows pour surveiller l’utilisation du processeur et de la mémoire par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="18e82-112">You can see this if you use the Windows Task Manager to monitor CPU and memory use by Windows PowerShell.</span></span>

<span data-ttu-id="18e82-113">Exécutez la commande suivante : **Get-ChildItem C:\\Windows -Recurse**.</span><span class="sxs-lookup"><span data-stu-id="18e82-113">Run the following command: **Get-ChildItem C:\\Windows -Recurse**.</span></span> <span data-ttu-id="18e82-114">Comparez l’utilisation du processeur et de la mémoire à la sortie de la commande suivante : **Get-ChildItem C:\\Windows -Recurse | Out-Host -Paging**.</span><span class="sxs-lookup"><span data-stu-id="18e82-114">Compare the CPU and memory usage to this command: **Get-ChildItem C:\\Windows -Recurse | Out-Host -Paging**.</span></span> <span data-ttu-id="18e82-115">Si ce que vous voyez à l’écran est du texte, c’est parce qu’il est de nécessaire représenter les objets sous forme de texte dans une fenêtre de console.</span><span class="sxs-lookup"><span data-stu-id="18e82-115">What you see on the screen is text, but that is because it is necessary to represent objects as text in a console window.</span></span> <span data-ttu-id="18e82-116">Il s’agit juste d’une représentation de ce qui se passe vraiment dans Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="18e82-116">This is just a representation of what is really going on inside Windows PowerShell.</span></span> <span data-ttu-id="18e82-117">Par exemple, considérez l’applet de commande Get-Location.</span><span class="sxs-lookup"><span data-stu-id="18e82-117">For example, consider the Get-Location cmdlet.</span></span> <span data-ttu-id="18e82-118">Si vous tapez **Get-Location** alors que votre emplacement actuel est la racine du lecteur C, la sortie est la suivante :</span><span class="sxs-lookup"><span data-stu-id="18e82-118">If you type **Get-Location** while your current location is the root of the C drive, you would see the following output:</span></span>

```
PS> Get-Location

Path
----
C:\
```

<span data-ttu-id="18e82-119">Si le texte figure dans un pipeline Windows PowerShell, l’émission d’une commande telle que **Get-Location | Out-Host** a pour effet de transmettre de **Get-Location** à **Out-Host** un jeu de caractères dans l’ordre de leur affichage à l’écran.</span><span class="sxs-lookup"><span data-stu-id="18e82-119">If Windows PowerShell pipelined text, issuing a command such as **Get-Location | Out-Host**, would pass from **Get-Location** to **Out-Host** a set of characters in the order they are displayed onscreen.</span></span> <span data-ttu-id="18e82-120">En d’autres termes, si vous deviez ignorer les informations d’en-tête, **Out-Host** recevrait d’abord le caractère « **C »**, puis le caractère « **: »**, puis le caractère '**\\'**.</span><span class="sxs-lookup"><span data-stu-id="18e82-120">In other words, if you were to ignore the heading information, **Out-Host** would first receive the character '**C'**, then the character '**:'**, then the character '**\\'**.</span></span> <span data-ttu-id="18e82-121">Il se pourrait que l’applet de commande **Out-Host** ne puisse pas déterminer quelle signification associer à la sortie de caractères par l’applet de commande **Get-Location**.</span><span class="sxs-lookup"><span data-stu-id="18e82-121">The **Out-Host** cmdlet could not determine what meaning to associate with the characters output by the **Get-Location** cmdlet.</span></span>

<span data-ttu-id="18e82-122">Au lieu d’utiliser du texte pour vous permettre aux commandes dans un pipeline de communiquer, Windows PowerShell utilise des objets.</span><span class="sxs-lookup"><span data-stu-id="18e82-122">Instead of using text to let commands in a pipeline communicate, Windows PowerShell uses objects.</span></span> <span data-ttu-id="18e82-123">Du point de vue d’un utilisateur, les objets empaquètent des informations connexes sous une forme facilitant la manipulation des informations en tant qu’unité, et l’extraction des éléments spécifiques dont vous avez besoin.</span><span class="sxs-lookup"><span data-stu-id="18e82-123">From the standpoint of a user, objects package related information into a form that makes it easier to manipulate the information as a unit, and extract specific items that you need.</span></span>

<span data-ttu-id="18e82-124">La commande **Get-Location** ne retourne pas de texte contenant le chemin d’accès actuel.</span><span class="sxs-lookup"><span data-stu-id="18e82-124">The **Get-Location** command does not return text that contains the current path.</span></span> <span data-ttu-id="18e82-125">Elle retourne un ensemble d’informations appelé objet **PathInfo**, qui contient le chemin d’accès actuel, ainsi que d’autres informations.</span><span class="sxs-lookup"><span data-stu-id="18e82-125">It returns a package of information called a **PathInfo** object that contains the current path along with some other information.</span></span> <span data-ttu-id="18e82-126">L’applet de commande **Out-Host** envoie ensuite cet objet **PathInfo** à l’écran, tandis que Windows PowerShell choisit les informations à afficher et leur mode d’affichage en fonction de ses règles de mise en forme.</span><span class="sxs-lookup"><span data-stu-id="18e82-126">The **Out-Host** cmdlet then sends this **PathInfo** object to the screen, and Windows PowerShell decides what information to display and how to display it based on its formatting rules.</span></span>

<span data-ttu-id="18e82-127">En fait, les informations d’en-tête retournées par l’applet de commande **Get-Location** ne sont ajoutées qu’à la fin du processus, dans le cadre de la mise en forme des données à afficher à l’écran.</span><span class="sxs-lookup"><span data-stu-id="18e82-127">In fact, the heading information output by the **Get-Location** cmdlet is added only at the end of the process, as part of the process of formatting the data for onscreen display.</span></span> <span data-ttu-id="18e82-128">Ce que vous voyez à l’écran est un résumé des informations, non une représentation complète de l’objet de sortie.</span><span class="sxs-lookup"><span data-stu-id="18e82-128">What you see onscreen is a summary of information, and not a complete representation of the output object.</span></span>

<span data-ttu-id="18e82-129">Étant donné qu’il peut y avoir plus d’informations générées par une commande Windows PowerShell que ce que nous voyons dans la fenêtre de console, comment récupérer les éléments invisibles ?</span><span class="sxs-lookup"><span data-stu-id="18e82-129">Given that there may be more information output from a Windows PowerShell command than what we see displayed in the console window, how can you retrieve the non-visible elements?</span></span> <span data-ttu-id="18e82-130">Comment afficher les données supplémentaires ?</span><span class="sxs-lookup"><span data-stu-id="18e82-130">How do you view the extra data?</span></span> <span data-ttu-id="18e82-131">Et que se passe-t-il si vous souhaitez afficher les données dans un format différent de celui que Windows PowerShell utilise normalement ?</span><span class="sxs-lookup"><span data-stu-id="18e82-131">And what if you want to view the data in a format different than the one Windows PowerShell normally uses?</span></span>

<span data-ttu-id="18e82-132">Le reste de ce chapitre explique comment découvrir la structure d’objets Windows PowerShell spécifiques, en sélectionnant des éléments et en les mettant en forme pour un affichage plus facile, ainsi que comment envoyer ces informations à d’autres emplacements de sortie tels que des fichiers et des imprimantes.</span><span class="sxs-lookup"><span data-stu-id="18e82-132">The rest of this chapter discusses how you can discover the structure of specific Windows PowerShell objects, selecting specific items and formatting them for easier display, and how to send this information to alternative output locations such as files and printers.</span></span>

