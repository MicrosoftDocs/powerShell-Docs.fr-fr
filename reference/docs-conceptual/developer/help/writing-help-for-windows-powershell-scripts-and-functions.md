---
title: Écriture de l’aide pour les scripts et fonctions PowerShell
ms.date: 09/13/2016
ms.openlocfilehash: 381c501d87b7381075f89412f654c6121493856e
ms.sourcegitcommit: de59ff77c6535fc772c1e327b3c823295eaed6ea
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/22/2020
ms.locfileid: "86892912"
---
# <a name="writing-help-for-powershell-scripts-and-functions"></a><span data-ttu-id="6c5d8-102">Écriture de l’aide pour les scripts et fonctions PowerShell</span><span class="sxs-lookup"><span data-stu-id="6c5d8-102">Writing Help for PowerShell Scripts and Functions</span></span>

<span data-ttu-id="6c5d8-103">Les scripts et les fonctions PowerShell doivent être entièrement documentés chaque fois qu’ils sont partagés avec d’autres utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-103">PowerShell scripts and functions should be fully documented whenever they are shared with others.</span></span>
<span data-ttu-id="6c5d8-104">L' `Get-Help` applet de commande affiche les rubriques d’aide script et fonction dans le même format que celui dans lequel elle affiche l’aide pour les applets de commande, et tous les `Get-Help` paramètres fonctionnent sur des rubriques d’aide sur les scripts et les fonctions.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-104">The `Get-Help` cmdlet displays the script and function help topics in the same format as it displays help for cmdlets, and all of the `Get-Help` parameters work on script and function help topics.</span></span>

<span data-ttu-id="6c5d8-105">Les scripts PowerShell peuvent inclure une rubrique d’aide sur le script et des rubriques d’aide sur chaque fonction dans le script.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-105">PowerShell scripts can include a help topic about the script and help topics about each functions in the script.</span></span> <span data-ttu-id="6c5d8-106">Les fonctions partagées indépendamment des scripts peuvent inclure leurs propres rubriques d’aide.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-106">Functions that are shared independently of scripts can include their own help topics.</span></span>

<span data-ttu-id="6c5d8-107">Ce document explique le format et le positionnement correct des rubriques d’aide, et propose des instructions pour le contenu.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-107">This document explains the format and correct placement of the help topics, and it suggests guidelines for the content.</span></span>

## <a name="types-of-script-and-function-help"></a><span data-ttu-id="6c5d8-108">Types d’aide sur les scripts et les fonctions</span><span class="sxs-lookup"><span data-stu-id="6c5d8-108">Types of Script and Function Help</span></span>

### <a name="comment-based-help"></a><span data-ttu-id="6c5d8-109">Aide basée sur les commentaires</span><span class="sxs-lookup"><span data-stu-id="6c5d8-109">Comment-Based Help</span></span>

<span data-ttu-id="6c5d8-110">La rubrique d’aide qui décrit un script ou une fonction peut être implémentée sous la forme d’un ensemble de commentaires dans le script ou la fonction.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-110">The help topic that describes a script or function can be implemented as a set of comments within the script or function.</span></span> <span data-ttu-id="6c5d8-111">Quand vous écrivez une aide basée sur des commentaires pour un script et des fonctions dans un script, faites attention aux règles de placement de l’aide basée sur les commentaires.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-111">When writing comment-based help for a script and for functions in a script, pay careful attention to the rules for placing the comment-based help.</span></span> <span data-ttu-id="6c5d8-112">Le positionnement détermine si l' `Get-Help` applet de commande associe la rubrique d’aide au script ou à une fonction.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-112">The placement determines whether the `Get-Help` cmdlet associates the help topic with the script or a function.</span></span> <span data-ttu-id="6c5d8-113">Pour plus d’informations sur l’écriture de rubriques d’aide basées sur des commentaires, consultez [about_Comment_Based_Help](/powershell/module/microsoft.powershell.core/about/about_comment_based_help).</span><span class="sxs-lookup"><span data-stu-id="6c5d8-113">For more information about writing comment-based help topics, see [about_Comment_Based_Help](/powershell/module/microsoft.powershell.core/about/about_comment_based_help).</span></span>

### <a name="xml-based-command-help"></a><span data-ttu-id="6c5d8-114">Aide sur les commandes basées sur XML</span><span class="sxs-lookup"><span data-stu-id="6c5d8-114">XML-Based Command Help</span></span>

<span data-ttu-id="6c5d8-115">La rubrique d’aide qui décrit un script ou une fonction peut être implémentée dans un fichier XML qui utilise le schéma de l’aide de la commande.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-115">The help topic that describes a script or function can be implemented in an XML file that uses the command help schema.</span></span> <span data-ttu-id="6c5d8-116">Pour associer le script ou la fonction au fichier XML, utilisez le `ExternalHelp` mot clé comment, suivi du chemin d’accès et du nom du fichier XML.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-116">To associate the script or function with the XML file, use the `ExternalHelp` comment keyword followed by the path and name of the XML file.</span></span>

<span data-ttu-id="6c5d8-117">Lorsque le `ExternalHelp` mot clé comment est présent, il est prioritaire par rapport à l’aide basée sur les commentaires, même si `Get-Help` ne trouve pas un fichier d’aide qui correspond à la valeur du `ExternalHelp` mot clé.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-117">When the `ExternalHelp` comment keyword is present, it takes precedence over comment-based help, even when `Get-Help` cannot find a help file that matches the value of the `ExternalHelp` keyword.</span></span>

### <a name="online-help"></a><span data-ttu-id="6c5d8-118">Aide en ligne</span><span class="sxs-lookup"><span data-stu-id="6c5d8-118">Online Help</span></span>

<span data-ttu-id="6c5d8-119">Vous pouvez poster vos rubriques d’aide sur Internet, puis vous diriger `Get-Help` vers pour ouvrir les rubriques.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-119">You can post your help topics on the internet and then direct `Get-Help` to open the topics.</span></span> <span data-ttu-id="6c5d8-120">Pour plus d’informations sur l’écriture de rubriques d’aide basées sur des commentaires, consultez [prise en charge de l’aide en ligne](../module/supporting-online-help.md).</span><span class="sxs-lookup"><span data-stu-id="6c5d8-120">For more information about writing comment-based help topics, see [Supporting Online Help](../module/supporting-online-help.md).</span></span>

<span data-ttu-id="6c5d8-121">Il n’existe aucune méthode établie pour écrire des rubriques conceptuelles (« à propos de ») pour les scripts et les fonctions.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-121">There is no established method for writing conceptual ("About") topics for scripts and functions.</span></span>
<span data-ttu-id="6c5d8-122">Toutefois, vous pouvez poster des rubriques conceptuelles sur Internet Lister les rubriques et leurs URL dans la section Liens connexes d’une rubrique d’aide de la commande.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-122">However, you can post conceptual topics on the internet list the topics and their URLs in the Related Links section of a command help topic.</span></span>

## <a name="content-considerations-for-script-and-function-help"></a><span data-ttu-id="6c5d8-123">Considérations sur le contenu pour l’aide sur les scripts et les fonctions</span><span class="sxs-lookup"><span data-stu-id="6c5d8-123">Content Considerations for Script and Function Help</span></span>

- <span data-ttu-id="6c5d8-124">Si vous écrivez une très brève rubrique d’aide avec seulement quelques-unes des sections de l’aide sur les commandes disponibles, veillez à inclure des descriptions claires des paramètres du script ou de la fonction.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-124">If you are writing a very brief help topic with only a few of the available command help sections, be sure to include clear descriptions of the script or function parameters.</span></span> <span data-ttu-id="6c5d8-125">Incluez également un ou deux exemples de commandes dans la section exemples, même si vous décidez d’omettre les exemples de descriptions.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-125">Also include one or two sample commands in the examples section, even if you decide to omit example descriptions.</span></span>

- <span data-ttu-id="6c5d8-126">Dans toutes les descriptions, reportez-vous à la commande sous la forme d’un script ou d’une fonction.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-126">In all descriptions, refer to the command as a script or function.</span></span> <span data-ttu-id="6c5d8-127">Ces informations permettent à l’utilisateur de comprendre et de gérer la commande.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-127">This information helps the user to understand and manage the command.</span></span>

  <span data-ttu-id="6c5d8-128">Par exemple, la description détaillée suivante indique que la commande New-topic est un script.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-128">For example, the following detailed description states that the New-Topic command is a script.</span></span>
  <span data-ttu-id="6c5d8-129">Cela rappelle aux utilisateurs qu’ils doivent spécifier le chemin d’accès et le nom complet lorsqu’ils l’exécutent.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-129">This reminds users that they need to specify the path and full name when they run it.</span></span>

  > <span data-ttu-id="6c5d8-130">« Le script New-topic crée une rubrique conceptuelle vide pour chaque nom de rubrique dans le fichier d’entrée... »</span><span class="sxs-lookup"><span data-stu-id="6c5d8-130">"The New-Topic script creates a blank conceptual topic for each topic name in the input file..."</span></span>

  <span data-ttu-id="6c5d8-131">La description détaillée suivante indique qu' `Disable-PSRemoting` il s’agit d’une fonction.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-131">The following detailed description states that `Disable-PSRemoting` is a function.</span></span> <span data-ttu-id="6c5d8-132">Ces informations sont particulièrement utiles aux utilisateurs lorsque la session comprend plusieurs commandes portant le même nom, dont certaines peuvent être masquées par une commande avec une priorité plus élevée.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-132">This information is particularly useful to users when the session includes multiple commands with the same name, some of which might be hidden by a command with higher precedence.</span></span>

  > <span data-ttu-id="6c5d8-133">La `Disable-PSRemoting` fonction désactive toutes les configurations de session sur l’ordinateur local...</span><span class="sxs-lookup"><span data-stu-id="6c5d8-133">The `Disable-PSRemoting` function disables all session configurations on the local computer...</span></span>

- <span data-ttu-id="6c5d8-134">Dans une rubrique d’aide sur les scripts, explique comment utiliser le script dans son ensemble.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-134">In a script help topic, explain how to use the script as a whole.</span></span> <span data-ttu-id="6c5d8-135">Si vous écrivez également des rubriques d’aide pour les fonctions dans le script, mentionnez les fonctions dans la rubrique d’aide de votre script et incluez des références aux rubriques d’aide de la fonction dans la section Liens connexes de la rubrique d’aide de script.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-135">If you are also writing help topics for functions in the script, mention the functions in your script help topic and include references to the function help topics in the Related Links section of the script help topic.</span></span>
  <span data-ttu-id="6c5d8-136">À l’inverse, lorsqu’une fonction fait partie d’un script, expliquez dans la rubrique d’aide de la fonction le rôle joué par la fonction dans le script et la manière dont elle peut être utilisée de manière indépendante.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-136">Conversely, when a function is part of a script, explain in the function help topic the role that the function plays in the script and how it might be used independently.</span></span> <span data-ttu-id="6c5d8-137">Ensuite, répertoriez la rubrique d’aide sur les scripts dans la section Liens connexes de la rubrique d’aide de la fonction.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-137">Then list the script help topic in the Related Links section of the function help topic.</span></span>

- <span data-ttu-id="6c5d8-138">Lorsque vous écrivez des exemples pour une rubrique d’aide sur un script, veillez à inclure le chemin d’accès au fichier de script dans l’exemple de commande.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-138">When writing examples for a script help topic, be sure to include the path to the script file in the example command.</span></span> <span data-ttu-id="6c5d8-139">Cela rappelle aux utilisateurs qu’ils doivent spécifier le chemin d’accès explicitement, même si le script se trouve dans le répertoire actif.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-139">This reminds users that they must specify the path explicitly, even when the script is in the current directory.</span></span>

- <span data-ttu-id="6c5d8-140">Dans une rubrique d’aide sur une fonction, Rappelez aux utilisateurs que la fonction existe uniquement dans la session active et, pour l’utiliser dans d’autres sessions, elle doit l’ajouter ou l’ajouter à un profil PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-140">In a function help topic, remind users that the function exists only in the current session and, to use it in other sessions, they need to add it, or add it a PowerShell profile.</span></span>

- <span data-ttu-id="6c5d8-141">`Get-Help`affiche la rubrique d’aide d’un script ou d’une fonction uniquement lorsque le fichier de script et les fichiers de rubrique d’aide sont enregistrés dans les emplacements appropriés.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-141">`Get-Help` displays the help topic for a script or function only when the script file and help topic files are saved in the correct locations.</span></span> <span data-ttu-id="6c5d8-142">Par conséquent, il n’est pas utile d’inclure des instructions pour l’installation de PowerShell ou l’enregistrement ou l’installation du script ou de la fonction dans une rubrique d’aide sur un script ou une fonction.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-142">Therefore, it is not useful to include instructions for installing PowerShell, or saving or installing the script or function in a script or function help topic.</span></span> <span data-ttu-id="6c5d8-143">Au lieu de cela, incluez toutes les instructions d’installation dans le document que vous utilisez pour distribuer le script ou la fonction.</span><span class="sxs-lookup"><span data-stu-id="6c5d8-143">Instead, include any installation instructions in the document that you use to distribute the script or function.</span></span>

## <a name="see-also"></a><span data-ttu-id="6c5d8-144">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6c5d8-144">See Also</span></span>

[<span data-ttu-id="6c5d8-145">Écriture de rubriques d’aide basée sur les commentaires</span><span class="sxs-lookup"><span data-stu-id="6c5d8-145">Writing Comment-Based Help Topics</span></span>](./writing-comment-based-help-topics.md)
