---
title: Création d’un fournisseur de contenu Windows PowerShell
ms.date: 09/13/2016
ms.topic: article
ms.assetid: 3da88ff9-c4c7-4ace-aa24-0a29c8cfa060
ms.openlocfilehash: 149ddb5becf2e0237973e535323ddf8b03b86f24
ms.sourcegitcommit: 30ccbbb32915b551c4cd4c91ef1df96b5b7514c4
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/01/2020
ms.locfileid: "80500835"
---
# <a name="creating-a-windows-powershell-content-provider"></a><span data-ttu-id="6cccc-102">Création d’un fournisseur de contenu Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6cccc-102">Creating a Windows PowerShell Content Provider</span></span>

<span data-ttu-id="6cccc-103">Cette rubrique explique comment créer un fournisseur Windows PowerShell qui permet à l’utilisateur de manipuler le contenu des éléments dans un magasin de données.</span><span class="sxs-lookup"><span data-stu-id="6cccc-103">This topic describes how to create a Windows PowerShell provider that enables the user to manipulate the contents of the items in a data store.</span></span> <span data-ttu-id="6cccc-104">Par conséquent, un fournisseur qui peut manipuler le contenu des éléments est appelé fournisseur de contenu Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6cccc-104">As a consequence, a provider that can manipulate the contents of items is referred to as a Windows PowerShell content provider.</span></span>

> [!NOTE]
> <span data-ttu-id="6cccc-105">Vous pouvez télécharger le C# fichier source (AccessDBSampleProvider06.cs) pour ce fournisseur à l’aide du kit de développement logiciel (SDK) Microsoft Windows pour Windows Vista et .NET Framework les composants d’exécution 3,0.</span><span class="sxs-lookup"><span data-stu-id="6cccc-105">You can download the C# source file (AccessDBSampleProvider06.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="6cccc-106">Pour obtenir des instructions de téléchargement, consultez [Comment installer Windows PowerShell et télécharger le kit de développement logiciel (SDK) Windows PowerShell](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="6cccc-106">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="6cccc-107">Les fichiers sources téléchargés sont disponibles dans le répertoire des **exemples de >\<PowerShell** .</span><span class="sxs-lookup"><span data-stu-id="6cccc-107">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="6cccc-108">Pour plus d’informations sur les autres implémentations du fournisseur Windows PowerShell, consultez [conception de votre fournisseur Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6cccc-108">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

## <a name="define-the-windows-powershell-content-provider-class"></a><span data-ttu-id="6cccc-109">Définir la classe de fournisseur de contenu Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6cccc-109">Define the Windows PowerShell Content Provider Class</span></span>

<span data-ttu-id="6cccc-110">Un fournisseur de contenu Windows PowerShell doit créer une classe .NET qui prend en charge l’interface [System. Management. Automation. Provider. Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-110">A Windows PowerShell content provider must create a .NET class that supports the [System.Management.Automation.Provider.Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider) interface.</span></span> <span data-ttu-id="6cccc-111">Voici la définition de classe pour le fournisseur d’éléments décrit dans cette section.</span><span class="sxs-lookup"><span data-stu-id="6cccc-111">Here is the class definition for the item provider described in this section.</span></span>

[!code-csharp[AccessDBProviderSample06.cs](~/powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L32-L33 "AccessDBProviderSample06.cs")]

<span data-ttu-id="6cccc-112">Notez que dans cette définition de classe, l’attribut [System. Management. Automation. Provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) comprend deux paramètres.</span><span class="sxs-lookup"><span data-stu-id="6cccc-112">Note that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="6cccc-113">Le premier paramètre spécifie un nom convivial pour le fournisseur qui est utilisé par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6cccc-113">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="6cccc-114">Le deuxième paramètre spécifie les fonctionnalités spécifiques de Windows PowerShell que le fournisseur expose au runtime Windows PowerShell pendant le traitement de la commande.</span><span class="sxs-lookup"><span data-stu-id="6cccc-114">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="6cccc-115">Pour ce fournisseur, aucune fonctionnalité spécifique de Windows PowerShell n’est ajoutée.</span><span class="sxs-lookup"><span data-stu-id="6cccc-115">For this provider, there are no added Windows PowerShell specific capabilities.</span></span>

## <a name="define-functionality-of-base-class"></a><span data-ttu-id="6cccc-116">Définir les fonctionnalités de la classe de base</span><span class="sxs-lookup"><span data-stu-id="6cccc-116">Define Functionality of Base Class</span></span>

<span data-ttu-id="6cccc-117">Comme décrit dans [concevoir votre fournisseur Windows PowerShell](./designing-your-windows-powershell-provider.md), la classe [System. Management. Automation. Provider. Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) dérive de plusieurs autres classes qui offraient des fonctionnalités de fournisseur différentes.</span><span class="sxs-lookup"><span data-stu-id="6cccc-117">As described in [Design Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="6cccc-118">Un fournisseur de contenu Windows PowerShell définit donc généralement toutes les fonctionnalités fournies par ces classes.</span><span class="sxs-lookup"><span data-stu-id="6cccc-118">A Windows PowerShell content provider, therefore, typically defines all of the functionality provided by those classes.</span></span>

<span data-ttu-id="6cccc-119">Pour plus d’informations sur la façon d’implémenter des fonctionnalités pour ajouter des informations d’initialisation spécifiques à la session et pour libérer les ressources utilisées par le fournisseur, consultez [création d’un fournisseur Windows PowerShell de base](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6cccc-119">For more information about how to implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span>
<span data-ttu-id="6cccc-120">Toutefois, la plupart des fournisseurs, y compris le fournisseur décrit ici, peuvent utiliser l’implémentation par défaut de cette fonctionnalité fournie par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6cccc-120">However, most providers, including the provider described here, can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="6cccc-121">Pour accéder au magasin de données, le fournisseur doit implémenter les méthodes de la classe de base [System. Management. Automation. Provider. Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-121">To access the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="6cccc-122">Pour plus d’informations sur l’implémentation de ces méthodes, consultez [création d’un fournisseur de lecteurs Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6cccc-122">For more information about implementing these methods, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="6cccc-123">Pour manipuler les éléments d’un magasin de données, tels que l’obtention, la définition et l’effacement des éléments, le fournisseur doit implémenter les méthodes fournies par la classe de base [System. Management. Automation. Provider. Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-123">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="6cccc-124">Pour plus d’informations sur l’implémentation de ces méthodes, consultez [création d’un fournisseur d’éléments Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6cccc-124">For more information about implementing these methods, see [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

<span data-ttu-id="6cccc-125">Pour travailler sur des magasins de données multicouches, le fournisseur doit implémenter les méthodes fournies par la classe de base [System. Management. Automation. Provider. Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-125">To work on multi-layer data stores, the provider must implement the methods provided by the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="6cccc-126">Pour plus d’informations sur l’implémentation de ces méthodes, consultez [création d’un fournisseur de conteneurs Windows PowerShell](./creating-a-windows-powershell-container-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6cccc-126">For more information about implementing these methods, see [Creating a Windows PowerShell Container Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

<span data-ttu-id="6cccc-127">Pour prendre en charge les commandes récursives, les conteneurs imbriqués et les chemins d’accès relatifs, le fournisseur doit implémenter la classe de base [System. Management. Automation. Provider. Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-127">To support recursive commands, nested containers, and relative paths, the provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class.</span></span> <span data-ttu-id="6cccc-128">En outre, ce fournisseur de contenu Windows PowerShell peut attacher l’interface [System. Management. Automation. Provider. Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider) à la classe de base [System. Management. Automation. Provider. Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) et doit donc implémenter les méthodes fournies par cette classe.</span><span class="sxs-lookup"><span data-stu-id="6cccc-128">In addition, this Windows PowerShell content provider can attaches [System.Management.Automation.Provider.Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider) interface to the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class, and must therefore implement the methods provided by that class.</span></span> <span data-ttu-id="6cccc-129">Pour plus d’informations, consultez Implémentation de ces méthodes, consultez [implémentation d’un fournisseur Windows PowerShell de navigation](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6cccc-129">For more information, see implementing those methods, see [Implement a Navigation Windows PowerShell Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

## <a name="implementing-a-content-reader"></a><span data-ttu-id="6cccc-130">Implémentation d’un lecteur de contenu</span><span class="sxs-lookup"><span data-stu-id="6cccc-130">Implementing a Content Reader</span></span>

<span data-ttu-id="6cccc-131">Pour lire le contenu d’un élément, un fournisseur doit implémenter une classe de lecteur de contenu qui dérive de [System. Management. Automation. Provider. Icontentreader](/dotnet/api/System.Management.Automation.Provider.IContentReader).</span><span class="sxs-lookup"><span data-stu-id="6cccc-131">To read content from an item, a provider must implements a content reader class that derives from [System.Management.Automation.Provider.Icontentreader](/dotnet/api/System.Management.Automation.Provider.IContentReader).</span></span>
<span data-ttu-id="6cccc-132">Le lecteur de contenu pour ce fournisseur autorise l’accès au contenu d’une ligne dans une table de données.</span><span class="sxs-lookup"><span data-stu-id="6cccc-132">The content reader for this provider allows access to the contents of a row in a data table.</span></span> <span data-ttu-id="6cccc-133">La classe de lecteur de contenu définit une méthode de **lecture** qui récupère les données de la ligne indiquée et retourne une liste qui représente ces données, une méthode **Seek** qui déplace le lecteur de contenu, une méthode **Close** qui ferme le lecteur de contenu et une méthode **dispose** .</span><span class="sxs-lookup"><span data-stu-id="6cccc-133">The content reader class defines a **Read** method that retrieves the data from the indicated row and returns a list representing that data, a **Seek** method that moves the content reader, a **Close** method that closes the content reader, and a **Dispose** method.</span></span>

[!code-csharp[AccessDBProviderSample06.cs](~/powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L2115-L2241
"AccessDBProviderSample06.cs")]

## <a name="implementing-a-content-writer"></a><span data-ttu-id="6cccc-134">Implémentation d’un writer de contenu</span><span class="sxs-lookup"><span data-stu-id="6cccc-134">Implementing a Content Writer</span></span>

<span data-ttu-id="6cccc-135">Pour écrire du contenu dans un élément, un fournisseur doit implémenter une classe de writer de contenu dérivée de [System. Management. Automation. Provider. Icontentwriter](/dotnet/api/System.Management.Automation.Provider.IContentWriter).</span><span class="sxs-lookup"><span data-stu-id="6cccc-135">To write content to an item, a provider must implement a content writer class derives from [System.Management.Automation.Provider.Icontentwriter](/dotnet/api/System.Management.Automation.Provider.IContentWriter).</span></span>
<span data-ttu-id="6cccc-136">La classe du writer de contenu définit une méthode d' **écriture** qui écrit le contenu de ligne spécifié, une méthode **Seek** qui déplace le writer de contenu, une méthode **Close** qui ferme le writer de contenu et une méthode **dispose** .</span><span class="sxs-lookup"><span data-stu-id="6cccc-136">The content writer class defines a **Write** method that writes the specified row content, a **Seek** method that moves the content writer, a **Close** method that closes the content writer, and a **Dispose** method.</span></span>

[!code-csharp[AccessDBProviderSample06.cs](~/powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L2250-L2394 "AccessDBProviderSample06.cs")]

## <a name="retrieving-the-content-reader"></a><span data-ttu-id="6cccc-137">Récupération du lecteur de contenu</span><span class="sxs-lookup"><span data-stu-id="6cccc-137">Retrieving the Content Reader</span></span>

<span data-ttu-id="6cccc-138">Pour récupérer du contenu à partir d’un élément, le fournisseur doit implémenter [System. Management. Automation. Provider. Icontentcmdletprovider. GetContentReader \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) pour prendre en charge l’applet de commande `Get-Content`.</span><span class="sxs-lookup"><span data-stu-id="6cccc-138">To get content from an item, the provider must implement the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) to support the `Get-Content` cmdlet.</span></span> <span data-ttu-id="6cccc-139">Cette méthode retourne le lecteur de contenu pour l’élément situé dans le chemin d’accès spécifié.</span><span class="sxs-lookup"><span data-stu-id="6cccc-139">This method returns the content reader for the item located at the specified path.</span></span> <span data-ttu-id="6cccc-140">L’objet lecteur peut ensuite être ouvert pour lire le contenu.</span><span class="sxs-lookup"><span data-stu-id="6cccc-140">The reader object can then be opened to read the content.</span></span>

<span data-ttu-id="6cccc-141">Voici l’implémentation de [System. Management. Automation. Provider. Icontentcmdletprovider. GetContentReader \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) pour cette méthode pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="6cccc-141">Here is the implementation of [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) for this method for this provider.</span></span>

```csharp
public IContentReader GetContentReader(string path)
{
    string tableName;
    int rowNumber;

    PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

    if (type == PathType.Invalid)
    {
        ThrowTerminatingInvalidPathException(path);
    }
    else if (type == PathType.Row)
    {
        throw new InvalidOperationException("contents can be obtained only for tables");
    }

    return new AccessDBContentReader(path, this);
} // GetContentReader
```

[!code-csharp[AccessDBProviderSample06.cs](~/powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1829-L1846 "AccessDBProviderSample06.cs")]

#### <a name="things-to-remember-about-implementing-getcontentreader"></a><span data-ttu-id="6cccc-142">Points à retenir concernant l’implémentation de GetContentReader</span><span class="sxs-lookup"><span data-stu-id="6cccc-142">Things to Remember About Implementing GetContentReader</span></span>

<span data-ttu-id="6cccc-143">Les conditions suivantes peuvent s’appliquer à une implémentation de [System. Management. Automation. Provider. Icontentcmdletprovider. GetContentReader \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader):</span><span class="sxs-lookup"><span data-stu-id="6cccc-143">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader):</span></span>

- <span data-ttu-id="6cccc-144">Lors de la définition de la classe de fournisseur, un fournisseur de contenu Windows PowerShell peut déclarer des fonctionnalités de fournisseur de ExpandWildcards, Filter, include ou Exclude, à partir de l’énumération [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-144">When defining the provider class, a Windows PowerShell content provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="6cccc-145">Dans ces cas, l’implémentation de la méthode [System. Management. Automation. Provider. Icontentcmdletprovider. GetContentReader \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) doit garantir que le chemin d’accès passé à la méthode répond aux exigences des fonctionnalités spécifiées.</span><span class="sxs-lookup"><span data-stu-id="6cccc-145">In these cases, the implementation of the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="6cccc-146">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, les propriétés [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-146">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="6cccc-147">Par défaut, les substitutions de cette méthode ne doivent pas récupérer un lecteur pour les objets qui sont masqués à l’utilisateur, à moins que la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) soit définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="6cccc-147">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="6cccc-148">Une erreur doit être écrite si le chemin d’accès représente un élément masqué de l’utilisateur et que [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) a la valeur `false`.</span><span class="sxs-lookup"><span data-stu-id="6cccc-148">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-content-cmdlet"></a><span data-ttu-id="6cccc-149">Attachement de paramètres dynamiques à l’applet de commande d’extraction de contenu</span><span class="sxs-lookup"><span data-stu-id="6cccc-149">Attaching Dynamic Parameters to the Get-Content Cmdlet</span></span>

<span data-ttu-id="6cccc-150">L’applet de commande `Get-Content` peut nécessiter des paramètres supplémentaires spécifiés de manière dynamique au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="6cccc-150">The `Get-Content` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="6cccc-151">Pour fournir ces paramètres dynamiques, le fournisseur de contenu Windows PowerShell doit implémenter la méthode [System. Management. Automation. Provider. Icontentcmdletprovider. Getcontentreaderdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReaderDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-151">To provide these dynamic parameters, the Windows PowerShell content provider must implement the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreaderdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReaderDynamicParameters) method.</span></span> <span data-ttu-id="6cccc-152">Cette méthode récupère les paramètres dynamiques pour l’élément au chemin d’accès indiqué et retourne un objet qui a des propriétés et des champs avec des attributs d’analyse similaires à une classe d’applet de commande ou à un objet [System. Management. Automation. RuntimeDefinedParameterDictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-152">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="6cccc-153">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="6cccc-153">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="6cccc-154">Ce fournisseur de conteneurs Windows PowerShell n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6cccc-154">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="6cccc-155">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6cccc-155">However, the following code is the default implementation of this method.</span></span>

```csharp
public object GetContentReaderDynamicParameters(string path)
{
    return null;
}
```

[!code-csharp[AccessDBProviderSample06.cs](~/powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1853-L1856 "AccessDBProviderSample06.cs")]

## <a name="retrieving-the-content-writer"></a><span data-ttu-id="6cccc-156">Récupération du writer de contenu</span><span class="sxs-lookup"><span data-stu-id="6cccc-156">Retrieving the Content Writer</span></span>

<span data-ttu-id="6cccc-157">Pour écrire du contenu dans un élément, le fournisseur doit implémenter [System. Management. Automation. Provider. Icontentcmdletprovider. Getcontentwriter \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) pour prendre en charge les applets de commande `Set-Content` et `Add-Content`.</span><span class="sxs-lookup"><span data-stu-id="6cccc-157">To write content to an item, the provider must implement the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) to support the `Set-Content` and `Add-Content` cmdlets.</span></span> <span data-ttu-id="6cccc-158">Cette méthode retourne le writer de contenu pour l’élément situé dans le chemin d’accès spécifié.</span><span class="sxs-lookup"><span data-stu-id="6cccc-158">This method returns the content writer for the item located at the specified path.</span></span>

<span data-ttu-id="6cccc-159">Voici l’implémentation de [System. Management. Automation. Provider. Icontentcmdletprovider. Getcontentwriter \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) pour cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6cccc-159">Here is the implementation of [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) for this method.</span></span>

```csharp
public IContentWriter GetContentWriter(string path)
{
    string tableName;
    int rowNumber;

    PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

    if (type == PathType.Invalid)
    {
        ThrowTerminatingInvalidPathException(path);
    }
    else if (type == PathType.Row)
    {
        throw new InvalidOperationException("contents can be added only to tables");
    }

    return new AccessDBContentWriter(path, this);
}
```

[!code-csharp[AccessDBProviderSample06.cs](~/powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1863-L1880 "AccessDBProviderSample06.cs")]

#### <a name="things-to-remember-about-implementing-getcontentwriter"></a><span data-ttu-id="6cccc-160">Points à retenir concernant l’implémentation de GetContentWriter</span><span class="sxs-lookup"><span data-stu-id="6cccc-160">Things to Remember About Implementing GetContentWriter</span></span>

<span data-ttu-id="6cccc-161">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System. Management. Automation. Provider. Icontentcmdletprovider. Getcontentwriter \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter):</span><span class="sxs-lookup"><span data-stu-id="6cccc-161">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter):</span></span>

- <span data-ttu-id="6cccc-162">Lors de la définition de la classe de fournisseur, un fournisseur de contenu Windows PowerShell peut déclarer des fonctionnalités de fournisseur de ExpandWildcards, Filter, include ou Exclude, à partir de l’énumération [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-162">When defining the provider class, a Windows PowerShell content provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="6cccc-163">Dans ces cas, l’implémentation de la méthode [System. Management. Automation. Provider. Icontentcmdletprovider. Getcontentwriter \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) doit garantir que le chemin d’accès passé à la méthode répond aux exigences des fonctionnalités spécifiées.</span><span class="sxs-lookup"><span data-stu-id="6cccc-163">In these cases, the implementation of the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="6cccc-164">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, les propriétés [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-164">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="6cccc-165">Par défaut, les substitutions de cette méthode ne doivent pas récupérer un writer pour les objets qui sont masqués à l’utilisateur, à moins que la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) ait la valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="6cccc-165">By default, overrides of this method should not retrieve a writer for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="6cccc-166">Une erreur doit être écrite si le chemin d’accès représente un élément masqué de l’utilisateur et que [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) a la valeur `false`.</span><span class="sxs-lookup"><span data-stu-id="6cccc-166">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-add-content-and-set-content-cmdlets"></a><span data-ttu-id="6cccc-167">Attachement de paramètres dynamiques aux applets de commande Add-Content et Set-Content</span><span class="sxs-lookup"><span data-stu-id="6cccc-167">Attaching Dynamic Parameters to the Add-Content and Set-Content Cmdlets</span></span>

<span data-ttu-id="6cccc-168">Les applets de commande `Add-Content` et `Set-Content` peuvent nécessiter des paramètres dynamiques supplémentaires qui sont ajoutés à un Runtime.</span><span class="sxs-lookup"><span data-stu-id="6cccc-168">The `Add-Content` and `Set-Content` cmdlets might require additional dynamic parameters that are added a runtime.</span></span> <span data-ttu-id="6cccc-169">Pour fournir ces paramètres dynamiques, le fournisseur de contenu Windows PowerShell doit implémenter la méthode [System. Management. Automation. Provider. Icontentcmdletprovider. Getcontentwriterdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriterDynamicParameters) pour gérer ces paramètres.</span><span class="sxs-lookup"><span data-stu-id="6cccc-169">To provide these dynamic parameters, the Windows PowerShell content provider must implement the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriterdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriterDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="6cccc-170">Cette méthode récupère les paramètres dynamiques pour l’élément au chemin d’accès indiqué et retourne un objet qui a des propriétés et des champs avec des attributs d’analyse similaires à une classe d’applet de commande ou à un objet [System. Management. Automation. RuntimeDefinedParameterDictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-170">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="6cccc-171">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres aux applets de commande.</span><span class="sxs-lookup"><span data-stu-id="6cccc-171">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlets.</span></span>

<span data-ttu-id="6cccc-172">Ce fournisseur de conteneurs Windows PowerShell n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6cccc-172">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="6cccc-173">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6cccc-173">However, the following code is the default implementation of this method.</span></span>

[!code-csharp[AccessDBProviderSample06.cs](~/powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1887-L1890 "AccessDBProviderSample06.cs")]

## <a name="clearing-content"></a><span data-ttu-id="6cccc-174">Effacement du contenu</span><span class="sxs-lookup"><span data-stu-id="6cccc-174">Clearing Content</span></span>

<span data-ttu-id="6cccc-175">Votre fournisseur de contenu implémente la méthode [System. Management. Automation. Provider. Icontentcmdletprovider. ClearContent \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) pour la prise en charge de l’applet de commande `Clear-Content`.</span><span class="sxs-lookup"><span data-stu-id="6cccc-175">Your content provider implements the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) method in support of the `Clear-Content` cmdlet.</span></span> <span data-ttu-id="6cccc-176">Cette méthode supprime le contenu de l’élément au niveau du chemin d’accès spécifié, mais laisse l’élément intact.</span><span class="sxs-lookup"><span data-stu-id="6cccc-176">This method removes the contents of the item at the specified path, but leaves the item intact.</span></span>

<span data-ttu-id="6cccc-177">Voici l’implémentation de la méthode [System. Management. Automation. Provider. Icontentcmdletprovider. ClearContent \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="6cccc-177">Here is the implementation of the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) method for this provider.</span></span>

[!code-csharp[AccessDBProviderSample06.cs](~/powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1775-L1812 "AccessDBProviderSample06.cs")]

#### <a name="things-to-remember-about-implementing-clearcontent"></a><span data-ttu-id="6cccc-178">Points à retenir concernant l’implémentation de ClearContent</span><span class="sxs-lookup"><span data-stu-id="6cccc-178">Things to Remember About Implementing ClearContent</span></span>

<span data-ttu-id="6cccc-179">Les conditions suivantes peuvent s’appliquer à une implémentation de [System. Management. Automation. Provider. Icontentcmdletprovider. ClearContent \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent):</span><span class="sxs-lookup"><span data-stu-id="6cccc-179">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent):</span></span>

- <span data-ttu-id="6cccc-180">Lors de la définition de la classe de fournisseur, un fournisseur de contenu Windows PowerShell peut déclarer des fonctionnalités de fournisseur de ExpandWildcards, Filter, include ou Exclude, à partir de l’énumération [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-180">When defining the provider class, a Windows PowerShell content provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="6cccc-181">Dans ces cas, l’implémentation de la méthode [System. Management. Automation. Provider. Icontentcmdletprovider. ClearContent \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) doit garantir que le chemin d’accès passé à la méthode répond aux exigences des fonctionnalités spécifiées.</span><span class="sxs-lookup"><span data-stu-id="6cccc-181">In these cases, the implementation of the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="6cccc-182">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, les propriétés [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-182">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="6cccc-183">Par défaut, les substitutions de cette méthode ne doivent pas effacer le contenu des objets qui sont masqués à l’utilisateur, à moins que la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) ait la valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="6cccc-183">By default, overrides of this method should not clear the contents of objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="6cccc-184">Une erreur doit être écrite si le chemin d’accès représente un élément masqué de l’utilisateur et que [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) a la valeur `false`.</span><span class="sxs-lookup"><span data-stu-id="6cccc-184">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="6cccc-185">Votre implémentation de la méthode [System. Management. Automation. Provider. Icontentcmdletprovider. ClearContent \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) doit appeler [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) et vérifier sa valeur de retour avant d’apporter des modifications au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="6cccc-185">Your implementation of the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="6cccc-186">Cette méthode est utilisée pour confirmer l’exécution d’une opération quand une modification est apportée au magasin de données, comme l’effacement du contenu.</span><span class="sxs-lookup"><span data-stu-id="6cccc-186">This method is used to confirm execution of an operation when a change is made to the data store, such as clearing content.</span></span> <span data-ttu-id="6cccc-187">La méthode [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envoie le nom de la ressource à modifier à l’utilisateur, avec le runtime Windows PowerShell qui gère les paramètres de ligne de commande ou les variables de préférence pour déterminer ce qui doit être affiché.</span><span class="sxs-lookup"><span data-stu-id="6cccc-187">The [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) method sends the name of the resource to be changed to the user, with the Windows PowerShell runtime handling any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="6cccc-188">Une fois que l’appel à [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourne `true`, la méthode [System. Management. Automation. Provider. Icontentcmdletprovider. ClearContent \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) doit appeler la méthode [System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-188">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="6cccc-189">Cette méthode envoie un message à l’utilisateur pour permettre aux commentaires de vérifier si l’opération doit être poursuivie.</span><span class="sxs-lookup"><span data-stu-id="6cccc-189">This method sends a message to the user to allow feedback to verify if the operation should be continued.</span></span> <span data-ttu-id="6cccc-190">L’appel à [System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) permet une vérification supplémentaire des modifications système potentiellement dangereuses.</span><span class="sxs-lookup"><span data-stu-id="6cccc-190">The call to [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) allows an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-clear-content-cmdlet"></a><span data-ttu-id="6cccc-191">Attachement de paramètres dynamiques à l’applet de commande Clear-Content</span><span class="sxs-lookup"><span data-stu-id="6cccc-191">Attaching Dynamic Parameters to the Clear-Content Cmdlet</span></span>

<span data-ttu-id="6cccc-192">L’applet de commande `Clear-Content` peut nécessiter des paramètres dynamiques supplémentaires qui sont ajoutés au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="6cccc-192">The `Clear-Content` cmdlet might require additional dynamic parameters that are added at runtime.</span></span> <span data-ttu-id="6cccc-193">Pour fournir ces paramètres dynamiques, le fournisseur de contenu Windows PowerShell doit implémenter la méthode [System. Management. Automation. Provider. Icontentcmdletprovider. Clearcontentdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContentDynamicParameters) pour gérer ces paramètres.</span><span class="sxs-lookup"><span data-stu-id="6cccc-193">To provide these dynamic parameters, the Windows PowerShell content provider must implement the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontentdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContentDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="6cccc-194">Cette méthode récupère les paramètres pour l’élément au chemin d’accès indiqué.</span><span class="sxs-lookup"><span data-stu-id="6cccc-194">This method retrieves the parameters for the item at the indicated path.</span></span> <span data-ttu-id="6cccc-195">Cette méthode récupère les paramètres dynamiques pour l’élément au chemin d’accès indiqué et retourne un objet qui a des propriétés et des champs avec des attributs d’analyse similaires à une classe d’applet de commande ou à un objet [System. Management. Automation. RuntimeDefinedParameterDictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="6cccc-195">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="6cccc-196">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="6cccc-196">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="6cccc-197">Ce fournisseur de conteneurs Windows PowerShell n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6cccc-197">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="6cccc-198">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6cccc-198">However, the following code is the default implementation of this method.</span></span>

```csharp
public object ClearContentDynamicParameters(string path)
{
    return null;
}
```

[!code-csharp[AccessDBProviderSample06.cs](~/powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1819-L1822 "AccessDBProviderSample06.cs")]

## <a name="code-sample"></a><span data-ttu-id="6cccc-199">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="6cccc-199">Code Sample</span></span>

<span data-ttu-id="6cccc-200">Pour obtenir un exemple de code complet, consultez [exemple de code AccessDbProviderSample06](./accessdbprovidersample06-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="6cccc-200">For complete sample code, see [AccessDbProviderSample06 Code Sample](./accessdbprovidersample06-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="6cccc-201">Définition des types d’objets et de la mise en forme</span><span class="sxs-lookup"><span data-stu-id="6cccc-201">Defining Object Types and Formatting</span></span>

<span data-ttu-id="6cccc-202">Lors de l’écriture d’un fournisseur, il peut être nécessaire d’ajouter des membres à des objets existants ou de définir de nouveaux objets.</span><span class="sxs-lookup"><span data-stu-id="6cccc-202">When writing a provider, it may be necessary to add members to existing objects or define new objects.</span></span> <span data-ttu-id="6cccc-203">Une fois cette opération effectuée, vous devez créer un fichier de types que Windows PowerShell peut utiliser pour identifier les membres de l’objet et un fichier de format qui définit le mode d’affichage de l’objet.</span><span class="sxs-lookup"><span data-stu-id="6cccc-203">When this is done, you must create a Types file that Windows PowerShell can use to identify the members of the object and a Format file that defines how the object is displayed.</span></span> <span data-ttu-id="6cccc-204">Pour plus d’informations, consultez [extension des types d’objets et de la mise en forme](/previous-versions/ms714665(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="6cccc-204">For more information, see [Extending Object Types and Formatting](/previous-versions/ms714665(v=vs.85)).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="6cccc-205">Génération du fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6cccc-205">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="6cccc-206">Découvrez [comment inscrire des applets de commande, des fournisseurs et des applications hôtes](/previous-versions/ms714644(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="6cccc-206">See [How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85)).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="6cccc-207">Test du fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6cccc-207">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="6cccc-208">Lorsque votre fournisseur Windows PowerShell a été inscrit auprès de Windows PowerShell, vous pouvez le tester en exécutant les applets de commande prises en charge sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="6cccc-208">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="6cccc-209">Par exemple, testez l’exemple de fournisseur de contenu.</span><span class="sxs-lookup"><span data-stu-id="6cccc-209">For example, test the sample content provider.</span></span>

<span data-ttu-id="6cccc-210">Utilisez l’applet de commande `Get-Content` pour récupérer le contenu de l’élément spécifié dans la table de base de données à l’emplacement spécifié par le paramètre `Path`.</span><span class="sxs-lookup"><span data-stu-id="6cccc-210">Use the `Get-Content` cmdlet to retrieve the contents of specified item in the database table at the path specified by the `Path` parameter.</span></span> <span data-ttu-id="6cccc-211">Le paramètre `ReadCount` spécifie le nombre d’éléments à lire par le lecteur de contenu défini (par défaut, 1).</span><span class="sxs-lookup"><span data-stu-id="6cccc-211">The `ReadCount` parameter specifies the number of items for the defined content reader to read (default 1).</span></span> <span data-ttu-id="6cccc-212">Avec l’entrée de commande suivante, l’applet de commande récupère deux lignes (éléments) de la table et affiche leur contenu.</span><span class="sxs-lookup"><span data-stu-id="6cccc-212">With the following command entry, the cmdlet retrieves two rows (items) from the table and displays their contents.</span></span> <span data-ttu-id="6cccc-213">Notez que l’exemple de sortie suivant utilise une base de données d’accès fictif.</span><span class="sxs-lookup"><span data-stu-id="6cccc-213">Note that the following example output uses a fictitious Access database.</span></span>

```powershell
Get-Content -Path mydb:\Customers -ReadCount 2
```

```Output
ID        : 1
FirstName : Eric
LastName  : Gruber
Email     : ericgruber@fabrikam.com
Title     : President
Company   : Fabrikam
WorkPhone : (425) 555-0100
Address   : 4567 Main Street
City      : Buffalo
State     : NY
Zip       : 98052
Country   : USA
ID        : 2
FirstName : Eva
LastName  : Corets
Email     : evacorets@cohowinery.com
Title     : Sales Representative
Company   : Coho Winery
WorkPhone : (360) 555-0100
Address   : 8910 Main Street
City      : Cabmerlot
State     : WA
Zip       : 98089
Country   : USA
```

## <a name="see-also"></a><span data-ttu-id="6cccc-214">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6cccc-214">See Also</span></span>

[<span data-ttu-id="6cccc-215">Création de fournisseurs Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6cccc-215">Creating Windows PowerShell providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="6cccc-216">Concevoir votre fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6cccc-216">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

<span data-ttu-id="6cccc-217">[Extension des types d’objets et de la mise en forme](/previous-versions//ms714665(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="6cccc-217">[Extending Object Types and Formatting](/previous-versions//ms714665(v=vs.85))</span></span>

[<span data-ttu-id="6cccc-218">Implémenter un fournisseur de navigation Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6cccc-218">Implement a Navigation Windows PowerShell provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

<span data-ttu-id="6cccc-219">[Comment inscrire des applets de commande, des fournisseurs et des applications hôtes](/previous-versions/ms714644(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="6cccc-219">[How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85))</span></span>

[<span data-ttu-id="6cccc-220">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="6cccc-220">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="6cccc-221">Guide du programmeur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6cccc-221">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)
