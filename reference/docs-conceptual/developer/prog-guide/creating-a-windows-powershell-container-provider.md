---
ms.date: 09/13/2016
ms.topic: reference
title: Création d’un fournisseur de conteneur Windows PowerShell
description: Création d’un fournisseur de conteneur Windows PowerShell
ms.openlocfilehash: 999bd69e3c16bfc0a74519986654ec15bbc0da6d
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/10/2020
ms.locfileid: "92645359"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="6a121-103">Création d’un fournisseur de conteneur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6a121-103">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="6a121-104">Cette rubrique explique comment créer un fournisseur Windows PowerShell qui peut fonctionner sur des magasins de données multicouches.</span><span class="sxs-lookup"><span data-stu-id="6a121-104">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="6a121-105">Pour ce type de banque de données, le niveau supérieur du magasin contient les éléments racine et chaque niveau suivant est désigné sous le terme de nœud d’éléments enfants.</span><span class="sxs-lookup"><span data-stu-id="6a121-105">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="6a121-106">En permettant à l’utilisateur de travailler sur ces nœuds enfants, un utilisateur peut interagir hiérarchiquement via le magasin de données.</span><span class="sxs-lookup"><span data-stu-id="6a121-106">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="6a121-107">Les fournisseurs qui peuvent travailler sur des magasins de données à plusieurs niveaux sont appelés fournisseurs de conteneurs Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6a121-107">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="6a121-108">Toutefois, sachez qu’un fournisseur de conteneurs Windows PowerShell ne peut être utilisé qu’en présence d’éléments dans un conteneur (sans conteneurs imbriqués).</span><span class="sxs-lookup"><span data-stu-id="6a121-108">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="6a121-109">S’il existe des conteneurs imbriqués, vous devez implémenter un fournisseur de navigation Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6a121-109">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="6a121-110">Pour plus d’informations sur l’implémentation du fournisseur de navigation Windows PowerShell, consultez [création d’un fournisseur de navigation Windows PowerShell](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6a121-110">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="6a121-111">Vous pouvez télécharger le fichier source C# (AccessDBSampleProvider04.cs) pour ce fournisseur à l’aide du kit de développement logiciel (SDK) Microsoft Windows pour Windows Vista et .NET Framework les composants d’exécution 3,0.</span><span class="sxs-lookup"><span data-stu-id="6a121-111">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="6a121-112">Pour obtenir des instructions de téléchargement, consultez [Comment installer Windows PowerShell et télécharger le kit de développement logiciel (SDK) Windows PowerShell](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="6a121-112">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/scripting/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="6a121-113">Les fichiers sources téléchargés sont disponibles dans le **\<PowerShell Samples>** répertoire.</span><span class="sxs-lookup"><span data-stu-id="6a121-113">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="6a121-114">Pour plus d’informations sur les autres implémentations du fournisseur Windows PowerShell, consultez [conception de votre fournisseur Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6a121-114">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="6a121-115">Le fournisseur de conteneurs Windows PowerShell décrit ici définit la base de données en tant que conteneur unique, avec les tables et les lignes de la base de données définies en tant qu’éléments du conteneur.</span><span class="sxs-lookup"><span data-stu-id="6a121-115">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="6a121-116">N’oubliez pas que cette conception suppose qu’il s’agit d’une base de données qui a un champ avec l’ID de nom et que le type du champ est LongInteger.</span><span class="sxs-lookup"><span data-stu-id="6a121-116">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="6a121-117">Définition d’une classe de fournisseur de conteneurs Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6a121-117">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="6a121-118">Un fournisseur de conteneurs Windows PowerShell doit définir une classe .NET qui dérive de la classe de base [System. Management. Automation. Provider. Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="6a121-118">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="6a121-119">Voici la définition de classe pour le fournisseur de conteneurs Windows PowerShell décrit dans cette section.</span><span class="sxs-lookup"><span data-stu-id="6a121-119">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
[CmdletProvider("AccessDB", ProviderCapabilities.None)]
public class AccessDBProvider : ContainerCmdletProvider
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="34-35":::

<span data-ttu-id="6a121-120">Notez que dans cette définition de classe, l’attribut [System. Management. Automation. Provider. Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) comprend deux paramètres.</span><span class="sxs-lookup"><span data-stu-id="6a121-120">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="6a121-121">Le premier paramètre spécifie un nom convivial pour le fournisseur qui est utilisé par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6a121-121">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="6a121-122">Le deuxième paramètre spécifie les fonctionnalités spécifiques de Windows PowerShell que le fournisseur expose au runtime Windows PowerShell pendant le traitement de la commande.</span><span class="sxs-lookup"><span data-stu-id="6a121-122">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="6a121-123">Pour ce fournisseur, aucune fonctionnalité spécifique de Windows PowerShell n’est ajoutée.</span><span class="sxs-lookup"><span data-stu-id="6a121-123">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="6a121-124">Définition des fonctionnalités de base</span><span class="sxs-lookup"><span data-stu-id="6a121-124">Defining Base Functionality</span></span>

<span data-ttu-id="6a121-125">Comme décrit dans [conception de votre fournisseur Windows PowerShell](./designing-your-windows-powershell-provider.md), la classe [System. Management. Automation. Provider. Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) dérive de plusieurs autres classes qui offraient des fonctionnalités de fournisseur différentes.</span><span class="sxs-lookup"><span data-stu-id="6a121-125">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="6a121-126">Un fournisseur de conteneurs Windows PowerShell, par conséquent, doit définir toutes les fonctionnalités fournies par ces classes.</span><span class="sxs-lookup"><span data-stu-id="6a121-126">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="6a121-127">Pour implémenter les fonctionnalités d’ajout d’informations d’initialisation spécifiques à la session et pour libérer les ressources utilisées par le fournisseur, consultez [création d’un fournisseur Windows PowerShell de base](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6a121-127">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span>
<span data-ttu-id="6a121-128">Toutefois, la plupart des fournisseurs (y compris le fournisseur décrit ici) peuvent utiliser l’implémentation par défaut de cette fonctionnalité fournie par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6a121-128">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="6a121-129">Pour accéder au magasin de données, le fournisseur doit implémenter les méthodes de la classe de base [System. Management. Automation. Provider. Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="6a121-129">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="6a121-130">Pour plus d’informations sur l’implémentation de ces méthodes, consultez [création d’un fournisseur de lecteurs Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6a121-130">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="6a121-131">Pour manipuler les éléments d’un magasin de données, tels que l’obtention, la définition et l’effacement des éléments, le fournisseur doit implémenter les méthodes fournies par la classe de base [System. Management. Automation. Provider. Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) .</span><span class="sxs-lookup"><span data-stu-id="6a121-131">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="6a121-132">Pour plus d’informations sur l’implémentation de ces méthodes, consultez [création d’un fournisseur d’éléments Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6a121-132">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="6a121-133">Récupération d’éléments enfants</span><span class="sxs-lookup"><span data-stu-id="6a121-133">Retrieving Child Items</span></span>

<span data-ttu-id="6a121-134">Pour récupérer un élément enfant, le fournisseur de conteneurs Windows PowerShell doit substituer la méthode [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) pour prendre en charge les appels de l’applet de commande `Get-ChildItem` .</span><span class="sxs-lookup"><span data-stu-id="6a121-134">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="6a121-135">Cette méthode récupère les éléments enfants dans le magasin de données et les écrit dans le pipeline en tant qu’objets.</span><span class="sxs-lookup"><span data-stu-id="6a121-135">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="6a121-136">Si le `recurse` paramètre de l’applet de commande est spécifié, la méthode récupère tous les enfants, quel que soit le niveau auquel ils se trouvent.</span><span class="sxs-lookup"><span data-stu-id="6a121-136">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="6a121-137">Si le `recurse` paramètre n’est pas spécifié, la méthode récupère uniquement un seul niveau d’enfants.</span><span class="sxs-lookup"><span data-stu-id="6a121-137">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="6a121-138">Voici l’implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="6a121-138">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="6a121-139">Notez que cette méthode récupère les éléments enfants dans toutes les tables de base de données lorsque le chemin d’accès indique la base de données Access et récupère les éléments enfants à partir des lignes de cette table si le chemin d’accès indique une table de données.</span><span class="sxs-lookup"><span data-stu-id="6a121-139">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="311-362":::

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="6a121-140">Points à retenir concernant l’implémentation de GetChildItems</span><span class="sxs-lookup"><span data-stu-id="6a121-140">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="6a121-141">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="6a121-141">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="6a121-142">Lors de la définition de la classe de fournisseur, un fournisseur de conteneurs Windows PowerShell peut déclarer des fonctionnalités de fournisseur de ExpandWildcards, Filter, include ou Exclude, à partir de l’énumération [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="6a121-142">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="6a121-143">Dans ces cas, l’implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) doit garantir que le chemin d’accès passé à la méthode répond aux exigences des fonctionnalités spécifiées.</span><span class="sxs-lookup"><span data-stu-id="6a121-143">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="6a121-144">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, les propriétés [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="6a121-144">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="6a121-145">L’implémentation de cette méthode doit prendre en compte toute forme d’accès à l’élément qui peut rendre l’élément visible à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6a121-145">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="6a121-146">Par exemple, si un utilisateur dispose d’un accès en écriture à un fichier via le fournisseur FileSystem (fourni par Windows PowerShell), mais pas d’accès en lecture, le fichier existe toujours et [System. Management. Automation. Provider. Itemcmdletprovider. itemExists \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) retourne `true` .</span><span class="sxs-lookup"><span data-stu-id="6a121-146">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="6a121-147">Votre implémentation peut nécessiter la vérification d’un élément parent pour voir si l’enfant peut être énuméré.</span><span class="sxs-lookup"><span data-stu-id="6a121-147">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="6a121-148">Lors de l’écriture de plusieurs éléments, la méthode [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) peut prendre un certain temps.</span><span class="sxs-lookup"><span data-stu-id="6a121-148">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="6a121-149">Vous pouvez concevoir votre fournisseur pour écrire les éléments à l’aide de la méthode [System. Management. Automation. Provider. Cmdletprovider. Writeitemobject \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) une à la fois.</span><span class="sxs-lookup"><span data-stu-id="6a121-149">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="6a121-150">L’utilisation de cette technique permet de présenter les éléments à l’utilisateur dans un flux.</span><span class="sxs-lookup"><span data-stu-id="6a121-150">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="6a121-151">Votre implémentation de [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) est chargée d’empêcher une récurrence infinie lorsqu’il y a des liens circulaires, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="6a121-151">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="6a121-152">Une exception d’arrêt appropriée doit être levée pour refléter une telle condition.</span><span class="sxs-lookup"><span data-stu-id="6a121-152">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="6a121-153">Attachement de paramètres dynamiques à l’applet de commande Get-ChildItem</span><span class="sxs-lookup"><span data-stu-id="6a121-153">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="6a121-154">Parfois `Get-ChildItem` , l’applet de commande qui appelle [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) nécessite des paramètres supplémentaires spécifiés de manière dynamique au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="6a121-154">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="6a121-155">Pour fournir ces paramètres dynamiques, le fournisseur de conteneurs Windows PowerShell doit implémenter la méthode [System. Management. Automation. Provider. Containercmdletprovider. Getchilditemsdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="6a121-155">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="6a121-156">Cette méthode récupère les paramètres dynamiques pour l’élément au chemin d’accès indiqué et retourne un objet qui a des propriétés et des champs avec des attributs d’analyse similaires à une classe d’applet de commande ou à un objet [System. Management. Automation. RuntimeDefinedParameterDictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="6a121-156">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="6a121-157">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à l' `Get-ChildItem` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="6a121-157">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="6a121-158">Ce fournisseur de conteneurs Windows PowerShell n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6a121-158">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="6a121-159">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6a121-159">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="6a121-160">Récupération des noms d’éléments enfants</span><span class="sxs-lookup"><span data-stu-id="6a121-160">Retrieving Child Item Names</span></span>

<span data-ttu-id="6a121-161">Pour récupérer les noms des éléments enfants, le fournisseur de conteneurs Windows PowerShell doit substituer la méthode [System. Management. Automation. Provider. Containercmdletprovider. Getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) pour prendre en charge les appels de l’applet de commande `Get-ChildItem` lorsque son `Name` paramètre est spécifié.</span><span class="sxs-lookup"><span data-stu-id="6a121-161">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="6a121-162">Cette méthode récupère les noms des éléments enfants pour le chemin d’accès ou les noms d’éléments enfants spécifiés pour tous les conteneurs si le `returnAllContainers` paramètre de l’applet de commande est spécifié.</span><span class="sxs-lookup"><span data-stu-id="6a121-162">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="6a121-163">Un nom enfant est la partie feuille d’un chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="6a121-163">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="6a121-164">Par exemple, le nom de l’enfant pour le chemin d’accès c:\windows\system32\abc.dll est « abc.dll ».</span><span class="sxs-lookup"><span data-stu-id="6a121-164">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="6a121-165">Le nom enfant du répertoire c:\Windows\System32 est « system32 ».</span><span class="sxs-lookup"><span data-stu-id="6a121-165">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="6a121-166">Voici l’implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. Getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="6a121-166">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="6a121-167">Notez que la méthode récupère les noms des tables si le chemin d’accès spécifié indique la base de données Access (lecteur) et les numéros de ligne si le chemin d’accès indique une table.</span><span class="sxs-lookup"><span data-stu-id="6a121-167">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="369-411":::

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="6a121-168">Points à retenir concernant l’implémentation de GetChildNames</span><span class="sxs-lookup"><span data-stu-id="6a121-168">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="6a121-169">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="6a121-169">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="6a121-170">Lors de la définition de la classe de fournisseur, un fournisseur de conteneurs Windows PowerShell peut déclarer des fonctionnalités de fournisseur de ExpandWildcards, Filter, include ou Exclude, à partir de l’énumération [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="6a121-170">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="6a121-171">Dans ces cas, l’implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) doit garantir que le chemin d’accès passé à la méthode répond aux exigences des fonctionnalités spécifiées.</span><span class="sxs-lookup"><span data-stu-id="6a121-171">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="6a121-172">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, les propriétés [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="6a121-172">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="6a121-173">Une exception à cette règle se produit lorsque le `returnAllContainers` paramètre de l’applet de commande est spécifié.</span><span class="sxs-lookup"><span data-stu-id="6a121-173">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="6a121-174">Dans ce cas, la méthode doit récupérer tout nom enfant pour un conteneur, même s’il ne correspond pas aux valeurs des propriétés [System. Management. Automation. Provider. Cmdletprovider. Filter \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), System. Management. Automation. Provider. [Cmdletprovider. include](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include)\* ou [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) .</span><span class="sxs-lookup"><span data-stu-id="6a121-174">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="6a121-175">Par défaut, les substitutions de cette méthode ne doivent pas récupérer les noms des objets qui sont généralement masqués par l’utilisateur, à moins que la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) soit spécifiée.</span><span class="sxs-lookup"><span data-stu-id="6a121-175">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="6a121-176">Si le chemin d’accès spécifié indique un conteneur, la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="6a121-176">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="6a121-177">Votre implémentation de [System. Management. Automation. Provider. Containercmdletprovider. Getchildnames \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) est chargée d’empêcher une récurrence infinie lorsqu’il y a des liens circulaires, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="6a121-177">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="6a121-178">Une exception d’arrêt appropriée doit être levée pour refléter une telle condition.</span><span class="sxs-lookup"><span data-stu-id="6a121-178">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="6a121-179">Attachement de paramètres dynamiques à l’applet de commande Get-ChildItem (nom)</span><span class="sxs-lookup"><span data-stu-id="6a121-179">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="6a121-180">Parfois, l’applet de commande `Get-ChildItem` (avec le `Name` paramètre) requiert des paramètres supplémentaires qui sont spécifiés de manière dynamique au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="6a121-180">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="6a121-181">Pour fournir ces paramètres dynamiques, le fournisseur de conteneurs Windows PowerShell doit implémenter la méthode [System. Management. Automation. Provider. Containercmdletprovider. Getchildnamesdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="6a121-181">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="6a121-182">Cette méthode récupère les paramètres dynamiques pour l’élément au chemin d’accès indiqué et retourne un objet qui a des propriétés et des champs avec des attributs d’analyse similaires à une classe d’applet de commande ou à un objet [System. Management. Automation. RuntimeDefinedParameterDictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="6a121-182">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="6a121-183">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à l' `Get-ChildItem` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="6a121-183">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="6a121-184">Ce fournisseur n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6a121-184">This provider does not implement this method.</span></span> <span data-ttu-id="6a121-185">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6a121-185">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="6a121-186">Attribution d’un nouveau nom aux éléments</span><span class="sxs-lookup"><span data-stu-id="6a121-186">Renaming Items</span></span>

<span data-ttu-id="6a121-187">Pour renommer un élément, un fournisseur de conteneurs Windows PowerShell doit substituer la méthode [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) pour prendre en charge les appels de l’applet de commande `Rename-Item` .</span><span class="sxs-lookup"><span data-stu-id="6a121-187">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="6a121-188">Cette méthode remplace le nom de l’élément au niveau du chemin d’accès spécifié par le nouveau nom fourni.</span><span class="sxs-lookup"><span data-stu-id="6a121-188">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="6a121-189">Le nouveau nom doit toujours être relatif à l’élément parent (conteneur).</span><span class="sxs-lookup"><span data-stu-id="6a121-189">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="6a121-190">Ce fournisseur ne remplace pas la méthode [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) .</span><span class="sxs-lookup"><span data-stu-id="6a121-190">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="6a121-191">Toutefois, l’implémentation par défaut est la suivante.</span><span class="sxs-lookup"><span data-stu-id="6a121-191">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="6a121-192">Points à retenir concernant l’implémentation de RenameItem</span><span class="sxs-lookup"><span data-stu-id="6a121-192">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="6a121-193">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="6a121-193">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="6a121-194">Lors de la définition de la classe de fournisseur, un fournisseur de conteneurs Windows PowerShell peut déclarer des fonctionnalités de fournisseur de ExpandWildcards, Filter, include ou Exclude, à partir de l’énumération [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="6a121-194">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="6a121-195">Dans ces cas, l’implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) doit garantir que le chemin d’accès passé à la méthode répond aux exigences des fonctionnalités spécifiées.</span><span class="sxs-lookup"><span data-stu-id="6a121-195">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="6a121-196">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, les propriétés [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="6a121-196">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="6a121-197">La méthode [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) est destinée uniquement à la modification du nom d’un élément, et non pas aux opérations de déplacement.</span><span class="sxs-lookup"><span data-stu-id="6a121-197">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span>
  <span data-ttu-id="6a121-198">Votre implémentation de la méthode doit écrire une erreur si le `newName` paramètre contient des séparateurs de chemin d’accès ou si elle peut entraîner la modification de son emplacement parent par l’élément.</span><span class="sxs-lookup"><span data-stu-id="6a121-198">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="6a121-199">Par défaut, les substitutions de cette méthode ne doivent pas renommer les objets, à moins que la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) soit spécifiée.</span><span class="sxs-lookup"><span data-stu-id="6a121-199">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="6a121-200">Si le chemin d’accès spécifié indique un conteneur, la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="6a121-200">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="6a121-201">Votre implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) doit appeler [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) et vérifier sa valeur de retour avant d’apporter des modifications au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="6a121-201">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="6a121-202">Cette méthode est utilisée pour confirmer l’exécution d’une opération quand une modification est apportée à l’état du système, par exemple, renommer des fichiers.</span><span class="sxs-lookup"><span data-stu-id="6a121-202">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span>
  <span data-ttu-id="6a121-203">[System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envoie le nom de la ressource à modifier à l’utilisateur, avec le runtime Windows PowerShell en tenant compte des paramètres de ligne de commande ou des variables de préférence pour déterminer ce qui doit être affiché.</span><span class="sxs-lookup"><span data-stu-id="6a121-203">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="6a121-204">Une fois que l’appel à [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) `true` est retourné, la méthode [System. Management. Automation. Provider. Containercmdletprovider. RenameItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) doit appeler la méthode [System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) .</span><span class="sxs-lookup"><span data-stu-id="6a121-204">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="6a121-205">Cette méthode envoie un message de confirmation à l’utilisateur afin d’autoriser des commentaires supplémentaires à indiquer si l’opération doit être poursuivie.</span><span class="sxs-lookup"><span data-stu-id="6a121-205">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="6a121-206">Un fournisseur doit appeler [System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) pour une vérification supplémentaire des modifications système potentiellement dangereuses.</span><span class="sxs-lookup"><span data-stu-id="6a121-206">A provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="6a121-207">Attachement de paramètres dynamiques à l’applet de commande Rename-Item</span><span class="sxs-lookup"><span data-stu-id="6a121-207">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="6a121-208">Parfois, l’applet de commande `Rename-Item` requiert des paramètres supplémentaires spécifiés de manière dynamique au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="6a121-208">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="6a121-209">Pour fournir ces paramètres dynamiques, le fournisseur de conteneurs Windows PowerShell doit implémenter la méthode [System. Management. Automation. Provider. Containercmdletprovider. Renameitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="6a121-209">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="6a121-210">Cette méthode récupère les paramètres pour l’élément au chemin d’accès indiqué et retourne un objet qui a des propriétés et des champs avec des attributs d’analyse similaires à une classe d’applet de commande ou à un objet [System. Management. Automation. RuntimeDefinedParameterDictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="6a121-210">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="6a121-211">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à l' `Rename-Item` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="6a121-211">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="6a121-212">Ce fournisseur de conteneurs n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6a121-212">This container provider does not implement this method.</span></span> <span data-ttu-id="6a121-213">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6a121-213">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="6a121-214">Création de nouveaux éléments</span><span class="sxs-lookup"><span data-stu-id="6a121-214">Creating New Items</span></span>

<span data-ttu-id="6a121-215">Pour créer de nouveaux éléments, un fournisseur de conteneurs doit implémenter la méthode [System. Management. Automation. Provider. Containercmdletprovider. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) pour prendre en charge les appels de l’applet de commande `New-Item` .</span><span class="sxs-lookup"><span data-stu-id="6a121-215">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="6a121-216">Cette méthode crée un élément de données situé dans le chemin d’accès spécifié.</span><span class="sxs-lookup"><span data-stu-id="6a121-216">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="6a121-217">Le `type` paramètre de l’applet de commande contient le type défini par le fournisseur pour le nouvel élément.</span><span class="sxs-lookup"><span data-stu-id="6a121-217">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="6a121-218">Par exemple, le fournisseur FileSystem utilise un `type` paramètre avec la valeur « file » ou « Directory ».</span><span class="sxs-lookup"><span data-stu-id="6a121-218">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="6a121-219">Le `newItemValue` paramètre de l’applet de commande spécifie une valeur spécifique au fournisseur pour le nouvel élément.</span><span class="sxs-lookup"><span data-stu-id="6a121-219">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="6a121-220">Voici l’implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="6a121-220">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type, object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="939-955":::

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="6a121-221">Points à retenir concernant l’implémentation de NewItem</span><span class="sxs-lookup"><span data-stu-id="6a121-221">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="6a121-222">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System. Management. Automation. Provider. Containercmdletprovider. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="6a121-222">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="6a121-223">La méthode [System. Management. Automation. Provider. Containercmdletprovider. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) doit effectuer une comparaison ne respectant pas la casse de la chaîne passée dans le `type` paramètre.</span><span class="sxs-lookup"><span data-stu-id="6a121-223">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span>
  <span data-ttu-id="6a121-224">Elle doit également permettre des correspondances moins ambiguës.</span><span class="sxs-lookup"><span data-stu-id="6a121-224">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="6a121-225">Par exemple, pour les types « fichier » et « répertoire », seule la première lettre est nécessaire pour lever l’ambiguïté.</span><span class="sxs-lookup"><span data-stu-id="6a121-225">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="6a121-226">Si le `type` paramètre indique un type que votre fournisseur ne peut pas créer, la méthode [System. Management. Automation. Provider. Containercmdletprovider. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) doit écrire une exception ArgumentException avec un message indiquant les types que le fournisseur peut créer.</span><span class="sxs-lookup"><span data-stu-id="6a121-226">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="6a121-227">Pour le `newItemValue` paramètre, il est recommandé d’implémenter la méthode [System. Management. Automation. Provider. Containercmdletprovider. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) pour accepter des chaînes au minimum.</span><span class="sxs-lookup"><span data-stu-id="6a121-227">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="6a121-228">Elle doit également accepter le type d’objet récupéré par la méthode [System. Management. Automation. Provider. Itemcmdletprovider. GetItem \*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) pour le même chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="6a121-228">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="6a121-229">La méthode [System. Management. Automation. Provider. Containercmdletprovider. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) peut utiliser la méthode [System. Management. Automation. LanguagePrimitives. ConvertTo \*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) pour convertir les types vers le type souhaité.</span><span class="sxs-lookup"><span data-stu-id="6a121-229">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="6a121-230">Votre implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) doit appeler [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) et vérifier sa valeur de retour avant d’apporter des modifications au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="6a121-230">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="6a121-231">Une fois que l’appel à [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourne la valeur true, la méthode [System. Management. Automation. Provider. Containercmdletprovider. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) doit appeler la méthode [System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) pour effectuer un contrôle supplémentaire des modifications système potentiellement dangereuses.</span><span class="sxs-lookup"><span data-stu-id="6a121-231">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="6a121-232">Attachement de paramètres dynamiques à l’applet de commande New-Item</span><span class="sxs-lookup"><span data-stu-id="6a121-232">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="6a121-233">Parfois, l’applet de commande `New-Item` requiert des paramètres supplémentaires spécifiés de manière dynamique au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="6a121-233">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="6a121-234">Pour fournir ces paramètres dynamiques, le fournisseur de conteneurs doit implémenter la méthode [System. Management. Automation. Provider. Containercmdletprovider. Newitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) .</span><span class="sxs-lookup"><span data-stu-id="6a121-234">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="6a121-235">Cette méthode récupère les paramètres pour l’élément au chemin d’accès indiqué et retourne un objet qui a des propriétés et des champs avec des attributs d’analyse similaires à une classe d’applet de commande ou à un objet [System. Management. Automation. RuntimeDefinedParameterDictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="6a121-235">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="6a121-236">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à l' `New-Item` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="6a121-236">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="6a121-237">Ce fournisseur n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6a121-237">This provider does not implement this method.</span></span> <span data-ttu-id="6a121-238">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6a121-238">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="6a121-239">Suppression d’éléments</span><span class="sxs-lookup"><span data-stu-id="6a121-239">Removing Items</span></span>

<span data-ttu-id="6a121-240">Pour supprimer des éléments, le fournisseur Windows PowerShell doit substituer la méthode [System. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) pour prendre en charge les appels de l’applet de commande `Remove-Item` .</span><span class="sxs-lookup"><span data-stu-id="6a121-240">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="6a121-241">Cette méthode supprime un élément du magasin de données dans le chemin d’accès spécifié.</span><span class="sxs-lookup"><span data-stu-id="6a121-241">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="6a121-242">Si le `recurse` paramètre de l' `Remove-Item` applet de commande a la valeur `true` , la méthode supprime tous les éléments enfants, quel que soit leur niveau.</span><span class="sxs-lookup"><span data-stu-id="6a121-242">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="6a121-243">Si le paramètre a la valeur `false` , la méthode supprime un seul élément au chemin d’accès spécifié.</span><span class="sxs-lookup"><span data-stu-id="6a121-243">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="6a121-244">Ce fournisseur ne prend pas en charge la suppression d’éléments.</span><span class="sxs-lookup"><span data-stu-id="6a121-244">This provider does not support item removal.</span></span> <span data-ttu-id="6a121-245">Toutefois, le code suivant est l’implémentation par défaut de [System. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span><span class="sxs-lookup"><span data-stu-id="6a121-245">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="6a121-246">Points à retenir concernant l’implémentation de RemoveItem</span><span class="sxs-lookup"><span data-stu-id="6a121-246">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="6a121-247">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System. Management. Automation. Provider. Containercmdletprovider. newItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="6a121-247">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="6a121-248">Lors de la définition de la classe de fournisseur, un fournisseur de conteneurs Windows PowerShell peut déclarer des fonctionnalités de fournisseur de ExpandWildcards, Filter, include ou Exclude, à partir de l’énumération [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="6a121-248">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="6a121-249">Dans ces cas, l’implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) doit garantir que le chemin d’accès passé à la méthode répond aux exigences des fonctionnalités spécifiées.</span><span class="sxs-lookup"><span data-stu-id="6a121-249">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="6a121-250">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, les propriétés [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="6a121-250">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="6a121-251">Par défaut, les substitutions de cette méthode ne doivent pas supprimer d’objets, sauf si la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) a la valeur true.</span><span class="sxs-lookup"><span data-stu-id="6a121-251">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="6a121-252">Si le chemin d’accès spécifié indique un conteneur, la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="6a121-252">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="6a121-253">Votre implémentation de [System. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) est chargée d’empêcher la récurrence infinie lorsqu’il y a des liens circulaires, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="6a121-253">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="6a121-254">Une exception d’arrêt appropriée doit être levée pour refléter une telle condition.</span><span class="sxs-lookup"><span data-stu-id="6a121-254">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="6a121-255">Votre implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) doit appeler [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) et vérifier sa valeur de retour avant d’apporter des modifications au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="6a121-255">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="6a121-256">Une fois que l’appel à [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) `true` est retourné, la méthode [System. Management. Automation. Provider. Containercmdletprovider. RemoveItem \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) doit appeler la méthode [System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) pour une vérification supplémentaire des modifications système potentiellement dangereuses.</span><span class="sxs-lookup"><span data-stu-id="6a121-256">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="6a121-257">Attachement de paramètres dynamiques à l’applet de commande Remove-Item</span><span class="sxs-lookup"><span data-stu-id="6a121-257">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="6a121-258">Parfois, l’applet de commande `Remove-Item` requiert des paramètres supplémentaires spécifiés de manière dynamique au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="6a121-258">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="6a121-259">Pour fournir ces paramètres dynamiques, le fournisseur de conteneurs doit implémenter la méthode [System. Management. Automation. Provider. Containercmdletprovider. Removeitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) pour gérer ces paramètres.</span><span class="sxs-lookup"><span data-stu-id="6a121-259">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="6a121-260">Cette méthode récupère les paramètres dynamiques pour l’élément au chemin d’accès indiqué et retourne un objet qui a des propriétés et des champs avec des attributs d’analyse similaires à une classe d’applet de commande ou à un objet [System. Management. Automation. RuntimeDefinedParameterDictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="6a121-260">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="6a121-261">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à l' `Remove-Item` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="6a121-261">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="6a121-262">Ce fournisseur de conteneurs n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6a121-262">This container provider does not implement this method.</span></span> <span data-ttu-id="6a121-263">Toutefois, le code suivant est l’implémentation par défaut de [System. Management. Automation. Provider. Containercmdletprovider. Removeitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="6a121-263">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="6a121-264">Interrogation d’éléments enfants</span><span class="sxs-lookup"><span data-stu-id="6a121-264">Querying for Child Items</span></span>

<span data-ttu-id="6a121-265">Pour vérifier si des éléments enfants existent dans le chemin d’accès spécifié, le fournisseur de conteneurs Windows PowerShell doit substituer la méthode [System. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) .</span><span class="sxs-lookup"><span data-stu-id="6a121-265">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="6a121-266">Cette méthode retourne `true` si l’élément a des enfants, et dans le `false` cas contraire.</span><span class="sxs-lookup"><span data-stu-id="6a121-266">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="6a121-267">Pour un chemin d’accès null ou vide, la méthode considère tous les éléments du magasin de données comme des enfants et retourne `true` .</span><span class="sxs-lookup"><span data-stu-id="6a121-267">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="6a121-268">Voici le remplacement de la méthode [System. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) .</span><span class="sxs-lookup"><span data-stu-id="6a121-268">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="6a121-269">S’il existe plus de deux parties de chemin d’accès créées par la méthode d’assistance ChunkPath, la méthode retourne `false` , car seul un conteneur de base de données et un conteneur de table sont définis.</span><span class="sxs-lookup"><span data-stu-id="6a121-269">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="6a121-270">Pour plus d’informations sur cette méthode d’assistance, consultez la méthode ChunkPath est décrite dans [création d’un fournisseur d’éléments Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="6a121-270">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

:::code language="csharp" source="~/../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs" range="1094-1097":::

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="6a121-271">Points à retenir concernant l’implémentation de HasChildItems</span><span class="sxs-lookup"><span data-stu-id="6a121-271">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="6a121-272">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="6a121-272">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="6a121-273">Si le fournisseur de conteneurs expose une racine qui contient des points de montage intéressants, l’implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. Haschilditems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) doit retourner `true` quand une chaîne null ou vide est passée pour le chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="6a121-273">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="6a121-274">Copie d’éléments</span><span class="sxs-lookup"><span data-stu-id="6a121-274">Copying Items</span></span>

<span data-ttu-id="6a121-275">Pour copier des éléments, le fournisseur de conteneurs doit implémenter la méthode [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) pour prendre en charge les appels à partir de l’applet de commande `Copy-Item` .</span><span class="sxs-lookup"><span data-stu-id="6a121-275">To copy items, the container provider must implement the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="6a121-276">Cette méthode copie un élément de données à partir de l’emplacement indiqué par le `path` paramètre de l’applet de commande à l’emplacement indiqué par le `copyPath` paramètre.</span><span class="sxs-lookup"><span data-stu-id="6a121-276">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="6a121-277">Si le `recurse` paramètre est spécifié, la méthode copie tous les sous-conteneurs.</span><span class="sxs-lookup"><span data-stu-id="6a121-277">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="6a121-278">Si le paramètre n’est pas spécifié, la méthode copie uniquement un seul niveau d’éléments.</span><span class="sxs-lookup"><span data-stu-id="6a121-278">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="6a121-279">Ce fournisseur n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6a121-279">This provider does not implement this method.</span></span> <span data-ttu-id="6a121-280">Toutefois, le code suivant est l’implémentation par défaut de [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span><span class="sxs-lookup"><span data-stu-id="6a121-280">However, the following code is the default implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="6a121-281">Points à retenir concernant l’implémentation de CopyItem</span><span class="sxs-lookup"><span data-stu-id="6a121-281">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="6a121-282">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="6a121-282">The following conditions may apply to your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="6a121-283">Lors de la définition de la classe de fournisseur, un fournisseur de conteneurs Windows PowerShell peut déclarer des fonctionnalités de fournisseur de ExpandWildcards, Filter, include ou Exclude, à partir de l’énumération [System. Management. Automation. Provider. Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) .</span><span class="sxs-lookup"><span data-stu-id="6a121-283">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="6a121-284">Dans ces cas, l’implémentation de la méthode [System. Management. Automation. Provider. Containercmdletprovider. GetChildItems \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) doit garantir que le chemin d’accès passé à la méthode répond aux exigences des fonctionnalités spécifiées.</span><span class="sxs-lookup"><span data-stu-id="6a121-284">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="6a121-285">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, les propriétés [System. Management. Automation. Provider. Cmdletprovider. Exclude \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [System. Management. Automation. Provider. Cmdletprovider. include \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) .</span><span class="sxs-lookup"><span data-stu-id="6a121-285">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="6a121-286">Par défaut, les substitutions de cette méthode ne doivent pas copier des objets sur des objets existants, à moins que la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) ait la valeur `true` .</span><span class="sxs-lookup"><span data-stu-id="6a121-286">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="6a121-287">Par exemple, le fournisseur FileSystem ne copie pas c:\temp\abc.txt sur un fichier c:\abc.txt existant, à moins que la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) ait la valeur `true` .</span><span class="sxs-lookup"><span data-stu-id="6a121-287">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="6a121-288">Si le chemin d’accès spécifié dans le `copyPath` paramètre existe et qu’il indique un conteneur, la propriété [System. Management. Automation. Provider. Cmdletprovider. force \*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="6a121-288">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="6a121-289">Dans ce cas, [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) doit copier l’élément indiqué par le `path` paramètre dans le conteneur indiqué par le `copyPath` paramètre en tant qu’enfant.</span><span class="sxs-lookup"><span data-stu-id="6a121-289">In this case, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="6a121-290">Votre implémentation de [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) est chargée d’empêcher la récurrence infinie lorsqu’il y a des liens circulaires, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="6a121-290">Your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="6a121-291">Une exception d’arrêt appropriée doit être levée pour refléter une telle condition.</span><span class="sxs-lookup"><span data-stu-id="6a121-291">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="6a121-292">Votre implémentation de la méthode [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) doit appeler [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) et vérifier sa valeur de retour avant d’apporter des modifications au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="6a121-292">Your implementation of the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="6a121-293">Une fois que l’appel à [System. Management. Automation. Provider. Cmdletprovider. ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourne la valeur true, la méthode [System. Management. Automation. Provider. ContainerCmdletProvider. CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) doit appeler la méthode [System. Management. Automation. Provider. Cmdletprovider. ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) pour effectuer un contrôle supplémentaire des modifications système potentiellement dangereuses.</span><span class="sxs-lookup"><span data-stu-id="6a121-293">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="6a121-294">Pour plus d’informations sur l’appel de ces méthodes, consultez [Renommer des éléments](#renaming-items).</span><span class="sxs-lookup"><span data-stu-id="6a121-294">For more information about calling these methods, see [Rename Items](#renaming-items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="6a121-295">Attachement de paramètres dynamiques à l’applet de commande Copy-Item</span><span class="sxs-lookup"><span data-stu-id="6a121-295">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="6a121-296">Parfois, l’applet de commande `Copy-Item` requiert des paramètres supplémentaires spécifiés de manière dynamique au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="6a121-296">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="6a121-297">Pour fournir ces paramètres dynamiques, le fournisseur de conteneurs Windows PowerShell doit implémenter la méthode [System. Management. Automation. Provider. Containercmdletprovider. Copyitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) pour gérer ces paramètres.</span><span class="sxs-lookup"><span data-stu-id="6a121-297">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="6a121-298">Cette méthode récupère les paramètres pour l’élément au chemin d’accès indiqué et retourne un objet qui a des propriétés et des champs avec des attributs d’analyse similaires à une classe d’applet de commande ou à un objet [System. Management. Automation. RuntimeDefinedParameterDictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) .</span><span class="sxs-lookup"><span data-stu-id="6a121-298">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="6a121-299">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à l' `Copy-Item` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="6a121-299">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="6a121-300">Ce fournisseur n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6a121-300">This provider does not implement this method.</span></span> <span data-ttu-id="6a121-301">Toutefois, le code suivant est l’implémentation par défaut de [System. Management. Automation. Provider. Containercmdletprovider. Copyitemdynamicparameters \*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="6a121-301">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="6a121-302">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="6a121-302">Code Sample</span></span>

<span data-ttu-id="6a121-303">Pour obtenir un exemple de code complet, consultez [exemple de code AccessDbProviderSample04](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="6a121-303">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="6a121-304">Génération du fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6a121-304">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="6a121-305">Découvrez [comment inscrire des applets de commande, des fournisseurs et des applications hôtes](/previous-versions/ms714644(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="6a121-305">See [How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85)).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="6a121-306">Test du fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6a121-306">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="6a121-307">Lorsque votre fournisseur Windows PowerShell a été inscrit auprès de Windows PowerShell, vous pouvez le tester en exécutant les applets de commande prises en charge sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="6a121-307">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="6a121-308">N’oubliez pas que l’exemple de sortie suivant utilise une base de données d’accès fictif.</span><span class="sxs-lookup"><span data-stu-id="6a121-308">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="6a121-309">Exécutez l' `Get-ChildItem` applet de commande pour récupérer la liste des éléments enfants d’une table Customers dans la base de données Access.</span><span class="sxs-lookup"><span data-stu-id="6a121-309">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="6a121-310">La sortie suivante apparaît.</span><span class="sxs-lookup"><span data-stu-id="6a121-310">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="6a121-311">Exécutez à `Get-ChildItem` nouveau l’applet de commande pour récupérer les données d’une table.</span><span class="sxs-lookup"><span data-stu-id="6a121-311">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="6a121-312">La sortie suivante apparaît.</span><span class="sxs-lookup"><span data-stu-id="6a121-312">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="6a121-313">Utilisez maintenant l' `Get-Item` applet de commande pour récupérer les éléments à la ligne 0 dans la table de données.</span><span class="sxs-lookup"><span data-stu-id="6a121-313">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="6a121-314">La sortie suivante apparaît.</span><span class="sxs-lookup"><span data-stu-id="6a121-314">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="6a121-315">Réutilisez `Get-Item` pour récupérer les données pour les éléments de la ligne 0.</span><span class="sxs-lookup"><span data-stu-id="6a121-315">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="6a121-316">La sortie suivante apparaît.</span><span class="sxs-lookup"><span data-stu-id="6a121-316">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="6a121-317">Utilisez maintenant l' `New-Item` applet de commande pour ajouter une ligne à une table existante.</span><span class="sxs-lookup"><span data-stu-id="6a121-317">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="6a121-318">Le `Path` paramètre spécifie le chemin d’accès complet à la ligne et doit indiquer un numéro de ligne qui est supérieur au nombre de lignes existant dans la table.</span><span class="sxs-lookup"><span data-stu-id="6a121-318">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="6a121-319">Le `Type` paramètre indique « Row » pour spécifier ce type d’élément à ajouter.</span><span class="sxs-lookup"><span data-stu-id="6a121-319">The `Type` parameter indicates "row" to specify that type of item to add.</span></span>
   <span data-ttu-id="6a121-320">Enfin, le `Value` paramètre spécifie une liste délimitée par des virgules de valeurs de colonne pour la ligne.</span><span class="sxs-lookup"><span data-stu-id="6a121-320">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAddress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="6a121-321">Vérifiez l’exactitude de la nouvelle opération d’élément comme suit.</span><span class="sxs-lookup"><span data-stu-id="6a121-321">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="6a121-322">La sortie suivante apparaît.</span><span class="sxs-lookup"><span data-stu-id="6a121-322">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="6a121-323">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6a121-323">See Also</span></span>

[<span data-ttu-id="6a121-324">Création de fournisseurs Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6a121-324">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="6a121-325">Conception de votre fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6a121-325">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="6a121-326">Implémentation d’un fournisseur Windows PowerShell d’élément</span><span class="sxs-lookup"><span data-stu-id="6a121-326">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="6a121-327">Implémentation d’un fournisseur de navigation Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6a121-327">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

<span data-ttu-id="6a121-328">[Comment inscrire des applets de commande, des fournisseurs et des applications hôtes](/previous-versions/ms714644(v=vs.85))</span><span class="sxs-lookup"><span data-stu-id="6a121-328">[How to Register Cmdlets, Providers, and Host Applications](/previous-versions/ms714644(v=vs.85))</span></span>

[<span data-ttu-id="6a121-329">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="6a121-329">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="6a121-330">Guide de programmation pour Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="6a121-330">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)
