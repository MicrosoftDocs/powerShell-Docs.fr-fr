---
ms.date: 01/18/2019
ms.topic: reference
title: Types de sortie des applets de commande
description: Types de sortie des applets de commande
ms.openlocfilehash: 591b7699e951db9016e48d5ef623265e23791e11
ms.sourcegitcommit: ba7315a496986451cfc1296b659d73ea2373d3f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/10/2020
ms.locfileid: "92660499"
---
# <a name="types-of-cmdlet-output"></a><span data-ttu-id="78b8a-103">Types de sortie de l’applet de commande</span><span class="sxs-lookup"><span data-stu-id="78b8a-103">Types of cmdlet output</span></span>

<span data-ttu-id="78b8a-104">PowerShell offre plusieurs méthodes qui peuvent être appelées par les applets de commande pour générer la sortie.</span><span class="sxs-lookup"><span data-stu-id="78b8a-104">PowerShell provides several methods that can be called by cmdlets to generate output.</span></span> <span data-ttu-id="78b8a-105">Ces méthodes utilisent une opération spécifique pour écrire leur sortie dans un flux de données spécifique, tel que le flux de données de réussite ou le flux de données d’erreur.</span><span class="sxs-lookup"><span data-stu-id="78b8a-105">These methods use a specific operation to write their output to a specific data stream, such as the success data stream or the error data stream.</span></span> <span data-ttu-id="78b8a-106">Cet article décrit les types de sortie et les méthodes utilisées pour les générer.</span><span class="sxs-lookup"><span data-stu-id="78b8a-106">This article describes the types of output and the methods used to generate them.</span></span>

## <a name="types-of-output"></a><span data-ttu-id="78b8a-107">Types de sortie</span><span class="sxs-lookup"><span data-stu-id="78b8a-107">Types of output</span></span>

### <a name="success-output"></a><span data-ttu-id="78b8a-108">Sortie de réussite</span><span class="sxs-lookup"><span data-stu-id="78b8a-108">Success output</span></span>

<span data-ttu-id="78b8a-109">Les applets de commande peuvent signaler la réussite en retournant un objet qui peut être traité par la commande suivante dans le pipeline.</span><span class="sxs-lookup"><span data-stu-id="78b8a-109">Cmdlets can report success by returning an object that can be processed by the next command in the pipeline.</span></span> <span data-ttu-id="78b8a-110">Une fois que l’applet de commande a effectué son action, l’applet de commande appelle la méthode [System. Management. Automation. cmdlet. WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) .</span><span class="sxs-lookup"><span data-stu-id="78b8a-110">After the cmdlet has successfully performed its action, the cmdlet calls the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="78b8a-111">Nous vous recommandons d’appeler cette méthode à la place des méthodes [System. Console. WriteLine](/dotnet/api/System.Console.WriteLine) ou [System. Management. Automation. Host. PSHostUserInterface. WriteLine](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.WriteLine) .</span><span class="sxs-lookup"><span data-stu-id="78b8a-111">We recommend that you call this method instead of the [System.Console.WriteLine](/dotnet/api/System.Console.WriteLine) or [System.Management.Automation.Host.PSHostUserInterface.WriteLine](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.WriteLine) methods.</span></span>

<span data-ttu-id="78b8a-112">Vous pouvez fournir un paramètre de commutateur **PassThru** pour les applets de commande qui ne retournent généralement pas d’objets.</span><span class="sxs-lookup"><span data-stu-id="78b8a-112">You can provide a **PassThru** switch parameter for cmdlets that do not typically return objects.</span></span>
<span data-ttu-id="78b8a-113">Lorsque le paramètre de commutateur **PassThru** est spécifié sur la ligne de commande, l’applet de commande est invitée à retourner un objet.</span><span class="sxs-lookup"><span data-stu-id="78b8a-113">When the **PassThru** switch parameter is specified at the command line, the cmdlet is asked to return an object.</span></span> <span data-ttu-id="78b8a-114">Pour obtenir un exemple d’applet de commande qui a un paramètre **PassThru** , consultez [Add-History](/powershell/module/Microsoft.PowerShell.Core/Add-History).</span><span class="sxs-lookup"><span data-stu-id="78b8a-114">For an example of a cmdlet that has a **PassThru** parameter, see [Add-History](/powershell/module/Microsoft.PowerShell.Core/Add-History).</span></span>

### <a name="error-output"></a><span data-ttu-id="78b8a-115">Sortie d’erreur</span><span class="sxs-lookup"><span data-stu-id="78b8a-115">Error output</span></span>

<span data-ttu-id="78b8a-116">Les applets de commande peuvent signaler des erreurs.</span><span class="sxs-lookup"><span data-stu-id="78b8a-116">Cmdlets can report errors.</span></span> <span data-ttu-id="78b8a-117">Lorsqu’une erreur se termine, l’applet de commande lève une exception.</span><span class="sxs-lookup"><span data-stu-id="78b8a-117">When a terminating error occurs, the cmdlet throws an exception.</span></span> <span data-ttu-id="78b8a-118">Lorsqu’une erreur sans fin d’exécution se produit, l’applet de commande appelle la méthode [System. Management. Automation. Provider. CmdletProvider. WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) pour envoyer un enregistrement d’erreur au flux de données d’erreur.</span><span class="sxs-lookup"><span data-stu-id="78b8a-118">When a non-terminating error occurs, the cmdlet calls the [System.Management.Automation.Provider.CmdletProvider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method to send an error record to the error data stream.</span></span> <span data-ttu-id="78b8a-119">Pour plus d’informations sur le rapport d’erreurs, consultez [concepts du rapport d’erreurs](./error-reporting-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="78b8a-119">For more information about error reporting, see [Error Reporting Concepts](./error-reporting-concepts.md).</span></span>

### <a name="verbose-output"></a><span data-ttu-id="78b8a-120">Sortie détaillée.</span><span class="sxs-lookup"><span data-stu-id="78b8a-120">Verbose output</span></span>

<span data-ttu-id="78b8a-121">Les applets de commande peuvent vous fournir des informations utiles pendant que l’applet de commande traite correctement les enregistrements en appelant la méthode [System. Management. Automation. applet de commande. WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) .</span><span class="sxs-lookup"><span data-stu-id="78b8a-121">Cmdlets can provide useful information to you while the cmdlet is correctly processing records by calling the [System.Management.Automation.Cmdlet.WriteVerbose](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method.</span></span> <span data-ttu-id="78b8a-122">La méthode génère des messages détaillés qui indiquent le mode de poursuite de l’action.</span><span class="sxs-lookup"><span data-stu-id="78b8a-122">The method generates verbose messages that indicate how the action is proceeding.</span></span>

<span data-ttu-id="78b8a-123">Par défaut, les messages détaillés ne sont pas affichés.</span><span class="sxs-lookup"><span data-stu-id="78b8a-123">By default, verbose messages are not displayed.</span></span> <span data-ttu-id="78b8a-124">Vous pouvez spécifier le paramètre **Verbose** lors de l’exécution de l’applet de commande pour afficher ces messages.</span><span class="sxs-lookup"><span data-stu-id="78b8a-124">You can specify the **Verbose** parameter when the cmdlet is run to display these messages.</span></span> <span data-ttu-id="78b8a-125">**Verbose** est un paramètre commun qui est disponible pour toutes les applets de commande.</span><span class="sxs-lookup"><span data-stu-id="78b8a-125">**Verbose** is a common parameter that is available to all cmdlets.</span></span>

### <a name="progress-output"></a><span data-ttu-id="78b8a-126">Sortie de la progression</span><span class="sxs-lookup"><span data-stu-id="78b8a-126">Progress output</span></span>

<span data-ttu-id="78b8a-127">Les applets de commande peuvent vous fournir des informations de progression lorsque l’applet de commande exécute des tâches dont l’exécution prend beaucoup de temps, par exemple la copie d’un répertoire de manière récursive.</span><span class="sxs-lookup"><span data-stu-id="78b8a-127">Cmdlets can provide progress information to you when the cmdlet is performing tasks that take a long time to complete, such as copying a directory recursively.</span></span> <span data-ttu-id="78b8a-128">Pour afficher les informations de progression, l’applet de commande appelle la méthode [System. Management. Automation. applet](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) de commande. WriteProgress.</span><span class="sxs-lookup"><span data-stu-id="78b8a-128">To display progress information the cmdlet calls the [System.Management.Automation.Cmdlet.WriteProgress](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) method.</span></span>

### <a name="debug-output"></a><span data-ttu-id="78b8a-129">Sortie de débogage</span><span class="sxs-lookup"><span data-stu-id="78b8a-129">Debug output</span></span>

<span data-ttu-id="78b8a-130">Les applets de commande peuvent fournir des messages de débogage qui sont utiles lors du dépannage du code de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="78b8a-130">Cmdlets can provide debug messages that are helpful when troubleshooting the cmdlet code.</span></span> <span data-ttu-id="78b8a-131">Pour afficher les informations de débogage, l’applet de commande appelle la méthode [System. Management. Automation. applet](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) de commande. WriteDebug.</span><span class="sxs-lookup"><span data-stu-id="78b8a-131">To display debug information the cmdlet calls the [System.Management.Automation.Cmdlet.WriteDebug](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method.</span></span>

<span data-ttu-id="78b8a-132">Par défaut, les messages de débogage ne sont pas affichés.</span><span class="sxs-lookup"><span data-stu-id="78b8a-132">By default, debug messages are not displayed.</span></span> <span data-ttu-id="78b8a-133">Vous pouvez spécifier le paramètre de **débogage** lors de l’exécution de l’applet de commande pour afficher ces messages.</span><span class="sxs-lookup"><span data-stu-id="78b8a-133">You can specify the **Debug** parameter when the cmdlet is run to display these messages.</span></span> <span data-ttu-id="78b8a-134">**Debug** est un paramètre courant qui est disponible pour toutes les applets de commande.</span><span class="sxs-lookup"><span data-stu-id="78b8a-134">**Debug** is a common parameter that is available to all cmdlets.</span></span>

### <a name="warning-output"></a><span data-ttu-id="78b8a-135">Sortie d’avertissement</span><span class="sxs-lookup"><span data-stu-id="78b8a-135">Warning output</span></span>

<span data-ttu-id="78b8a-136">Les applets de commande peuvent afficher des messages d’avertissement en appelant la méthode [System. Management. Automation. applet de commande. WriteWarning](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) .</span><span class="sxs-lookup"><span data-stu-id="78b8a-136">Cmdlets can display warning messages by calling the [System.Management.Automation.Cmdlet.WriteWarning](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) method.</span></span>

<span data-ttu-id="78b8a-137">Par défaut, les messages d’avertissement s’affichent.</span><span class="sxs-lookup"><span data-stu-id="78b8a-137">By default, warning messages are displayed.</span></span> <span data-ttu-id="78b8a-138">Toutefois, vous pouvez configurer des messages d’avertissement à l’aide de la `$WarningPreference` variable ou à l’aide des paramètres **détaillés** et de **débogage** lorsque l’applet de commande est appelée.</span><span class="sxs-lookup"><span data-stu-id="78b8a-138">However, you can configure warning messages by using the `$WarningPreference` variable or by using the **Verbose** and **Debug** parameters when the cmdlet is called.</span></span>

## <a name="displaying-output"></a><span data-ttu-id="78b8a-139">Affichage de la sortie</span><span class="sxs-lookup"><span data-stu-id="78b8a-139">Displaying output</span></span>

<span data-ttu-id="78b8a-140">Pour tous les appels de méthode d’écriture, l’affichage du contenu est déterminé par des variables d’exécution spécifiques.</span><span class="sxs-lookup"><span data-stu-id="78b8a-140">For all write-method calls, the content display is determined by specific runtime variables.</span></span> <span data-ttu-id="78b8a-141">L’exception est la méthode [System. Management. Automation. cmdlet. WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) .</span><span class="sxs-lookup"><span data-stu-id="78b8a-141">The exception is the [System.Management.Automation.Cmdlet.WriteObject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="78b8a-142">À l’aide de ces variables, vous pouvez effectuer l’appel d’écriture approprié à l’emplacement approprié dans votre code et vous ne devez pas vous préoccuper de la date ou de l’affichage de la sortie.</span><span class="sxs-lookup"><span data-stu-id="78b8a-142">By using these variables, you can make the appropriate write call at the correct place in your code and not worry about when or if the output should be displayed.</span></span>

## <a name="accessing-the-output-functionality-of-a-host-application"></a><span data-ttu-id="78b8a-143">Accès aux fonctionnalités de sortie d’une application hôte</span><span class="sxs-lookup"><span data-stu-id="78b8a-143">Accessing the output functionality of a host application</span></span>

<span data-ttu-id="78b8a-144">Vous pouvez également concevoir une applet de commande pour accéder directement aux fonctionnalités de sortie d’une application hôte par le biais du runtime PowerShell.</span><span class="sxs-lookup"><span data-stu-id="78b8a-144">You can also design a cmdlet to directly access the output functionality of a host application through the PowerShell runtime.</span></span> <span data-ttu-id="78b8a-145">L’utilisation des API d’hôte fournies par PowerShell au lieu de [System. console](/dotnet/api/System.Console) ou de [System. Windows. Forms](/dotnet/api/System.Windows.Forms) garantit que votre applet de commande fonctionne avec un large éventail d’hôtes.</span><span class="sxs-lookup"><span data-stu-id="78b8a-145">Using the host APIs provided by PowerShell instead of [System.Console](/dotnet/api/System.Console) or [System.Windows.Forms](/dotnet/api/System.Windows.Forms) ensures that your cmdlet will work with a variety of hosts.</span></span> <span data-ttu-id="78b8a-146">Par exemple : l’hôte de la console **powershell.exe** , l’hôte graphique **powershell_ise.exe** , l’hôte de communication à distance PowerShell et les hôtes tiers.</span><span class="sxs-lookup"><span data-stu-id="78b8a-146">For example: the **powershell.exe** console host, the **powershell_ise.exe** graphical host, the PowerShell remoting host, and third-party hosts.</span></span>

## <a name="see-also"></a><span data-ttu-id="78b8a-147">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="78b8a-147">See also</span></span>

[<span data-ttu-id="78b8a-148">Concepts des rapports d’erreurs</span><span class="sxs-lookup"><span data-stu-id="78b8a-148">Error Reporting Concepts</span></span>](./error-reporting-concepts.md)

[<span data-ttu-id="78b8a-149">Vue d’ensemble des applets de commande</span><span class="sxs-lookup"><span data-stu-id="78b8a-149">Cmdlet Overview</span></span>](./cmdlet-overview.md)

[<span data-ttu-id="78b8a-150">Écriture d’une applet de commande Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="78b8a-150">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
