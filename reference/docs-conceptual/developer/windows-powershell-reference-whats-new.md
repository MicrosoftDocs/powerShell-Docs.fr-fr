---
title: Informations de référence sur Windows PowerShell-nouveautés
ms.date: 09/13/2016
ms.topic: article
ms.openlocfilehash: 364d081ddf2f87ceeaa47732266a35f4a126246f
ms.sourcegitcommit: 52a67bcd9d7bf3e8600ea4302d1fa8970ff9c998
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/15/2019
ms.locfileid: "72366088"
---
# <a name="whats-new"></a><span data-ttu-id="1b0a8-102">Nouveautés</span><span class="sxs-lookup"><span data-stu-id="1b0a8-102">What's New</span></span>

<span data-ttu-id="1b0a8-103">Windows PowerShell 2,0 fournit les nouvelles fonctionnalités suivantes à utiliser lors de l’écriture d’applets de commande, de fournisseurs et d’applications hôtes.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-103">Windows PowerShell 2.0 provides the following new features for use when writing cmdlets, providers, and host applications.</span></span>

## <a name="modules"></a><span data-ttu-id="1b0a8-104">Modules</span><span class="sxs-lookup"><span data-stu-id="1b0a8-104">Modules</span></span>

<span data-ttu-id="1b0a8-105">Vous pouvez désormais empaqueter et distribuer des solutions Windows PowerShell à l’aide de modules.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-105">You can now package and distribute Windows PowerShell solutions by using modules.</span></span> <span data-ttu-id="1b0a8-106">Les modules vous permettent de partitionner, d’organiser et d’abstraire votre code Windows PowerShell en unités autonomes réutilisables.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-106">Modules allow you to partition, organize, and abstract your Windows PowerShell code into self-contained, reusable units.</span></span> <span data-ttu-id="1b0a8-107">Pour plus d’informations sur les modules, consultez écriture d’un module Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-107">For more information about modules, see Writing a Windows PowerShell Module.</span></span>

## <a name="the-powershell-class"></a><span data-ttu-id="1b0a8-108">Classe PowerShell</span><span class="sxs-lookup"><span data-stu-id="1b0a8-108">The PowerShell class</span></span>

<span data-ttu-id="1b0a8-109">La classe PowerShell fournit une solution plus simple pour la création d’applications, appelées applications hôtes, qui exécutent des commandes par programmation.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-109">The PowerShell class provides a simpler solution for creating applications, referred to as host applications, that programmatically run commands.</span></span> <span data-ttu-id="1b0a8-110">Cette classe vous permet de créer un pipeline de commandes, de spécifier l’instance d’exécution utilisée pour exécuter les commandes et de spécifier l’appel des commandes de façon synchrone ou asynchrone.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-110">This class allows you to create a pipeline of commands, specify the runspace that is used to run the commands, and specify invoking the commands synchronously or asynchronously.</span></span>

## <a name="the-runspacepool-class"></a><span data-ttu-id="1b0a8-111">La classe RunspacePool</span><span class="sxs-lookup"><span data-stu-id="1b0a8-111">The RunspacePool class</span></span>

<span data-ttu-id="1b0a8-112">Les pools d’instances d’exécution vous permettent de créer plusieurs instances d’exécution à l’aide d’un seul appel.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-112">Runspace pools allow you to create multiple runspaces by using a single call.</span></span> <span data-ttu-id="1b0a8-113">La méthode CreateRunspacePool fournit plusieurs surcharges qui peuvent être utilisées pour créer des instances d’exécution qui ont les mêmes fonctionnalités, telles que le même hôte, l’état de session initial et les informations de connexion.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-113">The CreateRunspacePool method provides several overloads that can be used to create runspaces that have the same features, such as the same host, initial session state, and connection information.</span></span>

## <a name="the-initialsessionstate-class"></a><span data-ttu-id="1b0a8-114">La classe InitialSessionState</span><span class="sxs-lookup"><span data-stu-id="1b0a8-114">The InitialSessionState class</span></span>

<span data-ttu-id="1b0a8-115">La classe InitialSessionState vous permet de créer une configuration d’état de session qui est utilisée lorsqu’une instance d’exécution est ouverte.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-115">The InitialSessionState class allows you to create a session state configuration that is used when a runspace is opened.</span></span> <span data-ttu-id="1b0a8-116">Vous pouvez créer une configuration personnalisée, une configuration par défaut qui comprend les commandes fournies par mshshort et une configuration dont les commandes sont limitées en fonction des fonctionnalités de la session.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-116">You can create a custom configuration, a default configuration that includes the commands provided by mshshort, and a configuration whose commands are restricted based on the capabilities of the session.</span></span>

## <a name="remote-runspaces"></a><span data-ttu-id="1b0a8-117">Instances d’exécution à distance</span><span class="sxs-lookup"><span data-stu-id="1b0a8-117">Remote runspaces</span></span>

<span data-ttu-id="1b0a8-118">Vous pouvez maintenant créer des instances d’exécution qui peuvent être ouverts sur des ordinateurs distants, ce qui vous permet d’exécuter des commandes sur l’ordinateur distant et de collecter les résultats localement.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-118">You can now create runspaces that can be opened on remote computers, allowing you to run commands on the remote machine and collect the results locally.</span></span> <span data-ttu-id="1b0a8-119">Pour créer une instance d’exécution distante, vous devez spécifier des informations sur la connexion distante lors de la création de l’instance d’exécution.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-119">To create a remote runspace, you must specify information about the remote connection when creating the runspace.</span></span> <span data-ttu-id="1b0a8-120">Pour obtenir des exemples, consultez les méthodes CreateRunspace et CreateRunspacePool.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-120">See the CreateRunspace and CreateRunspacePool methods for examples.</span></span> <span data-ttu-id="1b0a8-121">Les informations de connexion sont définies par la classe RunspaceConnectionInfo.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-121">The connection information is defined by the RunspaceConnectionInfo class.</span></span>

## <a name="private-runspace-elements"></a><span data-ttu-id="1b0a8-122">Éléments d’instance d’exécution privés</span><span class="sxs-lookup"><span data-stu-id="1b0a8-122">Private runspace elements</span></span>

<span data-ttu-id="1b0a8-123">Vous pouvez maintenant créer des instances d’exécution dont les éléments sont publics ou privés.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-123">You can now create runspaces whose elements are public or private.</span></span> <span data-ttu-id="1b0a8-124">Cela vous permet de créer des instances d’exécution dont les éléments sont disponibles pour l’instance d’exécution, mais qui ne sont pas accessibles à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-124">This allows you to create runspaces whose elements are available to the runspace, but are not available to the user.</span></span> <span data-ttu-id="1b0a8-125">Consultez la classe ConstrainedSessionStateEntry pour connaître les éléments de l’instance d’exécution qui peuvent être rendus privés.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-125">See the ConstrainedSessionStateEntry class to find out which elements of the runspace can be made private.</span></span>

## <a name="runspace-threading-modes-and-apartment-state"></a><span data-ttu-id="1b0a8-126">Modes de thread de l’instance d’exécution et état de cloisonnement</span><span class="sxs-lookup"><span data-stu-id="1b0a8-126">Runspace threading modes and apartment state</span></span>

<span data-ttu-id="1b0a8-127">Vous pouvez maintenant spécifier la manière dont les threads sont créés et utilisés lors de l’exécution de commandes dans une instance d’exécution.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-127">You can now specify how threads are created and used when running commands in a runspace.</span></span> <span data-ttu-id="1b0a8-128">Consultez les propriétés System. Management. Automation. instances d’exécution. Runspace. ThreadOptions et System. Management. Automation. instances d’exécution. RunspacePool. ThreadOptions.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-128">See the System.Management.Automation.Runspaces.Runspace.ThreadOptions and System.Management.Automation.Runspaces.RunspacePool.ThreadOptions properties.</span></span>

<span data-ttu-id="1b0a8-129">Vous pouvez désormais obtenir l’état de cloisonnement des threads utilisés pour exécuter des commandes dans une instance d’exécution.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-129">You can now get the apartment state of the threads that are used to run commands in a runspace.</span></span> <span data-ttu-id="1b0a8-130">Consultez les propriétés System. Management. Automation. instances d’exécution. Runspace. ApartmentState et System. Management. Automation. instances d’exécution. RunspacePool. ApartmentState.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-130">See the System.Management.Automation.Runspaces.Runspace.ApartmentState and System.Management.Automation.Runspaces.RunspacePool.ApartmentState properties.</span></span>

## <a name="transaction-cmdlets"></a><span data-ttu-id="1b0a8-131">Applets de commande de transaction</span><span class="sxs-lookup"><span data-stu-id="1b0a8-131">Transaction cmdlets</span></span>

<span data-ttu-id="1b0a8-132">Vous pouvez maintenant créer des applets de commande qui peuvent être utilisées dans une transaction.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-132">You can now create cmdlets that can be used within a transaction.</span></span> <span data-ttu-id="1b0a8-133">Lorsqu’une applet de commande est utilisée dans une transaction, ses actions sont temporaires et peuvent être acceptées ou rejetées par les applets de commande de transaction fournies par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-133">When a cmdlet is used in a transaction, its actions are temporary, and they can be accepted or rejected by the transaction cmdlets provided by Windows PowerShell.</span></span>

<span data-ttu-id="1b0a8-134">Pour plus d’informations sur les transactions, consultez How to support transactions.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-134">For more information about transactions, see How to Support Transactions.</span></span>

## <a name="transaction-provider"></a><span data-ttu-id="1b0a8-135">Fournisseur de transactions</span><span class="sxs-lookup"><span data-stu-id="1b0a8-135">Transaction provider</span></span>

<span data-ttu-id="1b0a8-136">Vous pouvez désormais créer des fournisseurs qui peuvent être utilisés dans une transaction.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-136">You can now create providers that can be used within a transaction.</span></span> <span data-ttu-id="1b0a8-137">Comme pour les applets de commande, lorsqu’un fournisseur est utilisé dans une transaction, ses actions sont temporaires et peuvent être acceptées ou rejetées par les applets de commande de transaction fournies par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-137">Similar to cmdlets, when a provider is used in a transaction, its actions are temporary, and they can be accepted or rejected by the transaction cmdlets provided by Windows PowerShell.</span></span>

<span data-ttu-id="1b0a8-138">Pour plus d’informations sur la spécification de la prise en charge de transaction dans une classe de fournisseur, consultez la propriété System. Management. Automation. Provider. CmdletProviderAttribute. ProviderCapabilities.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-138">For more information about specifying support for transaction within a provider class, see the System.Management.Automation.Provider.CmdletProviderAttribute.ProviderCapabilities property.</span></span>

## <a name="job-cmdlets"></a><span data-ttu-id="1b0a8-139">Applets de commande Job</span><span class="sxs-lookup"><span data-stu-id="1b0a8-139">Job cmdlets</span></span>

<span data-ttu-id="1b0a8-140">Vous pouvez maintenant écrire des applets de commande qui peuvent exécuter leur action en tant que tâche.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-140">You can now write cmdlets that can perform their action as a job.</span></span> <span data-ttu-id="1b0a8-141">Ces travaux sont exécutés en arrière-plan sans interagir avec la session active.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-141">These jobs are run in the background without interacting with the current session.</span></span> <span data-ttu-id="1b0a8-142">Pour plus d’informations sur la façon dont Windows PowerShell prend en charge les travaux, consultez travaux en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-142">For more information about how Windows PowerShell supports jobs, see Background Jobs.</span></span>

## <a name="cmdlet-output-types"></a><span data-ttu-id="1b0a8-143">Types de sortie de l’applet de commande</span><span class="sxs-lookup"><span data-stu-id="1b0a8-143">Cmdlet output types</span></span>

<span data-ttu-id="1b0a8-144">Vous pouvez maintenant spécifier les types de .NET Framework qui sont retournés par vos applets de commande en déclarant l’attribut OutputType lors de l’écriture de vos applets de commande.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-144">You can now specify the .NET Framework types that are returned by your cmdlets by declaring the OutputType attribute when writing your cmdlets.</span></span> <span data-ttu-id="1b0a8-145">Cela permet à d’autres utilisateurs de déterminer le type d’objets qui sont renvoyés par une applet de commande en regardant la propriété OutputType de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-145">This will allow others to determine what type of objects are returned by a cmdlet by looking at the OutputType property of the cmdlet.</span></span>

## <a name="event-support"></a><span data-ttu-id="1b0a8-146">Prise en charge des événements</span><span class="sxs-lookup"><span data-stu-id="1b0a8-146">Event support</span></span>

<span data-ttu-id="1b0a8-147">Vous pouvez maintenant écrire des applets de commande qui ajoutent et consomment des événements.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-147">You can now write cmdlets that add and consume events.</span></span> <span data-ttu-id="1b0a8-148">Consultez la classe PSEvent.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-148">See the PSEvent class.</span></span>

## <a name="proxy-commands"></a><span data-ttu-id="1b0a8-149">Commandes de proxy</span><span class="sxs-lookup"><span data-stu-id="1b0a8-149">Proxy commands</span></span>

<span data-ttu-id="1b0a8-150">Vous pouvez maintenant écrire des commandes de proxy qui peuvent être utilisées pour exécuter une autre commande.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-150">You can now write proxy commands that can be used to run another command.</span></span> <span data-ttu-id="1b0a8-151">Une commande de proxy vous permet de contrôler la fonctionnalité de l’applet de commande source qui est disponible pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-151">A proxy command allows you to control what functionality of the source cmdlet is available to the user.</span></span> <span data-ttu-id="1b0a8-152">Par exemple, vous pouvez créer une commande de proxy qui supprime un paramètre fourni par la commande source.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-152">For example, you can create a proxy command that removes a parameter that is supplied by the source command.</span></span> <span data-ttu-id="1b0a8-153">Consultez la classe ProxyCommand.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-153">See the ProxyCommand class.</span></span>

## <a name="multiple-choice-prompts"></a><span data-ttu-id="1b0a8-154">Demandes à choix multiples</span><span class="sxs-lookup"><span data-stu-id="1b0a8-154">Multiple choice prompts</span></span>

<span data-ttu-id="1b0a8-155">Vous pouvez maintenant écrire des applications qui peuvent fournir des invites qui permettent à l’utilisateur de sélectionner plusieurs choix.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-155">You can now write applications that can provide prompts that allow the user to select multiple choices.</span></span> <span data-ttu-id="1b0a8-156">Consultez l’interface IHostUISupportsMultipleChoiceSelection</span><span class="sxs-lookup"><span data-stu-id="1b0a8-156">See the IHostUISupportsMultipleChoiceSelection interface</span></span>

## <a name="interactive-sessions"></a><span data-ttu-id="1b0a8-157">Sessions interactives</span><span class="sxs-lookup"><span data-stu-id="1b0a8-157">Interactive sessions</span></span>

<span data-ttu-id="1b0a8-158">Vous pouvez maintenant écrire des applications qui peuvent démarrer et arrêter une session interactive sur un ordinateur distant.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-158">You can now write applications that can start and stop an interactive session on a remote computer.</span></span>
<span data-ttu-id="1b0a8-159">Consultez l’interface IHostSupportsInteractiveSession.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-159">See the IHostSupportsInteractiveSession interface.</span></span>

## <a name="custom-cmdlet-help-for-providers"></a><span data-ttu-id="1b0a8-160">Aide sur les applets de commande personnalisées pour les fournisseurs</span><span class="sxs-lookup"><span data-stu-id="1b0a8-160">Custom Cmdlet Help for Providers</span></span>

<span data-ttu-id="1b0a8-161">Vous pouvez désormais créer des rubriques d’aide personnalisées pour les applets de commande du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-161">You can now create customized Help topics for the provider cmdlets.</span></span> <span data-ttu-id="1b0a8-162">Les rubriques d’aide sur les applets de commande personnalisées peuvent expliquer le fonctionnement de l’applet de commande dans le chemin d’accès du fournisseur et documenter des fonctionnalités spéciales, y compris les paramètres dynamiques ajoutés par le fournisseur à l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="1b0a8-162">Custom cmdlet help topics can explain how the cmdlet works in the provider path and document special features, including the dynamic parameters that the provider adds to the cmdlet.</span></span>
