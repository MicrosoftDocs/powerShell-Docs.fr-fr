---
title: Vue d’ensemble du système de type étendu
ms.date: 07/09/2020
ms.topic: conceptual
ms.openlocfilehash: 82170bd7e8943f68141159a7ac964f9ec1b2cfbc
ms.sourcegitcommit: d26e2237397483c6333abcf4331bd82f2e72b4e3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/10/2020
ms.locfileid: "86217942"
---
# <a name="extended-type-system-overview"></a><span data-ttu-id="eed72-102">Vue d’ensemble du système de type étendu</span><span class="sxs-lookup"><span data-stu-id="eed72-102">Extended Type System Overview</span></span>

<span data-ttu-id="eed72-103">PowerShell utilise son objet **PSObject** pour étendre les types d’objets de deux manières.</span><span class="sxs-lookup"><span data-stu-id="eed72-103">PowerShell uses its **PSObject** object to extend the types of objects in two ways.</span></span> <span data-ttu-id="eed72-104">Tout d’abord, l’objet **PSObject** offre un moyen d’afficher différentes vues de types d’objets spécifiques.</span><span class="sxs-lookup"><span data-stu-id="eed72-104">First, the **PSObject** object provides a way to show different views of specific object types.</span></span> <span data-ttu-id="eed72-105">Cela s’appelle l’affichage d’une vue adaptée d’un objet.</span><span class="sxs-lookup"><span data-stu-id="eed72-105">This is referred to as showing an adapted view of an object.</span></span> <span data-ttu-id="eed72-106">Deuxièmement, l’objet **PSObject** offre un moyen d’ajouter des membres à un objet existant.</span><span class="sxs-lookup"><span data-stu-id="eed72-106">Second, the **PSObject** object provides a way to add members to existing object.</span></span> <span data-ttu-id="eed72-107">Ensemble, en encapsulant un objet existant, appelé objet de base, l’objet **PSObject** fournit un système de type étendu (ETS) que les développeurs de scripts et d’applets de commande peuvent utiliser pour manipuler des objets .net dans l’interpréteur de commandes.</span><span class="sxs-lookup"><span data-stu-id="eed72-107">Together, by wrapping an existing object, referred to as the base object, the **PSObject** object provides an extended type system (ETS) that script and cmdlet developers can use to manipulate .NET objects within the shell.</span></span>

## <a name="cmdlet-and-script-development-issues"></a><span data-ttu-id="eed72-108">Problèmes de développement des applets de commande et des scripts</span><span class="sxs-lookup"><span data-stu-id="eed72-108">Cmdlet and Script Development Issues</span></span>

<span data-ttu-id="eed72-109">ETS résout deux problèmes fondamentaux :</span><span class="sxs-lookup"><span data-stu-id="eed72-109">ETS resolves two fundamental issues:</span></span>

<span data-ttu-id="eed72-110">Tout d’abord, certains objets .NET n’ont pas le comportement par défaut nécessaire pour agir en tant que données entre les applets de commande.</span><span class="sxs-lookup"><span data-stu-id="eed72-110">First, some .NET Objects do not have the necessary default behavior for acting as the data between cmdlets.</span></span>

- <span data-ttu-id="eed72-111">Certains objets .NET sont des objets « méta » (par exemple : objets WMI, objets ADO et objets XML) dont les membres décrivent les données qu’ils contiennent.</span><span class="sxs-lookup"><span data-stu-id="eed72-111">Some .NET objects are "meta" objects (for example: WMI Objects, ADO objects, and XML objects) whose members describe the data they contain.</span></span> <span data-ttu-id="eed72-112">Toutefois, dans un environnement de script, il s’agit des données contenues qui sont les plus intéressantes, et non pas de la description des données contenues.</span><span class="sxs-lookup"><span data-stu-id="eed72-112">However, in a scripting environment it is the contained data that is most interesting, not the description of the contained data.</span></span> <span data-ttu-id="eed72-113">ETS résout ce problème en introduisant la notion d’adaptateurs qui adaptent l’objet .NET sous-jacent pour avoir la sémantique par défaut attendue.</span><span class="sxs-lookup"><span data-stu-id="eed72-113">ETS resolves this issue by introducing the notion of Adapters that adapt the underlying .NET object to have the expected default semantics.</span></span>
- <span data-ttu-id="eed72-114">Certains membres de l’objet .NET sont nommés de manière incohérente, fournissent un ensemble insuffisant de membres publics ou fournissent une capacité insuffisante.</span><span class="sxs-lookup"><span data-stu-id="eed72-114">Some .NET Object members are inconsistently named, provide an insufficient set of public members, or provide insufficient capability.</span></span> <span data-ttu-id="eed72-115">ETS résout ce problème en introduisant la possibilité d’étendre l’objet .NET avec des membres supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="eed72-115">ETS resolves this issue by introducing the ability to extend the .NET object with additional members.</span></span>

<span data-ttu-id="eed72-116">Deuxièmement, le langage de script PowerShell est sans _type_ dans le fait qu’une variable n’a pas besoin d’être déclarée d’un type particulier.</span><span class="sxs-lookup"><span data-stu-id="eed72-116">Second, the PowerShell scripting language is _typeless_ in that a variable does not need to be declared of a particular type.</span></span> <span data-ttu-id="eed72-117">Autrement dit, les variables créées par un développeur de script sont de nature non _typée_.</span><span class="sxs-lookup"><span data-stu-id="eed72-117">That is, the variables a script developer creates are by nature _typeless_.</span></span> <span data-ttu-id="eed72-118">Toutefois, le système PowerShell est « piloté par type », car il dépend d’un nom de type pour les opérations de base, telles que la génération de résultats ou le tri.</span><span class="sxs-lookup"><span data-stu-id="eed72-118">However, the PowerShell system is "type-driven" in that it depends on having a type name to operate against for basic operations such as outputting results or sorting.</span></span>

<span data-ttu-id="eed72-119">Par conséquent, un développeur de script doit avoir la possibilité d’indiquer le type de l’une de ses variables et de créer son propre jeu d’objets de type dynamique qui contiennent des propriétés et des méthodes et qui peuvent participer au système piloté par type.</span><span class="sxs-lookup"><span data-stu-id="eed72-119">Therefore a script developer must have the ability to state the type of one of their variables and build up their own set of dynamically typed "objects" that contain properties and methods and can participate in the type-driven system.</span></span> <span data-ttu-id="eed72-120">ETS résout ce problème en fournissant un objet commun pour le langage de script qui a la capacité d’indiquer dynamiquement son type et d’ajouter des membres de manière dynamique.</span><span class="sxs-lookup"><span data-stu-id="eed72-120">ETS solves this problem by providing a common object for the scripting language that has the ability to state its type dynamically and to add members dynamically.</span></span>

<span data-ttu-id="eed72-121">Fondamentalement, ETS résout le problème mentionné précédemment en fournissant l’objet **PSObject** , qui joue le rôle de base de tous les accès aux objets à partir du langage de script et fournit une abstraction standard pour le développeur d’applets de commande.</span><span class="sxs-lookup"><span data-stu-id="eed72-121">Fundamentally, ETS resolves the issue mentioned previously by providing the **PSObject** object, which acts as the basis of all object access from the scripting language and provides a standard abstraction for the cmdlet developer.</span></span>

### <a name="cmdlet-developers"></a><span data-ttu-id="eed72-122">Développeurs d’applets de commande</span><span class="sxs-lookup"><span data-stu-id="eed72-122">Cmdlet Developers</span></span>

<span data-ttu-id="eed72-123">Pour les développeurs d’applets de commande, ETS offre la prise en charge suivante :</span><span class="sxs-lookup"><span data-stu-id="eed72-123">For the cmdlet developers, ETS provides the following support:</span></span>

- <span data-ttu-id="eed72-124">Les abstractions pour travailler sur des objets de façon générique à l’aide de l’objet **PSObject** .</span><span class="sxs-lookup"><span data-stu-id="eed72-124">The abstractions to work against objects in a generic way using the **PSObject** object.</span></span> <span data-ttu-id="eed72-125">ETS offre également la possibilité d’effectuer des recherches au-delà de ces abstractions si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="eed72-125">ETS also provides the ability to drill past these abstractions if required.</span></span>
- <span data-ttu-id="eed72-126">Mécanismes permettant de créer un comportement par défaut pour la mise en forme, le tri, la sérialisation et d’autres manipulations système de leur type d’objet à l’aide d’un ensemble bien connu de membres étendus.</span><span class="sxs-lookup"><span data-stu-id="eed72-126">The mechanisms to create a default behavior for formatting, sorting, serialization, and other system manipulations of their object type using a well-known set of extended members.</span></span>
- <span data-ttu-id="eed72-127">Le moyen de faire face à n’importe quel objet utilisant la même sémantique que le langage de script à l’aide d’un objet LanguagePrimitives.</span><span class="sxs-lookup"><span data-stu-id="eed72-127">The means to operate against any object using the same semantics as the script language using a LanguagePrimitives object.</span></span>
- <span data-ttu-id="eed72-128">La méthode consiste à « taper » de manière dynamique une table de hachage afin que le reste du système puisse agir efficacement.</span><span class="sxs-lookup"><span data-stu-id="eed72-128">The means to dynamically "type" a hash table so that the rest of the system can operate against it effectively.</span></span>

### <a name="script-developers"></a><span data-ttu-id="eed72-129">Développeurs de scripts</span><span class="sxs-lookup"><span data-stu-id="eed72-129">Script Developers</span></span>

<span data-ttu-id="eed72-130">Pour les développeurs de script, ETS offre la prise en charge suivante :</span><span class="sxs-lookup"><span data-stu-id="eed72-130">For the script developers, ETS provides the following support:</span></span>

- <span data-ttu-id="eed72-131">La possibilité de référencer n’importe quel type d’objet sous-jacent à l’aide de la même syntaxe ( `$a.x` ).</span><span class="sxs-lookup"><span data-stu-id="eed72-131">The ability to reference any underlying object type using the same syntax (`$a.x`).</span></span>
- <span data-ttu-id="eed72-132">La possibilité d’accéder au-delà de l’abstraction fournie par l’objet **PSObject** (comme l’accès aux seuls membres adaptés, ou l’accès à l’objet de base lui-même).</span><span class="sxs-lookup"><span data-stu-id="eed72-132">The ability to access beyond the abstraction provided by the **PSObject** object (such as accessing only adapted members, or accessing the base object itself).</span></span>
- <span data-ttu-id="eed72-133">Possibilité de définir des membres connus qui contrôlent la mise en forme, le tri, la sérialisation et d’autres manipulations d’une instance d’objet ou d’un type.</span><span class="sxs-lookup"><span data-stu-id="eed72-133">The ability to define well-known members that control the formatting, sorting, serialization, and other manipulations of an object instance or type.</span></span>
- <span data-ttu-id="eed72-134">Le signifie que vous nommez un objet en tant que type spécifique et que vous contrôlez ainsi l’héritage de ses membres basés sur le type.</span><span class="sxs-lookup"><span data-stu-id="eed72-134">The means to name an object as a specific type and thus control the inheritance of its type-based members.</span></span>
- <span data-ttu-id="eed72-135">La possibilité d’ajouter, de supprimer et de modifier des membres étendus.</span><span class="sxs-lookup"><span data-stu-id="eed72-135">The ability to add, remove, and modify extended members.</span></span>
- <span data-ttu-id="eed72-136">La possibilité de manipuler l’objet **PSObject** lui-même, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="eed72-136">The ability to manipulate the **PSObject** object itself if required.</span></span>

## <a name="the-psobject-class"></a><span data-ttu-id="eed72-137">Classe PSObject</span><span class="sxs-lookup"><span data-stu-id="eed72-137">The PSObject class</span></span>

<span data-ttu-id="eed72-138">L’objet **PSObject** est la base de tous les accès aux objets à partir du langage de script et fournit une abstraction standard pour le développeur d’applets de commande.</span><span class="sxs-lookup"><span data-stu-id="eed72-138">The **PSObject** object is the basis of all object access from the scripting language and provides a standard abstraction for the cmdlet developer.</span></span> <span data-ttu-id="eed72-139">Elle contient un objet de base (un objet .NET) et tous les membres d’instance (membres, plus particulièrement les membres étendus) qui sont présents sur une instance d’objet particulière, mais pas nécessairement sur d’autres objets du même type.</span><span class="sxs-lookup"><span data-stu-id="eed72-139">It contains a base-object (a .NET object) and any instance members (members, specifically extended members, that are present on a particular object instance while not necessarily on other objects of the same type).</span></span> <span data-ttu-id="eed72-140">Selon le type de l’objet de base, l’objet **PSObject** peut également fournir un accès implicite et explicite aux membres adaptés, ainsi qu’à tous les membres étendus basés sur un type.</span><span class="sxs-lookup"><span data-stu-id="eed72-140">Depending on the type of the base-object, the **PSObject** object might also provide implicit and explicit access to adapted members as well as any type-based extended members.</span></span>

<span data-ttu-id="eed72-141">L’objet **PSObject** fournit les mécanismes suivants :</span><span class="sxs-lookup"><span data-stu-id="eed72-141">The **PSObject** object provides the following mechanisms:</span></span>

- <span data-ttu-id="eed72-142">Possibilité de construire un **PSObject** avec ou sans objet de base.</span><span class="sxs-lookup"><span data-stu-id="eed72-142">The ability to construct an **PSObject** with or without a base-object.</span></span>
- <span data-ttu-id="eed72-143">La possibilité d’accéder à tous les membres de chaque objet **PSObject** construit par le biais d’un algorithme de recherche commun et de la possibilité de substituer cet algorithme quand cela est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="eed72-143">The ability to access of all members of each constructed **PSObject** object through a common lookup algorithm and the ability to override that algorithm when required.</span></span>
- <span data-ttu-id="eed72-144">Capacité à récupérer et à définir les noms des objets **PSObject** construits afin que les scripts et les applets de commande puissent faire référence à des objets **PSObject** similaires par le même nom de type, quel que soit le type de leur objet de base.</span><span class="sxs-lookup"><span data-stu-id="eed72-144">The ability to get and set the type-names of the constructed **PSObject** objects so that scripts and cmdlets can reference similar **PSObject** objects by the same type-name, regardless of the type of their base-object.</span></span>

### <a name="how-to-construct-a-psobject"></a><span data-ttu-id="eed72-145">Comment construire un PSObject</span><span class="sxs-lookup"><span data-stu-id="eed72-145">How to Construct a PSObject</span></span>

<span data-ttu-id="eed72-146">La liste suivante décrit les façons de créer un objet **PSObject** :</span><span class="sxs-lookup"><span data-stu-id="eed72-146">The following list describes ways to create a **PSObject** object:</span></span>

- <span data-ttu-id="eed72-147">L’appel du constructeur **PSObject** . #ctor crée un nouvel objet **PSObject** avec un objet de base de PSCustomObject.</span><span class="sxs-lookup"><span data-stu-id="eed72-147">Calling the **PSObject** .#ctor constructor creates a new **PSObject** object with a base-object of PSCustomObject.</span></span> <span data-ttu-id="eed72-148">Un objet de base de ce type indique que l’objet **PSObject** n’a aucun objet de base significatif.</span><span class="sxs-lookup"><span data-stu-id="eed72-148">A base-object of this type indicates that the **PSObject** object has no meaningful base-object.</span></span> <span data-ttu-id="eed72-149">Toutefois, un objet **PSObject** avec ce type d’objet de base fournit un jeu de propriétés que les développeurs d’applets de commande peuvent trouver utiles en ajoutant des membres étendus.</span><span class="sxs-lookup"><span data-stu-id="eed72-149">However, a **PSObject** object with this type of base-object does provide a property bag that cmdlet developers can find helpful by adding extended-members.</span></span>

<span data-ttu-id="eed72-150">Les développeurs peuvent également spécifier le nom du type d’objet, ce qui permet à cet objet de partager ses membres étendus avec d’autres objets **PSObject** du même type-nom.</span><span class="sxs-lookup"><span data-stu-id="eed72-150">Developers can also specify the object type-name, which allows this object to share its extended-members with other **PSObject** objects of the same type-name.</span></span>

- <span data-ttu-id="eed72-151">L’appel du constructeur **PSObject** . #ctor (System. Object) crée un nouvel objet **PSObject** avec un objet de base de type System. Object.</span><span class="sxs-lookup"><span data-stu-id="eed72-151">Calling the **PSObject** .#ctor(System.Object) constructor creates a new **PSObject** object with a base-object of type System.Object.</span></span>

  <span data-ttu-id="eed72-152">Dans ce cas, le nom de type de l’objet créé est une collection de la hiérarchie de dérivation de l’objet de base.</span><span class="sxs-lookup"><span data-stu-id="eed72-152">In this case, the type-name for the created object is a collection of the derivation hierarchy of the base-object.</span></span> <span data-ttu-id="eed72-153">Par exemple, le nom de type pour le **PSObject** qui contient un objet de base ProcessInfo inclut les noms suivants :</span><span class="sxs-lookup"><span data-stu-id="eed72-153">For example, the type-name for the **PSObject** that contains a ProcessInfo base-object would include the following names:</span></span>

  - <span data-ttu-id="eed72-154">System.Diagnostics.Process</span><span class="sxs-lookup"><span data-stu-id="eed72-154">System.Diagnostics.Process</span></span>
  - <span data-ttu-id="eed72-155">System. ComponentModel. Component</span><span class="sxs-lookup"><span data-stu-id="eed72-155">System.ComponentModel.Component</span></span>
  - <span data-ttu-id="eed72-156">System.MarshalByRefObject</span><span class="sxs-lookup"><span data-stu-id="eed72-156">System.MarshalByRefObject</span></span>
  - <span data-ttu-id="eed72-157">System.Object</span><span class="sxs-lookup"><span data-stu-id="eed72-157">System.Object</span></span>

- <span data-ttu-id="eed72-158">Appel du **PSObject** . La méthode AsPSObject (System. Object) crée un nouvel objet **PSObject** basé sur un objet fourni.</span><span class="sxs-lookup"><span data-stu-id="eed72-158">Calling the **PSObject** .AsPSObject(System.Object) method creates a new **PSObject** object based on a supplied object.</span></span>

  <span data-ttu-id="eed72-159">Si l’objet fourni est de type System. Object, l’objet fourni est utilisé comme objet de base pour le nouvel objet **PSObject** .</span><span class="sxs-lookup"><span data-stu-id="eed72-159">If the supplied object is of type System.Object, the supplied object is used as the base-object for the new **PSObject** object.</span></span> <span data-ttu-id="eed72-160">Si l’objet fourni est déjà un objet **PSObject** , l’objet fourni est retourné tel quel.</span><span class="sxs-lookup"><span data-stu-id="eed72-160">If the supplied object is already an **PSObject** object, the supplied object is returned as is.</span></span>

### <a name="base-adapted-and-extended-members"></a><span data-ttu-id="eed72-161">Membres de base, adaptés et étendu</span><span class="sxs-lookup"><span data-stu-id="eed72-161">Base, adapted, and extended members</span></span>

<span data-ttu-id="eed72-162">Conceptuellement, ETS utilise les termes suivants pour afficher la relation entre les membres d’origine de l’objet de base et les membres ajoutés par PowerShell.</span><span class="sxs-lookup"><span data-stu-id="eed72-162">Conceptually, ETS uses the following terms to show the relationship between the original members of the base-object and those members added by PowerShell.</span></span> <span data-ttu-id="eed72-163">Pour plus d’informations sur les types de membres spécifiques qui sont utilisés par l’objet **PSObject** , consultez [PSObject, classe](/dotnet/api/system.management.automation.psobject).</span><span class="sxs-lookup"><span data-stu-id="eed72-163">For more information about the specific types of members that are used by the **PSObject** object, see [PSObject class](/dotnet/api/system.management.automation.psobject).</span></span>

#### <a name="base-object-members"></a><span data-ttu-id="eed72-164">Membres de l’objet de base</span><span class="sxs-lookup"><span data-stu-id="eed72-164">Base-object members</span></span>

<span data-ttu-id="eed72-165">Si l’objet de base est spécifié lors de la construction des objets **PSObject** , les membres de l’objet de base sont rendus disponibles par le biais de la propriété Members.</span><span class="sxs-lookup"><span data-stu-id="eed72-165">If the base-object is specified when constructing the **PSObject** objects, then the members of the base-object are made available through the Members property.</span></span>

#### <a name="adapted-members"></a><span data-ttu-id="eed72-166">Membres adaptés</span><span class="sxs-lookup"><span data-stu-id="eed72-166">Adapted members</span></span>

<span data-ttu-id="eed72-167">Lorsqu’un objet de base est un méta-objet, qui contient des données d’une manière générique dont les propriétés décrivent les données qu’ils contiennent, ETS adapte ces objets à une vue qui permet un accès direct aux données via des membres adaptés de l’objet **PSObject** .</span><span class="sxs-lookup"><span data-stu-id="eed72-167">When a base-object is a meta-object, one that contains data in a generic fashion whose properties "describe" their contained data, ETS adapts those objects to a view that allows for direct access to the data through adapted members of the **PSObject** object.</span></span> <span data-ttu-id="eed72-168">Les membres adaptés et les membres d’objet de base sont accessibles par le biais de la propriété Members.</span><span class="sxs-lookup"><span data-stu-id="eed72-168">Adapted members and base-object members are accessed through the Members property.</span></span>

#### <a name="extended-members"></a><span data-ttu-id="eed72-169">Membres étendus</span><span class="sxs-lookup"><span data-stu-id="eed72-169">Extended members</span></span>

<span data-ttu-id="eed72-170">En plus des membres rendus disponibles à partir de l’objet de base ou des membres adaptés créés par PowerShell, un **PSObject** peut également définir des membres étendus qui étendent l’objet de base d’origine avec des informations supplémentaires qui sont utiles dans l’environnement de script.</span><span class="sxs-lookup"><span data-stu-id="eed72-170">In addition to the members made available from the base-object or those adapted members created by PowerShell, an **PSObject** may also define extended members that extend the original base-object with additional information that is useful in the scripting environment.</span></span>

<span data-ttu-id="eed72-171">Par exemple, toutes les applets de commande principales fournies par PowerShell, telles que les applets de commande « obtenir-content » et « Set-Content », acceptent un paramètre Path.</span><span class="sxs-lookup"><span data-stu-id="eed72-171">For example, all the core cmdlets provided by PowerShell, such as the Get-Content and Set-Content cmdlets, take a path parameter.</span></span> <span data-ttu-id="eed72-172">Pour vous assurer que ces applets de commande, et d’autres, peuvent fonctionner sur des objets de types différents, un membre de chemin d’accès peut être ajouté à ces objets afin qu’ils aient tous l’état de leurs informations de manière courante.</span><span class="sxs-lookup"><span data-stu-id="eed72-172">To ensure that these cmdlets, and others, can work against objects of different types, a Path member can be added to those objects so that they all state their information in a common way.</span></span> <span data-ttu-id="eed72-173">Ce membre du chemin d’accès étendu garantit que les applets de commande peuvent fonctionner sur tous ces types, même si une classe de base peut ne pas avoir de membre de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="eed72-173">This extended Path member ensures that the cmdlets can work against all those types even though there base class might not have a Path member.</span></span>

<span data-ttu-id="eed72-174">Les membres étendus, les membres adaptés et les membres d’objet de base sont accessibles via la propriété Members.</span><span class="sxs-lookup"><span data-stu-id="eed72-174">Extended members, adapted members, and base-object members are all accessed through the Members property.</span></span>
