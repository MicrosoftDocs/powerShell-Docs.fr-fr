---
title: Chargement et exportation de données de mise en forme | Microsoft Docs
ms.date: 09/13/2016
ms.openlocfilehash: b449b280ccee561679d58f2f2a8b467c83150766
ms.sourcegitcommit: 0907b8c6322d2c7c61b17f8168d53452c8964b41
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/05/2020
ms.locfileid: "87781118"
---
# <a name="loading-and-exporting-formatting-data"></a><span data-ttu-id="51f12-102">Chargement et exportation de données de mise en forme</span><span class="sxs-lookup"><span data-stu-id="51f12-102">Loading and Exporting Formatting Data</span></span>

<span data-ttu-id="51f12-103">Une fois que vous avez créé votre fichier de mise en forme, vous devez mettre à jour les données de format de la session en chargeant vos fichiers dans la session active.</span><span class="sxs-lookup"><span data-stu-id="51f12-103">Once you have created your formatting file, you need to update the format data of the session by loading your files into the current session.</span></span> <span data-ttu-id="51f12-104">(Les fichiers de mise en forme fournis par Windows PowerShell sont chargés par les composants logiciels enfichables qui sont inscrits lors de l’ouverture de la session active.) Une fois les données de format de la session active mises à jour, Windows PowerShell utilise ces données pour afficher les objets .NET associés aux affichages définis dans les fichiers de mise en forme chargés.</span><span class="sxs-lookup"><span data-stu-id="51f12-104">(The formatting files provided by Windows PowerShell are loaded by snap-ins that are registered when the current session is opened.) Once the format data of the current session is updated, Windows PowerShell uses that data to display the .NET objects associated with the views defined in the loaded formatting files.</span></span> <span data-ttu-id="51f12-105">Il n’existe aucune limite au nombre de fichiers de mise en forme que vous pouvez charger dans la session active.</span><span class="sxs-lookup"><span data-stu-id="51f12-105">There is no limit to the number of formatting files that you can load into the current session.</span></span> <span data-ttu-id="51f12-106">En plus de mettre à jour les données de mise en forme, vous pouvez exporter les données de format de la session active dans un fichier de mise en forme.</span><span class="sxs-lookup"><span data-stu-id="51f12-106">In addition to updating the formatting data, you can export the format data in the current session back to a formatting file.</span></span>

## <a name="loading-format-data"></a><span data-ttu-id="51f12-107">Chargement de données au format</span><span class="sxs-lookup"><span data-stu-id="51f12-107">Loading format data</span></span>

<span data-ttu-id="51f12-108">La mise en forme des fichiers peut être chargée dans la session active à l’aide des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="51f12-108">Formatting files can be loaded into the current session using the following methods:</span></span>

- <span data-ttu-id="51f12-109">Vous pouvez importer le fichier de mise en forme dans la session active à partir de la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="51f12-109">You can import the formatting file into the current session from the command line.</span></span> <span data-ttu-id="51f12-110">Utilisez l’applet de commande [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) comme décrit dans la procédure suivante.</span><span class="sxs-lookup"><span data-stu-id="51f12-110">Use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet as described in the following procedure.</span></span>

- <span data-ttu-id="51f12-111">Vous pouvez créer un manifeste de module qui fait référence à votre fichier de mise en forme.</span><span class="sxs-lookup"><span data-stu-id="51f12-111">You can create a module manifest that references your formatting file.</span></span> <span data-ttu-id="51f12-112">Les modules vous permettent d’empaqueter des fichiers de mise en forme pour la distribution.</span><span class="sxs-lookup"><span data-stu-id="51f12-112">Modules allow you to package you formatting files for distribution.</span></span> <span data-ttu-id="51f12-113">Utilisez l’applet de commande [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) pour créer le manifeste, et l’applet de commande [import-module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) pour charger le module dans la session active.</span><span class="sxs-lookup"><span data-stu-id="51f12-113">Use the [New-ModuleManifest](/powershell/module/Microsoft.PowerShell.Core/New-ModuleManifest) cmdlet to create the manifest, and the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to load the module into the current session.</span></span> <span data-ttu-id="51f12-114">Pour plus d’informations sur les modules, consultez [écriture d’un module Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="51f12-114">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="51f12-115">Vous pouvez créer un composant logiciel enfichable qui fait référence à votre fichier de mise en forme.</span><span class="sxs-lookup"><span data-stu-id="51f12-115">You can create a snap-in that references your formatting file.</span></span> <span data-ttu-id="51f12-116">Utilisez [System. Management. Automation. PSSnapin. formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) pour référencer vos fichiers de mise en forme.</span><span class="sxs-lookup"><span data-stu-id="51f12-116">Use the [System.Management.Automation.PSSnapIn.Formats](/dotnet/api/System.Management.Automation.PSSnapIn.Formats) to reference your formatting files.</span></span> <span data-ttu-id="51f12-117">Il est vivement recommandé d’utiliser des modules pour empaqueter des applets de commande, ainsi que tous les fichiers de mise en forme et de types associés pour la distribution.</span><span class="sxs-lookup"><span data-stu-id="51f12-117">It is strongly encouraged to use modules to package cmdlets, and any associated formatting and types files for distribution.</span></span> <span data-ttu-id="51f12-118">Pour plus d’informations sur les modules, consultez [écriture d’un module Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="51f12-118">For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

- <span data-ttu-id="51f12-119">Si vous appelez des commandes par programme, vous pouvez ajouter une entrée de fichier de mise en forme à l’état de session initial de l’instance d’exécution dans laquelle les commandes sont exécutées.</span><span class="sxs-lookup"><span data-stu-id="51f12-119">If you are invoking commands programmatically, you can add a formatting file entry to the initial session state of the runspace where the commands are run.</span></span> <span data-ttu-id="51f12-120">Pour plus d’informations sur le type .NET utilisé pour ajouter le fichier de mise en forme, consultez [System. Management. Automation. instances d’exécution. Sessionstateformatentry ? Displayproperty = FullName](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) Class.</span><span class="sxs-lookup"><span data-stu-id="51f12-120">For more information about .NET type used to add the formatting file, see the [System.Management.Automation.Runspaces.Sessionstateformatentry?Displayproperty=Fullname](/dotnet/api/System.Management.Automation.Runspaces.SessionStateFormatEntry) class.</span></span>

<span data-ttu-id="51f12-121">Lorsqu’un fichier de mise en forme est chargé, il est ajouté à une liste interne que Windows PowerShell utilise pour déterminer la vue à utiliser lors de l’affichage des objets sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="51f12-121">When a formatting file is loaded, it is added to an internal list that Windows PowerShell uses to determine which view to use when displaying objects at the command line.</span></span> <span data-ttu-id="51f12-122">Vous pouvez ajouter votre fichier de mise en forme au début de la liste, ou vous pouvez l’ajouter à la fin de la liste.</span><span class="sxs-lookup"><span data-stu-id="51f12-122">You can prepend your formatting file to the beginning of the list, or you can append it to the end of the list.</span></span> <span data-ttu-id="51f12-123">Il est important de savoir où votre fichier de mise en forme est ajouté à cette liste si vous chargez un fichier de mise en forme qui définit une vue pour un objet qui a une vue existante définie, par exemple lorsque vous souhaitez modifier le mode d’affichage d’un objet retourné par une applet de commande Windows PowerShell Core.</span><span class="sxs-lookup"><span data-stu-id="51f12-123">Knowing where your formatting file is added to this list is important if you are loading formatting file that defines a view for an object that has an existing view defined, such as when you want to change how an object that is returned by a Windows PowerShell core cmdlet is displayed.</span></span> <span data-ttu-id="51f12-124">Si vous chargez un fichier de mise en forme qui définit la seule vue d’un objet, vous pouvez utiliser l’une des méthodes décrites précédemment.</span><span class="sxs-lookup"><span data-stu-id="51f12-124">If you are loading a formatting file that defines the only view for an object, you can use any of the methods described previously.</span></span>  <span data-ttu-id="51f12-125">Si vous chargez un fichier de mise en forme qui définit une autre vue pour un objet, vous devez utiliser l’applet de commande [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) et ajouter votre fichier au début de la liste.</span><span class="sxs-lookup"><span data-stu-id="51f12-125">If you are loading a formatting file that defines another view for an object, you must use the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet and prepend your file to the beginning of the list.</span></span>

## <a name="storing-your-formatting-file"></a><span data-ttu-id="51f12-126">Stockage de votre fichier de mise en forme</span><span class="sxs-lookup"><span data-stu-id="51f12-126">Storing Your Formatting File</span></span>

<span data-ttu-id="51f12-127">L’emplacement de stockage des fichiers de mise en forme sur le disque n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="51f12-127">There is no requirement for where your formatting files are stored on disk.</span></span> <span data-ttu-id="51f12-128">Toutefois, il est fortement recommandé de les stocker dans le dossier suivant :`user\documents\windowspowershell\`</span><span class="sxs-lookup"><span data-stu-id="51f12-128">However, it is strongly suggested that you store them in the following folder: `user\documents\windowspowershell\`</span></span>

#### <a name="loading-a-format-file-using-import-formatdata"></a><span data-ttu-id="51f12-129">Chargement d’un fichier de format à l’aide de Import-FormatData</span><span class="sxs-lookup"><span data-stu-id="51f12-129">Loading a format file using Import-FormatData</span></span>

1. <span data-ttu-id="51f12-130">Stockez votre fichier de mise en forme sur le disque.</span><span class="sxs-lookup"><span data-stu-id="51f12-130">Store your formatting file to disk.</span></span>

2. <span data-ttu-id="51f12-131">Exécutez l’applet de commande [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) à l’aide de l’une des commandes suivantes.</span><span class="sxs-lookup"><span data-stu-id="51f12-131">Run the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet using one of the following commands.</span></span>

   <span data-ttu-id="51f12-132">Pour ajouter votre fichier de mise en forme au début de la liste, utilisez cette commande.</span><span class="sxs-lookup"><span data-stu-id="51f12-132">To add your formatting file to the front of the list use this command.</span></span> <span data-ttu-id="51f12-133">Utilisez cette commande si vous modifiez le mode d’affichage d’un objet.</span><span class="sxs-lookup"><span data-stu-id="51f12-133">Use this command if you are changing how an object is displayed.</span></span>

   ```powershell
   Update-FormatData -PrependPath PathToFormattingFile
   ```

   <span data-ttu-id="51f12-134">Pour ajouter votre fichier de mise en forme à la fin de la liste, utilisez cette commande.</span><span class="sxs-lookup"><span data-stu-id="51f12-134">To add your formatting file to the end of the list use this command.</span></span>

   ```powershell
   Update-FormatData -AppendPath PathToFormattingFile
   ```

   <span data-ttu-id="51f12-135">Une fois que vous avez ajouté un fichier à l’aide de l’applet de commande [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) , vous ne pouvez pas supprimer le fichier de la liste pendant que la session est ouverte.</span><span class="sxs-lookup"><span data-stu-id="51f12-135">Once you have added a file using the [Update-FormatData](/powershell/module/Microsoft.PowerShell.Utility/Update-FormatData) cmdlet, you cannot remove the file from the list while the session is open.</span></span> <span data-ttu-id="51f12-136">Vous devez fermer la session pour supprimer le fichier de mise en forme de la liste.</span><span class="sxs-lookup"><span data-stu-id="51f12-136">You must close the session to remove the formatting file from the list.</span></span>

## <a name="exporting-format-data"></a><span data-ttu-id="51f12-137">Exportation de données au format</span><span class="sxs-lookup"><span data-stu-id="51f12-137">Exporting format data</span></span>

<span data-ttu-id="51f12-138">Insérez le corps de la section ici.</span><span class="sxs-lookup"><span data-stu-id="51f12-138">Insert section body here.</span></span>
