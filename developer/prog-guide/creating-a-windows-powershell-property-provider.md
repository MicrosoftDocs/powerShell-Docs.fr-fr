---
title: Création d’un fournisseur de propriété PowerShell Windows | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- property providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], property provider
ms.assetid: a6adca44-b94b-4103-9970-a9b414355e60
caps.latest.revision: 5
ms.openlocfilehash: ade8fbd38e4f4a675e825b0d8850af0379c9d211
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/03/2019
ms.locfileid: "56858895"
---
# <a name="creating-a-windows-powershell-property-provider"></a><span data-ttu-id="d2973-102">Création d’un fournisseur de propriété Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="d2973-102">Creating a Windows PowerShell Property Provider</span></span>

<span data-ttu-id="d2973-103">Cette rubrique décrit comment créer un fournisseur qui permet à l’utilisateur de manipuler les propriétés des éléments dans un magasin de données.</span><span class="sxs-lookup"><span data-stu-id="d2973-103">This topic describes how to create a provider that enables the user to manipulate the properties of items in a data store.</span></span> <span data-ttu-id="d2973-104">Par conséquent, ce type de fournisseur est appelé un fournisseur de propriétés Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d2973-104">As a consequence, this type of provider is referred to as a Windows PowerShell property provider.</span></span> <span data-ttu-id="d2973-105">Par exemple, le fournisseur de Registre fourni par les valeurs de clé de Registre Windows PowerShell gère en tant que propriétés de l’élément clé de Registre.</span><span class="sxs-lookup"><span data-stu-id="d2973-105">For example, the Registry provider provided by Windows PowerShell handles registry key values as properties of the registry key item.</span></span> <span data-ttu-id="d2973-106">Ce type de fournisseur doit ajouter la [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface à l’implémentation de la classe .NET.</span><span class="sxs-lookup"><span data-stu-id="d2973-106">This type of provider must add the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface to the implementation of the .NET class.</span></span>

> [!NOTE]
> <span data-ttu-id="d2973-107">Windows PowerShell fournit un fichier de modèle que vous pouvez utiliser pour développer un fournisseur Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d2973-107">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="d2973-108">Le fichier TemplateProvider.cs est disponible sur le Microsoft Windows Software Development Kit pour Windows Vista et les composants d’exécution .NET Framework 3.0.</span><span class="sxs-lookup"><span data-stu-id="d2973-108">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="d2973-109">Pour obtenir des instructions de téléchargement, consultez [comment PowerShell de Windows Installer et de télécharger le Kit de développement logiciel de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="d2973-109">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="d2973-110">Windows PowerShell fournit un fichier de modèle que vous pouvez utiliser pour développer un fournisseur Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d2973-110">Windows PowerShell provides a template file that you can use to develop a Windows PowerShell provider.</span></span> <span data-ttu-id="d2973-111">Le fichier TemplateProvider.cs est disponible sur le Microsoft Windows Software Development Kit pour Windows Vista et les composants d’exécution .NET Framework 3.0.</span><span class="sxs-lookup"><span data-stu-id="d2973-111">The TemplateProvider.cs file is available on the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="d2973-112">Pour obtenir des instructions de téléchargement, consultez [comment PowerShell de Windows Installer et de télécharger le Kit de développement logiciel de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="d2973-112">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="d2973-113">Le modèle téléchargé est disponible dans le  **\<exemples PowerShell >** directory.</span><span class="sxs-lookup"><span data-stu-id="d2973-113">The downloaded template is available in the **\<PowerShell Samples>** directory.</span></span> <span data-ttu-id="d2973-114">Vous devez effectuer une copie de ce fichier et utiliser la copie pour la création d’un nouveau fournisseur Windows PowerShell, en supprimant toutes les fonctionnalités que vous n’avez pas besoin.</span><span class="sxs-lookup"><span data-stu-id="d2973-114">You should make a copy of this file and use the copy for creating a new Windows PowerShell provider, removing any functionality that you do not need.</span></span>
>
> <span data-ttu-id="d2973-115">Pour plus d’informations sur les autres implémentations du fournisseur Windows PowerShell, consultez [conception de votre fournisseur Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="d2973-115">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

> [!CAUTION]
> <span data-ttu-id="d2973-116">Les méthodes de votre fournisseur de propriétés doivent écrire tous les objets à l’aide de la [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) (méthode).</span><span class="sxs-lookup"><span data-stu-id="d2973-116">The methods of your property provider should write any objects using the [System.Management.Automation.Provider.Cmdletprovider.Writepropertyobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WritePropertyObject) method.</span></span>

<span data-ttu-id="d2973-117">La liste suivante contient les sections de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="d2973-117">The following list contains the sections in this topic.</span></span> <span data-ttu-id="d2973-118">Si vous n’êtes pas familiarisé avec l’écriture d’un fournisseur de propriétés Windows PowerShell, lire ces informations dans l’ordre dans lequel elle apparaît.</span><span class="sxs-lookup"><span data-stu-id="d2973-118">If you are unfamiliar with writing a Windows PowerShell property provider, read this information in the order that it appears.</span></span> <span data-ttu-id="d2973-119">Toutefois, si vous êtes familiarisé avec l’écriture d’un fournisseur de propriétés Windows PowerShell, accédez directement aux informations dont vous avez besoin.</span><span class="sxs-lookup"><span data-stu-id="d2973-119">However, if you are familiar with writing a Windows PowerShell property provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="d2973-120">Définir le fournisseur PowerShell Windows</span><span class="sxs-lookup"><span data-stu-id="d2973-120">Defining the Windows PowerShell Provider</span></span>](#Defining-the-Windows-PowerShell-provider)

- [<span data-ttu-id="d2973-121">Définition des fonctionnalités de Base</span><span class="sxs-lookup"><span data-stu-id="d2973-121">Defining Base Functionality</span></span>](#Defining-Base-Functionality)

- [<span data-ttu-id="d2973-122">Récupération des propriétés</span><span class="sxs-lookup"><span data-stu-id="d2973-122">Retrieving Properties</span></span>](#Retrieving-Properties)

- [<span data-ttu-id="d2973-123">Attachement des paramètres dynamiques à la `Get-ItemProperty` applet de commande</span><span class="sxs-lookup"><span data-stu-id="d2973-123">Attaching Dynamic Parameters to the `Get-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ItemProperty-Cmdlet)

- [<span data-ttu-id="d2973-124">Définition des propriétés</span><span class="sxs-lookup"><span data-stu-id="d2973-124">Setting Properties</span></span>](#Setting-Properties)

- [<span data-ttu-id="d2973-125">Attachement des paramètres dynamiques à la `Set-ItemProperty` applet de commande</span><span class="sxs-lookup"><span data-stu-id="d2973-125">Attaching Dynamic Parameters to the `Set-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-for-the-Set-ItemProperty-Cmdlet)

- [<span data-ttu-id="d2973-126">Effacement d’une propriété</span><span class="sxs-lookup"><span data-stu-id="d2973-126">Clearing a Property</span></span>](#Clearing-Properties)

- [<span data-ttu-id="d2973-127">Attachement des paramètres dynamiques à la `Clear-ItemProperty` applet de commande</span><span class="sxs-lookup"><span data-stu-id="d2973-127">Attaching Dynamic Parameters to the `Clear-ItemProperty` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Clear-ItemProperty-Cmdlet)

- [<span data-ttu-id="d2973-128">Construction du fournisseur PowerShell de Windows</span><span class="sxs-lookup"><span data-stu-id="d2973-128">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-provider)

## <a name="defining-the-windows-powershell-provider"></a><span data-ttu-id="d2973-129">Définir le fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="d2973-129">Defining the Windows PowerShell provider</span></span>

<span data-ttu-id="d2973-130">Un fournisseur de propriétés doit créer une classe .NET qui prend en charge la [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface.</span><span class="sxs-lookup"><span data-stu-id="d2973-130">A property provider must create a .NET class that supports the [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface.</span></span> <span data-ttu-id="d2973-131">Voici la déclaration de classe par défaut à partir du fichier TemplateProvider.cs fourni par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d2973-131">Here is the default class declaration from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration](Msh_samplestestcmdlets#testcmdletspropertyproviderclassdeclaration)]  -->

## <a name="defining-base-functionality"></a><span data-ttu-id="d2973-132">Définition des fonctionnalités de Base</span><span class="sxs-lookup"><span data-stu-id="d2973-132">Defining Base Functionality</span></span>

<span data-ttu-id="d2973-133">Le [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface peut être attachée à toutes les classes de base du fournisseur, à l’exception de la [ System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) classe.</span><span class="sxs-lookup"><span data-stu-id="d2973-133">The [System.Management.Automation.Provider.Ipropertycmdletprovider](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider) interface can be attached to any of the provider base classes, with the exception of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class.</span></span> <span data-ttu-id="d2973-134">Ajouter les fonctionnalités de base qui sont requis par la classe de base que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="d2973-134">Add the base functionality that is required by the base class you are using.</span></span> <span data-ttu-id="d2973-135">Pour plus d’informations sur les classes de base, consultez [conception de votre fournisseur Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="d2973-135">For more information about base classes, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

## <a name="retrieving-properties"></a><span data-ttu-id="d2973-136">Récupération des propriétés</span><span class="sxs-lookup"><span data-stu-id="d2973-136">Retrieving Properties</span></span>

<span data-ttu-id="d2973-137">Pour récupérer les propriétés, le fournisseur doit implémenter la [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) méthode pour prendre en charge les appels à partir de la `Get-ItemProperty` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="d2973-137">To retrieve properties, the provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method to support calls from the `Get-ItemProperty` cmdlet.</span></span> <span data-ttu-id="d2973-138">Cette méthode récupère les propriétés de l’élément situé dans le chemin d’accès interne de fournisseur spécifié (complet).</span><span class="sxs-lookup"><span data-stu-id="d2973-138">This method retrieves the properties of the item located at the specified provider-internal path (fully-qualified).</span></span>

<span data-ttu-id="d2973-139">Le `providerSpecificPickList` paramètre indique les propriétés à récupérer.</span><span class="sxs-lookup"><span data-stu-id="d2973-139">The `providerSpecificPickList` parameter indicates which properties to retrieve.</span></span> <span data-ttu-id="d2973-140">Si ce paramètre est `null` ou vide, la méthode doit récupérer toutes les propriétés.</span><span class="sxs-lookup"><span data-stu-id="d2973-140">If this parameter is `null` or empty, the method should retrieve all properties.</span></span> <span data-ttu-id="d2973-141">En outre, [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) écrit une instance d’un [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) objet qui représente un sac de propriétés récupérées.</span><span class="sxs-lookup"><span data-stu-id="d2973-141">In addition, [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) writes an instance of a [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the retrieved properties.</span></span> <span data-ttu-id="d2973-142">La méthode doit renvoyer aucun résultat.</span><span class="sxs-lookup"><span data-stu-id="d2973-142">The method should return nothing.</span></span>

<span data-ttu-id="d2973-143">Il est recommandé que l’implémentation de [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) prend en charge le développement des caractères génériques de noms de propriétés pour chaque élément dans la liste de choix.</span><span class="sxs-lookup"><span data-stu-id="d2973-143">It is recommended that the implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) supports the wildcard expansion of property names for each element in the pick list.</span></span> <span data-ttu-id="d2973-144">Pour ce faire, utilisez le [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) classe pour effectuer le filtrage des caractères génériques.</span><span class="sxs-lookup"><span data-stu-id="d2973-144">To do this, use the [System.Management.Automation.Wildcardpattern](/dotnet/api/System.Management.Automation.WildcardPattern) class to perform the wildcard pattern matching.</span></span>

<span data-ttu-id="d2973-145">Voici l’implémentation par défaut de [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) à partir du fichier TemplateProvider.cs fourni par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d2973-145">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidergetproperty)]  -->

#### <a name="things-to-remember-about-implementing-getproperty"></a><span data-ttu-id="d2973-146">Points à retenir sur l’implémentation GetProperty</span><span class="sxs-lookup"><span data-stu-id="d2973-146">Things to Remember About Implementing GetProperty</span></span>

<span data-ttu-id="d2973-147">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span><span class="sxs-lookup"><span data-stu-id="d2973-147">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty):</span></span>

- <span data-ttu-id="d2973-148">Lorsque vous définissez la classe de fournisseur, un fournisseur de propriétés Windows PowerShell peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) énumération.</span><span class="sxs-lookup"><span data-stu-id="d2973-148">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="d2973-149">Dans ce cas, l’implémentation de la [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) méthode doit s’assurer que le chemin d’accès transmis à la méthode remplit les conditions de l’élément spécifié fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="d2973-149">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="d2973-150">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriétés.</span><span class="sxs-lookup"><span data-stu-id="d2973-150">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="d2973-151">Par défaut, les substitutions de cette méthode ne doivent pas récupérer un lecteur pour les objets qui sont masqués à partir de l’utilisateur, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="d2973-151">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="d2973-152">Une erreur doit être écrits si le chemin d’accès représente un élément est masqué pour l’utilisateur et [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) est défini sur `false`.</span><span class="sxs-lookup"><span data-stu-id="d2973-152">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-itemproperty-cmdlet"></a><span data-ttu-id="d2973-153">Attachement des paramètres dynamiques à l’applet de commande Get-ItemProperty</span><span class="sxs-lookup"><span data-stu-id="d2973-153">Attaching Dynamic Parameters to the Get-ItemProperty Cmdlet</span></span>

<span data-ttu-id="d2973-154">Le `Get-ItemProperty` applet de commande peut-être nécessiter des paramètres supplémentaires qui sont spécifiés de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="d2973-154">The `Get-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="d2973-155">Pour fournir ces paramètres dynamiques, le fournisseur de propriétés Windows PowerShell doit implémenter le [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) (méthode).</span><span class="sxs-lookup"><span data-stu-id="d2973-155">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="d2973-156">Le `path` paramètre indique un complet interne de fournisseur de chemin d’accès, tandis que le `providerSpecificPickList` paramètre spécifie les propriétés spécifiques au fournisseur entrées sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="d2973-156">The `path` parameter indicates a fully-qualified provider-internal path, while the `providerSpecificPickList` parameter specifies the provider-specific properties entered on the command line.</span></span> <span data-ttu-id="d2973-157">Ce paramètre peut être `null` ou vide si les propriétés sont dirigées vers l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="d2973-157">This parameter might be `null` or empty if the properties are piped to the cmdlet.</span></span> <span data-ttu-id="d2973-158">Dans ce cas, cette méthode retourne un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="d2973-158">In this case, this method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="d2973-159">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="d2973-159">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="d2973-160">Voici l’implémentation par défaut de [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) à partir du fichier TemplateProvider.cs fourni par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d2973-160">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidergetpropertydynamicparameters)]  -->

## <a name="setting-properties"></a><span data-ttu-id="d2973-161">Propriétés du paramètre</span><span class="sxs-lookup"><span data-stu-id="d2973-161">Setting Properties</span></span>

<span data-ttu-id="d2973-162">Pour définir les propriétés, le fournisseur de propriétés Windows PowerShell doit implémenter le [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) méthode pour prendre en charge les appels à partir de la `Set-ItemProperty` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="d2973-162">To set properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method to support calls from the `Set-ItemProperty` cmdlet.</span></span> <span data-ttu-id="d2973-163">Cette méthode définit une ou plusieurs propriétés de l’élément dans le chemin spécifié et remplace les propriétés fournies en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="d2973-163">This method sets one or more properties of the item at the specified path, and overwrites the supplied properties as required.</span></span> <span data-ttu-id="d2973-164">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) également écrit une instance d’un [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) objet qui représente un jeu de propriétés de la mise à jour Propriétés.</span><span class="sxs-lookup"><span data-stu-id="d2973-164">[System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) also writes an instance of a [System.Management.Automation.Psobject](/dotnet/api/System.Management.Automation.PSObject) object that represents a property bag of the updated properties.</span></span>

<span data-ttu-id="d2973-165">Voici l’implémentation par défaut de [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) à partir du fichier TemplateProvider.cs fourni par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d2973-165">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty](Msh_samplestestcmdlets#testcmdletspropertyprovidersetproperty)]  -->

#### <a name="things-to-remember-about-implementing-set-itemproperty"></a><span data-ttu-id="d2973-166">Points à retenir sur l’implémentation de Set-ItemProperty</span><span class="sxs-lookup"><span data-stu-id="d2973-166">Things to Remember About Implementing Set-ItemProperty</span></span>

<span data-ttu-id="d2973-167">Les conditions suivantes peuvent s’appliquer à une implémentation de [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span><span class="sxs-lookup"><span data-stu-id="d2973-167">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty):</span></span>

- <span data-ttu-id="d2973-168">Lorsque vous définissez la classe de fournisseur, un fournisseur de propriétés Windows PowerShell peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) énumération.</span><span class="sxs-lookup"><span data-stu-id="d2973-168">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="d2973-169">Dans ce cas, l’implémentation de la [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) méthode devez vous assurer que le chemin d’accès transmis à la méthode remplit les conditions de l’élément spécifié fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="d2973-169">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="d2973-170">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriétés.</span><span class="sxs-lookup"><span data-stu-id="d2973-170">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="d2973-171">Par défaut, les substitutions de cette méthode ne doivent pas récupérer un lecteur pour les objets qui sont masqués à partir de l’utilisateur, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="d2973-171">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="d2973-172">Une erreur doit être écrits si le chemin d’accès représente un élément est masqué pour l’utilisateur et [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) est défini sur `false`.</span><span class="sxs-lookup"><span data-stu-id="d2973-172">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="d2973-173">Votre implémentation de la [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) méthode doit appeler [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\* ](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) et vérifier sa valeur de retour avant d’apporter des modifications au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="d2973-173">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="d2973-174">Cette méthode est utilisée pour confirmer l’exécution d’une opération lorsqu’une modification est apportée à l’état du système, par exemple, renommer les fichiers.</span><span class="sxs-lookup"><span data-stu-id="d2973-174">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="d2973-175">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envoie le nom de la ressource à modifier à l’utilisateur, avec le runtime de Windows PowerShell et de gérer les paramètres de ligne de commande ou les variables de préférence dans déterminer ce qui doit être affiché.</span><span class="sxs-lookup"><span data-stu-id="d2973-175">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handling any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="d2973-176">Après l’appel à [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourne `true`, si vous pouvez apporter des modifications de système potentiellement dangereux, les [ System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) méthode doit appeler la [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) (méthode).</span><span class="sxs-lookup"><span data-stu-id="d2973-176">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="d2973-177">Cette méthode envoie un message de confirmation à l’utilisateur pour que les commentaires supplémentaires indiquer que l’opération doit être poursuivie.</span><span class="sxs-lookup"><span data-stu-id="d2973-177">This method sends a confirmation message to the user to allow additional feedback to indicate that the operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-for-the-set-itemproperty-cmdlet"></a><span data-ttu-id="d2973-178">Attachement des paramètres dynamiques pour l’applet de commande Set-ItemProperty</span><span class="sxs-lookup"><span data-stu-id="d2973-178">Attaching Dynamic Parameters for the Set-ItemProperty Cmdlet</span></span>

<span data-ttu-id="d2973-179">Le `Set-ItemProperty` applet de commande peut-être nécessiter des paramètres supplémentaires qui sont spécifiés de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="d2973-179">The `Set-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="d2973-180">Pour fournir ces paramètres dynamiques, le fournisseur de propriétés Windows PowerShell doit implémenter le [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) (méthode).</span><span class="sxs-lookup"><span data-stu-id="d2973-180">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Setpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.SetPropertyDynamicParameters) method.</span></span> <span data-ttu-id="d2973-181">Cette méthode retourne un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="d2973-181">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="d2973-182">Le `null` valeur peut être retournée si aucun des paramètres dynamiques ne doivent être ajoutées.</span><span class="sxs-lookup"><span data-stu-id="d2973-182">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="d2973-183">Voici l’implémentation par défaut de [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) à partir du fichier TemplateProvider.cs fourni par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d2973-183">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Getpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.GetPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyprovidersetpropertydynamicparameters)]  -->

## <a name="clearing-properties"></a><span data-ttu-id="d2973-184">Propriétés de l’effacement</span><span class="sxs-lookup"><span data-stu-id="d2973-184">Clearing Properties</span></span>

<span data-ttu-id="d2973-185">Pour effacer les propriétés, le fournisseur de propriétés Windows PowerShell doit implémenter le [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) méthode pour prendre en charge les appels à partir de la `Clear-ItemProperty` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="d2973-185">To clear properties, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method to support calls from the `Clear-ItemProperty` cmdlet.</span></span> <span data-ttu-id="d2973-186">Cette méthode définit une ou plusieurs propriétés de l’élément situé dans le chemin d’accès spécifié.</span><span class="sxs-lookup"><span data-stu-id="d2973-186">This method sets one or more properties for the item located at the specified path.</span></span>

<span data-ttu-id="d2973-187">Voici l’implémentation par défaut de [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) à partir du fichier TemplateProvider.cs fourni par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d2973-187">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty](Msh_samplestestcmdlets#testcmdletspropertyproviderclearproperty)]  -->

#### <a name="thing-to-remember-about-implementing-clearproperty"></a><span data-ttu-id="d2973-188">Point à retenir sur l’implémentation ClearProperty</span><span class="sxs-lookup"><span data-stu-id="d2973-188">Thing to Remember About Implementing ClearProperty</span></span>

<span data-ttu-id="d2973-189">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span><span class="sxs-lookup"><span data-stu-id="d2973-189">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty):</span></span>

- <span data-ttu-id="d2973-190">Lorsque vous définissez la classe de fournisseur, un fournisseur de propriétés Windows PowerShell peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) énumération.</span><span class="sxs-lookup"><span data-stu-id="d2973-190">When defining the provider class, a Windows PowerShell property provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="d2973-191">Dans ce cas, l’implémentation de la [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) méthode doit s’assurer que le chemin d’accès transmis à la méthode remplit les conditions de l’élément spécifié fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="d2973-191">In these cases, the implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="d2973-192">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriétés.</span><span class="sxs-lookup"><span data-stu-id="d2973-192">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="d2973-193">Par défaut, les substitutions de cette méthode ne doivent pas récupérer un lecteur pour les objets qui sont masqués à partir de l’utilisateur, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="d2973-193">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="d2973-194">Une erreur doit être écrits si le chemin d’accès représente un élément est masqué pour l’utilisateur et [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) est défini sur `false`.</span><span class="sxs-lookup"><span data-stu-id="d2973-194">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="d2973-195">Votre implémentation de la [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) méthode doit appeler [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\* ](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) et vérifier sa valeur de retour avant d’apporter des modifications au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="d2973-195">Your implementation of the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="d2973-196">Cette méthode est utilisée pour confirmer l’exécution d’une opération avant une modification est apportée à l’état du système, telles que l’effacement du contenu.</span><span class="sxs-lookup"><span data-stu-id="d2973-196">This method is used to confirm execution of an operation before a change is made to system state, such as clearing content.</span></span> <span data-ttu-id="d2973-197">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envoie le nom de la ressource à modifier à l’utilisateur, avec le runtime de Windows PowerShell en prenant en compte les paramètres de ligne de commande ou les variables de préférence dans déterminer ce qui doit être affiché.</span><span class="sxs-lookup"><span data-stu-id="d2973-197">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="d2973-198">Après l’appel à [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourne `true`, si vous pouvez apporter des modifications de système potentiellement dangereux, les [ System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) méthode doit appeler la [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) (méthode).</span><span class="sxs-lookup"><span data-stu-id="d2973-198">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, if potentially dangerous system modifications can be made, the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearproperty\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearProperty) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="d2973-199">Cette méthode envoie un message de confirmation à l’utilisateur pour que les commentaires supplémentaires indiquer que l’opération potentiellement dangereuse doit être poursuivie.</span><span class="sxs-lookup"><span data-stu-id="d2973-199">This method sends a confirmation message to the user to allow additional feedback to indicate that the potentially dangerous operation should be continued.</span></span>

## <a name="attaching-dynamic-parameters-to-the-clear-itemproperty-cmdlet"></a><span data-ttu-id="d2973-200">Attachement des paramètres dynamiques à l’applet de commande Clear-ItemProperty</span><span class="sxs-lookup"><span data-stu-id="d2973-200">Attaching Dynamic Parameters to the Clear-ItemProperty Cmdlet</span></span>

<span data-ttu-id="d2973-201">Le `Clear-ItemProperty` applet de commande peut-être nécessiter des paramètres supplémentaires qui sont spécifiés de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="d2973-201">The `Clear-ItemProperty` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="d2973-202">Pour fournir ces paramètres dynamiques, le fournisseur de propriétés Windows PowerShell doit implémenter le [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) (méthode).</span><span class="sxs-lookup"><span data-stu-id="d2973-202">To provide these dynamic parameters, the Windows PowerShell property provider must implement the [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) method.</span></span> <span data-ttu-id="d2973-203">Cette méthode retourne un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="d2973-203">This method returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="d2973-204">Le `null` valeur peut être retournée si aucun des paramètres dynamiques ne doivent être ajoutées.</span><span class="sxs-lookup"><span data-stu-id="d2973-204">The `null` value can be returned if no dynamic parameters are to be added.</span></span>

<span data-ttu-id="d2973-205">Voici l’implémentation par défaut de [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) à partir du fichier TemplateProvider.cs fourni par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d2973-205">Here is the default implementation of [System.Management.Automation.Provider.Ipropertycmdletprovider.Clearpropertydynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IPropertyCmdletProvider.ClearPropertyDynamicParameters) from the TemplateProvider.cs file provided by Windows PowerShell.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters](Msh_samplestestcmdlets#testcmdletspropertyproviderclearpropertydynamicparameters)]  -->

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="d2973-206">Construction du fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="d2973-206">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="d2973-207">Consultez [comment inscrire les applets de commande, fournisseurs et héberger des Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="d2973-207">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>
<span data-ttu-id="d2973-208">Consultez [comment inscrire les applets de commande, fournisseurs et héberger des Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="d2973-208">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="see-also"></a><span data-ttu-id="d2973-209">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d2973-209">See Also</span></span>

[<span data-ttu-id="d2973-210">Fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="d2973-210">Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="d2973-211">Fournisseur de votre Windows PowerShell de conception</span><span class="sxs-lookup"><span data-stu-id="d2973-211">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="d2973-212">Extension des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="d2973-212">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="d2973-213">Extension des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="d2973-213">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="d2973-214">Comment inscrire les applets de commande, fournisseurs et héberger des Applications</span><span class="sxs-lookup"><span data-stu-id="d2973-214">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="d2973-215">Comment inscrire les applets de commande, fournisseurs et héberger des Applications</span><span class="sxs-lookup"><span data-stu-id="d2973-215">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)