---
title: Création d’un fournisseur de Navigation de Windows PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- navigation providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], navigation provider
ms.assetid: 8bd3224d-ca6f-4640-9464-cb4d9f4e13b1
caps.latest.revision: 5
ms.openlocfilehash: 066aa188d5d7dfde5af424a3bb8f15ff51c1e936
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/03/2019
ms.locfileid: "56856955"
---
# <a name="creating-a-windows-powershell-navigation-provider"></a><span data-ttu-id="1ef6d-102">Création d’un fournisseur de navigation Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="1ef6d-102">Creating a Windows PowerShell Navigation Provider</span></span>

<span data-ttu-id="1ef6d-103">Cette rubrique décrit comment créer un fournisseur de navigation de Windows PowerShell qui peut naviguer le magasin de données.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-103">This topic describes how to create a Windows PowerShell navigation provider that can navigate the data store.</span></span> <span data-ttu-id="1ef6d-104">Ce type de fournisseur prend en charge les commandes récursives, les conteneurs imbriqués et les chemins d’accès relatifs.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-104">This type of provider supports recursive commands, nested containers, and relative paths.</span></span>

> [!NOTE]
> <span data-ttu-id="1ef6d-105">Vous pouvez télécharger le C# le fichier source (AccessDBSampleProvider05.cs) pour ce fournisseur en utilisant le Microsoft Windows Software Development Kit pour Windows Vista et les composants d’exécution .NET Framework 3.0.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-105">You can download the C# source file (AccessDBSampleProvider05.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="1ef6d-106">Pour obtenir des instructions de téléchargement, consultez [comment PowerShell de Windows Installer et de télécharger le Kit de développement logiciel de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-106">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="1ef6d-107">Vous pouvez télécharger le C# le fichier source (AccessDBSampleProvider05.cs) pour ce fournisseur en utilisant le Microsoft Windows Software Development Kit pour Windows Vista et les composants d’exécution .NET Framework 3.0.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-107">You can download the C# source file (AccessDBSampleProvider05.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="1ef6d-108">Pour obtenir des instructions de téléchargement, consultez [comment PowerShell de Windows Installer et de télécharger le Kit de développement logiciel de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-108">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="1ef6d-109">Les fichiers source téléchargé sont disponibles dans le  **\<exemples PowerShell >** directory.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-109">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="1ef6d-110">Pour plus d’informations sur les autres implémentations du fournisseur Windows PowerShell, consultez [conception de votre fournisseur Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-110">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="1ef6d-111">Le fournisseur décrit ici permet le handle de l’utilisateur une base de données Access en tant que lecteur afin que l’utilisateur peut accéder aux tables de données dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-111">The provider described here enables the user handle an Access database as a drive so that the user can navigate to the data tables in the database.</span></span> <span data-ttu-id="1ef6d-112">Lorsque vous créez votre propre fournisseur de navigation, vous pouvez implémenter des méthodes qui peuvent rendre qualifié par un lecteur de chemins d’accès requis pour la navigation, normaliser les chemins d’accès relatifs, déplacer des éléments de la banque de données, ainsi que les méthodes d’obtenir les noms des enfants, obtient le chemin d’accès du parent d’un élément et tester pour identifier si un élément est un conteneur.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-112">When creating your own navigation provider, you can implement methods that can make drive-qualified paths required for navigation, normalize relative paths, move items of the data store, as well as methods that get child names, get the parent path of an item, and test to identify if an item is a container.</span></span>

> [!CAUTION]
> <span data-ttu-id="1ef6d-113">N’oubliez pas que cette conception suppose une base de données qui a un champ avec l’ID de nom, et que le type du champ est LongInteger.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-113">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

<span data-ttu-id="1ef6d-114">La liste suivante comprend les sections de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-114">The following list includes sections in this topic.</span></span> <span data-ttu-id="1ef6d-115">Si vous n’êtes pas familiarisé avec l’écriture d’un fournisseur de navigation de Windows PowerShell, lire ces informations dans l’ordre dans lequel elle apparaît.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-115">If you are unfamiliar with writing a Windows PowerShell navigation provider, read this information in the order that it appears.</span></span> <span data-ttu-id="1ef6d-116">Toutefois, si vous êtes familiarisé avec l’écriture d’un fournisseur de navigation de Windows PowerShell, accédez directement aux informations dont vous avez besoin.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-116">However, if you are familiar with writing a Windows PowerShell navigation provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="1ef6d-117">Définition d’une classe de fournisseur de Navigation PS</span><span class="sxs-lookup"><span data-stu-id="1ef6d-117">Defining a PS Navigation Provider Class</span></span>](#Define-the-Windows-PowerShell-provider)

- [<span data-ttu-id="1ef6d-118">Définition des fonctionnalités de Base</span><span class="sxs-lookup"><span data-stu-id="1ef6d-118">Defining Base Functionality</span></span>](#Defining-Base-Functionality)

- [<span data-ttu-id="1ef6d-119">Création d’un chemin d’accès PS</span><span class="sxs-lookup"><span data-stu-id="1ef6d-119">Creating a PS Path</span></span>](#Creating-a-Windows-PowerShell-Path)

- [<span data-ttu-id="1ef6d-120">Récupérer le chemin d’accès Parent</span><span class="sxs-lookup"><span data-stu-id="1ef6d-120">Retrieving the Parent Path</span></span>](#Retrieving-the-Parent-Path)

- [<span data-ttu-id="1ef6d-121">Extraction du nom de chemin d’accès d’enfant</span><span class="sxs-lookup"><span data-stu-id="1ef6d-121">Retrieving the Child Path Name</span></span>](#Retrieve-the-Child-Path-Name)

- [<span data-ttu-id="1ef6d-122">Déterminer si un élément est un conteneur</span><span class="sxs-lookup"><span data-stu-id="1ef6d-122">Determining if an Item is a Container</span></span>](#Determining-if-an-Item-is-a-Container)

- [<span data-ttu-id="1ef6d-123">Déplacement d’un élément</span><span class="sxs-lookup"><span data-stu-id="1ef6d-123">Moving an Item</span></span>](#Moving-an-Item)

- [<span data-ttu-id="1ef6d-124">Attachement des paramètres dynamiques à la `Move-Item` applet de commande</span><span class="sxs-lookup"><span data-stu-id="1ef6d-124">Attaching Dynamic Parameters to the `Move-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Move-Item-Cmdlet)

- [<span data-ttu-id="1ef6d-125">Normalisation d’un chemin d’accès relatif</span><span class="sxs-lookup"><span data-stu-id="1ef6d-125">Normalizing a Relative Path</span></span>](#Normalizing-a-Relative-Path)

- [<span data-ttu-id="1ef6d-126">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="1ef6d-126">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="1ef6d-127">Définition des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="1ef6d-127">Defining Object Types and Formatting</span></span>](#Defining-Object-Types-and-Formatting)

- [<span data-ttu-id="1ef6d-128">Construction du fournisseur PowerShell de Windows</span><span class="sxs-lookup"><span data-stu-id="1ef6d-128">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-provider)

- [<span data-ttu-id="1ef6d-129">Test du fournisseur PowerShell de Windows</span><span class="sxs-lookup"><span data-stu-id="1ef6d-129">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-provider)

## <a name="define-the-windows-powershell-provider"></a><span data-ttu-id="1ef6d-130">Définir le fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="1ef6d-130">Define the Windows PowerShell provider</span></span>

<span data-ttu-id="1ef6d-131">Un fournisseur de navigation de Windows PowerShell doit créer une classe .NET qui dérive de la [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) classe de base.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-131">A Windows PowerShell navigation provider must create a .NET class that derives from the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class.</span></span> <span data-ttu-id="1ef6d-132">Voici la définition de classe pour le fournisseur de navigation décrite dans cette section.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-132">Here is the class definition for the navigation provider described in this section.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L31-L32 "AccessDBProviderSample05.cs")]

<span data-ttu-id="1ef6d-133">Notez que dans ce fournisseur, le [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribut inclut deux paramètres.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-133">Note that in this provider, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="1ef6d-134">Le premier paramètre spécifie un nom convivial pour le fournisseur qui est utilisé par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-134">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="1ef6d-135">Le deuxième paramètre spécifie les fonctionnalités spécifiques de Windows PowerShell que le fournisseur expose à l’exécution de Windows PowerShell au cours du traitement de commande.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-135">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="1ef6d-136">Pour ce fournisseur, il n’existe aucun capacités spécifiques de Windows PowerShell qui sont ajoutées.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-136">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="1ef6d-137">Définition des fonctionnalités de Base</span><span class="sxs-lookup"><span data-stu-id="1ef6d-137">Defining Base Functionality</span></span>

<span data-ttu-id="1ef6d-138">Comme décrit dans [votre fournisseur-PS de conception](./designing-your-windows-powershell-provider.md), le [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) dérive de la classe de base à partir de plusieurs autres classes fourni autre fournisseur fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-138">As described in [Design Your PS Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="1ef6d-139">Un fournisseur de navigation de Windows PowerShell, par conséquent, doive définir toutes les fonctionnalités fournies par les classes.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-139">A Windows PowerShell navigation provider, therefore, must define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="1ef6d-140">Pour implémenter des fonctionnalités permettant d’ajouter des informations d’initialisation spécifiques à la session et pour libérer les ressources utilisées par le fournisseur, consultez [création d’un fournisseur de PS base](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-140">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic PS Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="1ef6d-141">Toutefois, la plupart des fournisseurs (y compris le fournisseur décrit ici) peuvent utiliser l’implémentation par défaut de cette fonctionnalité fournie par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-141">However, most providers (including the provider described here) can use the default implementation of this functionality provided by Windows PowerShell.</span></span>

<span data-ttu-id="1ef6d-142">Pour obtenir l’accès au magasin de données via un lecteur Windows PowerShell, vous devez implémenter les méthodes de la [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) classe de base.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-142">To get access to the data store through a Windows PowerShell drive, you must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="1ef6d-143">Pour plus d’informations sur l’implémentation de ces méthodes, consultez [création d’un fournisseur de lecteur Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-143">For more information about implementing these methods, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="1ef6d-144">Pour manipuler les éléments d’un magasin de données, telles que l’obtention de paramètre et effacement des éléments, le fournisseur doit implémenter les méthodes fournies par le [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) classe de base.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-144">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="1ef6d-145">Pour plus d’informations sur l’implémentation de ces méthodes, consultez [création d’un fournisseur d’éléments de Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-145">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

<span data-ttu-id="1ef6d-146">Pour obtenir les éléments enfants, ou leurs noms, de la banque de données, ainsi que les méthodes qui créent, copient, renomment et supprimer des éléments, vous devez implémenter les méthodes fournies par le [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)classe de base.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-146">To get to the child items, or their names, of the data store, as well as methods that create, copy, rename, and remove items, you must implement the methods provided by the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="1ef6d-147">Pour plus d’informations sur l’implémentation de ces méthodes, consultez [création d’un fournisseur de conteneur Windows PowerShell](./creating-a-windows-powershell-container-provider.md).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-147">For more information about implementing these methods, see [Creating a Windows PowerShell Container Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

## <a name="creating-a-windows-powershell-path"></a><span data-ttu-id="1ef6d-148">Création d’un chemin d’accès de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="1ef6d-148">Creating a Windows PowerShell Path</span></span>

<span data-ttu-id="1ef6d-149">Fournisseur de navigation de Windows PowerShell utilisez un chemin d’accès Windows PowerShell interne de fournisseur pour parcourir les éléments du magasin de données.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-149">Windows PowerShell navigation provider use a provider-internal Windows PowerShell path to navigate the items of the data store.</span></span> <span data-ttu-id="1ef6d-150">Pour créer un chemin d’accès interne au fournisseur le fournisseur doit implémenter la [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) appels de méthode pour prendre en charge de l’applet de commande combiner-chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-150">To create a provider-internal path the provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method to supports calls from the Combine-Path cmdlet.</span></span> <span data-ttu-id="1ef6d-151">Cette méthode combine un chemin d’accès parent et enfant dans un chemin d’accès interne au fournisseur, à l’aide d’un séparateur de chemin d’accès spécifique au fournisseur entre les chemins d’accès parent et enfant.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-151">This method combines a parent and child path into a provider-internal path, using a provider-specific path separator between the parent and child paths.</span></span>

<span data-ttu-id="1ef6d-152">L’implémentation par défaut accepte les chemins d’accès avec « / » ou «\\« comme séparateur de chemin d’accès normalise le séparateur de chemin d’accès à »\\», combine les parties de chemin d’accès parent et enfant avec le séparateur entre eux, puis retourne une chaîne qui contienne le chemins d’accès combinés.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-152">The default implementation takes paths with "/" or "\\" as the path separator, normalizes the path separator to "\\", combines the parent and child path parts with the separator between them, and then returns a string that contains the combined paths.</span></span>

<span data-ttu-id="1ef6d-153">Ce fournisseur de navigation n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-153">This navigation provider does not implement this method.</span></span> <span data-ttu-id="1ef6d-154">Toutefois, le code suivant est l’implémentation par défaut de la [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) (méthode).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-154">However, the following code is the default implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermakepath](Msh_samplestestcmdlets#testprovidermakepath)]  -->

#### <a name="things-to-remember-about-implementing-makepath"></a><span data-ttu-id="1ef6d-155">Points à retenir sur l’implémentation MakePath</span><span class="sxs-lookup"><span data-stu-id="1ef6d-155">Things to Remember About Implementing MakePath</span></span>

<span data-ttu-id="1ef6d-156">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span><span class="sxs-lookup"><span data-stu-id="1ef6d-156">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span></span>

- <span data-ttu-id="1ef6d-157">Votre implémentation de la [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) méthode ne doit pas valider le chemin d’accès comme un chemin qualifié complet valide dans l’espace de noms du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-157">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method should not validate the path as a legal fully-qualified path in the provider namespace.</span></span> <span data-ttu-id="1ef6d-158">N’oubliez pas que chaque paramètre ne peut représenter une partie d’un chemin d’accès et les parties combinés peut ne pas génèrent un chemin d’accès qualifié complet.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-158">Be aware that each parameter can only represent a part of a path, and the combined parts might not generate a fully-qualified path.</span></span> <span data-ttu-id="1ef6d-159">Par exemple, le [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) méthode pour le fournisseur de système de fichiers peut recevoir des « windows\system32 » dans le `parent` paramètre et « abc.dll » dans le `child` paramètre.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-159">For example, the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method for the filesystem provider might receive "windows\system32" in the `parent` parameter and "abc.dll" in the `child` parameter.</span></span> <span data-ttu-id="1ef6d-160">La méthode regroupe ces valeurs avec le «\\« séparateur et retourne « windows\system32\abc.dll », qui n’est pas un chemin d’accès de système de fichier complet.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-160">The method joins these values with the "\\" separator and returns "windows\system32\abc.dll", which is not a fully-qualified file system path.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="1ef6d-161">Les parties du chemin d’accès fournis dans l’appel à [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) peut contenir des caractères non autorisés dans l’espace de noms du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-161">The path parts provided in the call to [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) might contain characters not allowed in the provider namespace.</span></span> <span data-ttu-id="1ef6d-162">Ces caractères sont très probablement utilisés pour le développement des caractères génériques et l’implémentation de cette méthode ne doit pas les supprimer.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-162">These characters are most likely used for wildcard expansion and the implementation of this method should not remove them.</span></span>

## <a name="retrieving-the-parent-path"></a><span data-ttu-id="1ef6d-163">Récupérer le chemin d’accès Parent</span><span class="sxs-lookup"><span data-stu-id="1ef6d-163">Retrieving the Parent Path</span></span>

<span data-ttu-id="1ef6d-164">Implémentent des fournisseurs de navigation de Windows PowerShell le [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) pour récupérer la partie parent du complet ou partielle (méthode) chemin d’accès spécifique au fournisseur.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-164">Windows PowerShell navigation providers implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method to retrieve the parent part of the indicated full or partial provider-specific path.</span></span> <span data-ttu-id="1ef6d-165">La méthode supprime le composant du chemin d’accès et retourne le parent de partie de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-165">The method removes the child part of the path and returns the parent path part.</span></span> <span data-ttu-id="1ef6d-166">Le `root` paramètre spécifie le chemin d’accès complet à la racine d’un lecteur.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-166">The `root` parameter specifies the fully-qualified path to the root of a drive.</span></span> <span data-ttu-id="1ef6d-167">Ce paramètre peut être null ou vide si un lecteur monté n’est pas en cours d’utilisation pour l’opération de récupération.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-167">This parameter can be null or empty if a mounted drive is not in use for the retrieval operation.</span></span> <span data-ttu-id="1ef6d-168">Si une racine est spécifiée, la méthode doit retourner un chemin d’accès à un conteneur dans la même arborescence comme racine.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-168">If a root is specified, the method must return a path to a container in the same tree as the root.</span></span>

<span data-ttu-id="1ef6d-169">L’exemple de fournisseur de navigation ne remplace pas cette méthode, mais utilise l’implémentation par défaut.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-169">The sample navigation provider does not override this method, but uses the default implementation.</span></span> <span data-ttu-id="1ef6d-170">Il accepte les chemins d’accès qui utilisent toutes deux « / » et «\\» comme séparateurs de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-170">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="1ef6d-171">Elle normalise tout d’abord le chemin d’accès pour que seul «\\» séparateurs, puis fractionne le chemin d’accès parent désactivé à la dernière «\\» et retourne le chemin d’accès parent.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-171">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the parent path.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetparentpath](Msh_samplestestcmdlets#testprovidergetparentpath)]  -->

#### <a name="to-remember-about-implementing-getparentpath"></a><span data-ttu-id="1ef6d-172">À retenir sur l’implémentation GetParentPath</span><span class="sxs-lookup"><span data-stu-id="1ef6d-172">To Remember About Implementing GetParentPath</span></span>

<span data-ttu-id="1ef6d-173">Votre implémentation de la [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) méthode doit fractionner le chemin d’accès lexicalement sur le séparateur de chemin d’accès pour l’espace de noms du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-173">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method should split the path lexically on the path separator for the provider namespace.</span></span> <span data-ttu-id="1ef6d-174">Par exemple, le fournisseur de système de fichiers utilise cette méthode pour rechercher le dernier «\\» et retourne tous les éléments à gauche du séparateur.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-174">For example, the filesystem provider uses this method to look for the last "\\" and returns everything to the left of the separator.</span></span>

## <a name="retrieve-the-child-path-name"></a><span data-ttu-id="1ef6d-175">Récupérer le nom de chemin d’accès d’enfant</span><span class="sxs-lookup"><span data-stu-id="1ef6d-175">Retrieve the Child Path Name</span></span>

<span data-ttu-id="1ef6d-176">Votre implémente de fournisseur de navigation le [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) méthode pour récupérer le nom (élément feuille) de l’enfant de l’élément situé à la version complète indiquée ou spécifique au fournisseur de chemin d’accès partiel.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-176">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method to retrieve the name (leaf element) of the child of the item located at the indicated full or partial provider-specific path.</span></span>

<span data-ttu-id="1ef6d-177">L’exemple de fournisseur de navigation ne remplace pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-177">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="1ef6d-178">L’implémentation par défaut est indiquée ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-178">The default implementation is shown below.</span></span> <span data-ttu-id="1ef6d-179">Il accepte les chemins d’accès qui utilisent toutes deux « / » et «\\» comme séparateurs de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-179">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="1ef6d-180">Elle normalise tout d’abord le chemin d’accès pour que seul «\\» séparateurs, puis fractionne le chemin d’accès parent désactivé à la dernière «\\» et retourne le nom de l’enfant partie du chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-180">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the name of the child path part.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildname](Msh_samplestestcmdlets#testprovidergetchildname)]  -->

#### <a name="things-to-remember-about-implementing-getchildname"></a><span data-ttu-id="1ef6d-181">Points à retenir sur l’implémentation GetChildName</span><span class="sxs-lookup"><span data-stu-id="1ef6d-181">Things to Remember About Implementing GetChildName</span></span>

<span data-ttu-id="1ef6d-182">Votre implémentation de la [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) méthode doit fractionner le chemin d’accès lexicalement sur le séparateur de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-182">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method should split the path lexically on the path separator.</span></span> <span data-ttu-id="1ef6d-183">Si le chemin d’accès fourni contient sans séparateurs de chemin d’accès, la méthode doit retourner le chemin d’accès tels quels.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-183">If the supplied path contains no path separators, the method should return the path unmodified.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="1ef6d-184">Le chemin d’accès fourni dans l’appel à cette méthode peut contenir des caractères qui ne sont pas autorisés dans l’espace de noms du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-184">The path provided in the call to this method might contain characters that are illegal in the provider namespace.</span></span> <span data-ttu-id="1ef6d-185">Ces caractères sont probables utilisé pour le développement des caractères génériques ou une correspondance d’expression régulière, et l’implémentation de cette méthode ne doit pas les supprimer.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-185">These characters are most likely used for wildcard expansion or regular expression matching, and the implementation of this method should not remove them.</span></span>

## <a name="determining-if-an-item-is-a-container"></a><span data-ttu-id="1ef6d-186">Déterminer si un élément est un conteneur</span><span class="sxs-lookup"><span data-stu-id="1ef6d-186">Determining if an Item is a Container</span></span>

<span data-ttu-id="1ef6d-187">Le fournisseur de navigation peut implémenter la [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) méthode pour déterminer si le chemin d’accès spécifié indique un conteneur.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-187">The navigation provider can implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) method to determine if the specified path indicates a container.</span></span> <span data-ttu-id="1ef6d-188">Elle retourne true si le chemin d’accès représente un conteneur et false sinon.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-188">It returns true if the path represents a container, and false otherwise.</span></span> <span data-ttu-id="1ef6d-189">L’utilisateur a besoin de cette méthode pour être en mesure d’utiliser le `Test-Path` applet de commande pour le chemin d’accès fourni.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-189">The user needs this method to be able to use the `Test-Path` cmdlet for the supplied path.</span></span>

<span data-ttu-id="1ef6d-190">Le code suivant illustre la [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) mise en œuvre dans notre exemple de fournisseur de navigation.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-190">The following code shows the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) implementation in our sample navigation provider.</span></span> <span data-ttu-id="1ef6d-191">La méthode vérifie que le chemin d’accès spécifié est correct et si la table existe et retourne la valeur true si le chemin d’accès indique un conteneur.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-191">The method verifies that  the specified path is correct and if the table exists, and returns true if the path indicates a container.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L847-L872 "AccessDBProviderSample05.cs")]

#### <a name="things-to-remember-about-implementing-isitemcontainer"></a><span data-ttu-id="1ef6d-192">Points à retenir sur l’implémentation IsItemContainer</span><span class="sxs-lookup"><span data-stu-id="1ef6d-192">Things to Remember About Implementing IsItemContainer</span></span>

<span data-ttu-id="1ef6d-193">Votre fournisseur de navigation classe .NET peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) énumération.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-193">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="1ef6d-194">Dans ce cas, l’implémentation de [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) doit s’assurer que le chemin d’accès transmis répond aux exigences.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-194">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) needs to ensure that the path passed meets requirements.</span></span> <span data-ttu-id="1ef6d-195">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) propriété.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-195">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) property.</span></span>

## <a name="moving-an-item"></a><span data-ttu-id="1ef6d-196">Déplacement d’un élément</span><span class="sxs-lookup"><span data-stu-id="1ef6d-196">Moving an Item</span></span>

<span data-ttu-id="1ef6d-197">À l’appui de la `Move-Item` applet de commande, votre fournisseur de navigation implémente le [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) (méthode).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-197">In support of the `Move-Item` cmdlet, your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="1ef6d-198">Cette méthode déplace l’élément spécifié par le `path` paramètre vers le conteneur dans le chemin d’accès fourni dans le `destination` paramètre.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-198">This method moves the item specified by the `path` parameter to the container at the path supplied in the `destination` parameter.</span></span>

<span data-ttu-id="1ef6d-199">L’exemple de fournisseur de navigation ne remplace pas le [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) (méthode).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-199">The sample navigation provider does not override the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="1ef6d-200">Voici l’implémentation par défaut.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-200">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitem](Msh_samplestestcmdlets#testprovidermoveitem)]  -->

#### <a name="things-to-remember-about-implementing-moveitem"></a><span data-ttu-id="1ef6d-201">Points à retenir sur l’implémentation MoveItem</span><span class="sxs-lookup"><span data-stu-id="1ef6d-201">Things to Remember About Implementing MoveItem</span></span>

<span data-ttu-id="1ef6d-202">Votre fournisseur de navigation classe .NET peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) énumération.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-202">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="1ef6d-203">Dans ce cas, l’implémentation de [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) devez vous assurer que le chemin d’accès transmis répond aux exigences.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-203">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) must ensure that the path passed meets requirements.</span></span> <span data-ttu-id="1ef6d-204">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le **CmdletProvider.Exclude** propriété.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-204">To do this, the method should access the appropriate property, for example, the **CmdletProvider.Exclude** property.</span></span>

<span data-ttu-id="1ef6d-205">Par défaut, les substitutions de cette méthode ne devraient pas déplacer les objets sur des objets existants, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-205">By default, overrides of this method should not move objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="1ef6d-206">Par exemple, le fournisseur filesystem ne copiera pas c:\temp\abc.txt sur un fichier c:\bar.txt existant, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-206">For example, the filesystem provider will not copy c:\temp\abc.txt over an existing c:\bar.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="1ef6d-207">Si le chemin d’accès spécifié dans le `destination` paramètre existe et est un conteneur, le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-207">If the path specified in the `destination` parameter exists and is a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="1ef6d-208">Dans ce cas, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) doit déplacer l’élément indiqué par le `path` paramètre vers le conteneur indiqué par le `destination` paramètre en tant qu’enfant.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-208">In this case, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) should move the item indicated by the `path` parameter to the container indicated by the `destination` parameter as a child.</span></span>

<span data-ttu-id="1ef6d-209">Votre implémentation de la [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) méthode doit appeler [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) et vérifier sa valeur de retour avant d’apporter des modifications au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-209">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="1ef6d-210">Cette méthode est utilisée pour confirmer l’exécution d’une opération lorsqu’une modification est apportée à l’état du système, par exemple, la suppression de fichiers.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-210">This method is used to confirm execution of an operation when a change is made to system state, for example, deleting files.</span></span> <span data-ttu-id="1ef6d-211">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envoie le nom de la ressource à modifier à l’utilisateur, avec le runtime de Windows PowerShell en prenant en compte les paramètres de ligne de commande ou les variables de préférence dans déterminer ce qui doit être affiché à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-211">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed to the user.</span></span>

<span data-ttu-id="1ef6d-212">Après l’appel à [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourne `true`, le [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) méthode doit appeler la [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) (méthode).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-212">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="1ef6d-213">Cette méthode envoie un message à l’utilisateur pour que les commentaires de dire si l’opération doit être poursuivie.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-213">This method sends a message to the user to allow feedback to say if the operation should be continued.</span></span> <span data-ttu-id="1ef6d-214">Votre fournisseur doit appeler [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) une vérification supplémentaire pour les modifications du système potentiellement dangereux.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-214">Your provider should call [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-move-item-cmdlet"></a><span data-ttu-id="1ef6d-215">Attachement des paramètres dynamiques à l’applet de commande Move-Item</span><span class="sxs-lookup"><span data-stu-id="1ef6d-215">Attaching Dynamic Parameters to the Move-Item Cmdlet</span></span>

<span data-ttu-id="1ef6d-216">Parfois le `Move-Item` applet de commande requiert des paramètres supplémentaires qui sont fournies de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-216">Sometimes the `Move-Item` cmdlet requires additional parameters that are provided dynamically at runtime.</span></span> <span data-ttu-id="1ef6d-217">Pour fournir ces paramètres dynamiques, le fournisseur de navigation doit implémenter le [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) pour obtenir les valeurs de paramètre obligatoire (méthode) à partir de l’élément au niveau du chemin d’accès indiqué et retournent un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-217">To provide these dynamic parameters, the navigation provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) method to get the required parameter values from the item at the indicated path, and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="1ef6d-218">Ce fournisseur de navigation n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-218">This navigation provider does not implement this method.</span></span> <span data-ttu-id="1ef6d-219">Toutefois, le code suivant est l’implémentation par défaut de [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-219">However, the following code is the default implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters](Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters)]  -->

## <a name="normalizing-a-relative-path"></a><span data-ttu-id="1ef6d-220">Normalisation d’un chemin d’accès relatif</span><span class="sxs-lookup"><span data-stu-id="1ef6d-220">Normalizing a Relative Path</span></span>

<span data-ttu-id="1ef6d-221">Votre implémente de fournisseur de navigation le [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) méthode pour normaliser le chemin d’accès qualifié complet est indiqué dans le `path` paramètre comme étant relatif au chemin spécifié par le `basePath` paramètre.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-221">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) method to normalize the fully-qualified path indicated in the `path` parameter as being relative to the path specified by the `basePath` parameter.</span></span> <span data-ttu-id="1ef6d-222">La méthode retourne une chaîne représentant le chemin d’accès normalisé.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-222">The method returns a string representation of the normalized path.</span></span> <span data-ttu-id="1ef6d-223">Enregistre une erreur si le `path` paramètre spécifie un chemin d’accès qui n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-223">It writes an error if the `path` parameter specifies a nonexistent path.</span></span>

<span data-ttu-id="1ef6d-224">L’exemple de fournisseur de navigation ne remplace pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-224">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="1ef6d-225">Voici l’implémentation par défaut.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-225">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernormalizepath](Msh_samplestestcmdlets#testprovidernormalizepath)]  -->

#### <a name="things-to-remember-about-implementing-normalizerelativepath"></a><span data-ttu-id="1ef6d-226">Points à retenir sur l’implémentation NormalizeRelativePath</span><span class="sxs-lookup"><span data-stu-id="1ef6d-226">Things to Remember About Implementing NormalizeRelativePath</span></span>

<span data-ttu-id="1ef6d-227">Votre implémentation de [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) doit analyser le `path` paramètre, mais il ne doit pas utiliser l’analyse syntaxique.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-227">Your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) should parse the `path` parameter, but it does not have to use purely syntactical parsing.</span></span> <span data-ttu-id="1ef6d-228">Vous sont encouragés à la conception de cette méthode à utiliser le chemin d’accès pour rechercher les informations de chemin d’accès dans le magasin de données et créer un chemin d’accès qui correspond à la casse et normalisé de syntaxe de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-228">You are encouraged to design this method to use the path to look up the path information in the data store and create a path that matches the casing and standardized path syntax.</span></span>

## <a name="code-sample"></a><span data-ttu-id="1ef6d-229">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="1ef6d-229">Code Sample</span></span>

<span data-ttu-id="1ef6d-230">Pour l’exemple de code complet, consultez [exemple de Code AccessDbProviderSample05](./accessdbprovidersample05-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-230">For complete sample code, see [AccessDbProviderSample05 Code Sample](./accessdbprovidersample05-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="1ef6d-231">Définition des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="1ef6d-231">Defining Object Types and Formatting</span></span>

<span data-ttu-id="1ef6d-232">Il est possible pour un fournisseur pour ajouter des membres à des objets existants ou définir de nouveaux objets.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-232">It is possible for a provider to add members to existing objects or define new objects.</span></span> <span data-ttu-id="1ef6d-233">Pour plus d’informations, consultez[étendant les Types d’objets et de mise en forme](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-233">For more information, see[Extending Object Types and Formatting](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>
<span data-ttu-id="1ef6d-234">Il est possible pour un fournisseur pour ajouter des membres à des objets existants ou définir de nouveaux objets.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-234">It is possible for a provider to add members to existing objects or define new objects.</span></span> <span data-ttu-id="1ef6d-235">Pour plus d’informations, consultez[étendant les Types d’objets et de mise en forme](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-235">For more information, see[Extending Object Types and Formatting](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="1ef6d-236">Construction du fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="1ef6d-236">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="1ef6d-237">Pour plus d’informations, consultez [comment inscrire les applets de commande, fournisseurs et héberger des Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-237">For more information, see [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>
<span data-ttu-id="1ef6d-238">Pour plus d’informations, consultez [comment inscrire les applets de commande, fournisseurs et héberger des Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="1ef6d-238">For more information, see [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="1ef6d-239">Test du fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="1ef6d-239">Testing the Windows PowerShell provider</span></span>

<span data-ttu-id="1ef6d-240">Lorsque votre fournisseur de Windows PowerShell a été enregistré avec Windows PowerShell, vous pouvez le tester en exécutant les applets de commande pris en charge sur la ligne de commande, y compris les applets de commande mises à disposition par dérivation.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-240">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line, including cmdlets made available by derivation.</span></span> <span data-ttu-id="1ef6d-241">Cet exemple testera l’exemple de fournisseur de navigation.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-241">This example will test the sample navigation provider.</span></span>

1. <span data-ttu-id="1ef6d-242">Exécutez votre nouvel interpréteur de commandes et utilisez le `Set-Location` applet de commande pour définir le chemin d’accès pour indiquer la base de données Access.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-242">Run your new shell and use the `Set-Location` cmdlet to set the path to indicate the Access database.</span></span>

   ```powershell
   Set-Location mydb:
   ```

2. <span data-ttu-id="1ef6d-243">Exécutez maintenant le `Get-Childitem` applet de commande pour récupérer une liste des éléments de base de données, qui sont les tables de base de données disponible.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-243">Now run the `Get-Childitem` cmdlet to retrieve a list of the database items, which are the available database tables.</span></span> <span data-ttu-id="1ef6d-244">Pour chaque table, cette applet de commande récupère également le nombre de lignes de la table.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-244">For each table, this cmdlet also retrieves the number of table rows.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rowcount,name -AutoSize
   ```

   ```output
   RowCount   Name
   --------   ----
        180   MSysAccessObjects
          0   MSysACEs
          1   MSysCmdbars
          0   MSysIMEXColumns
          0   MSysIMEXSpecs
          0   MSysObjects
          0   MSysQueries
          7   MSysRelationships
          8   Categories
         91   Customers
          9   Employees
       2155   Order Details
        830   Orders
         77   Products
          3   Shippers
         29   Suppliers
   ```

3. <span data-ttu-id="1ef6d-245">Utilisez le `Set-Location` applet de commande pour définir l’emplacement de la table de données d’employés.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-245">Use the `Set-Location` cmdlet again to set the location of the Employees data table.</span></span>

   ```powershell
   Set-Location Employees
   ```

4. <span data-ttu-id="1ef6d-246">Nous allons maintenant utiliser le `Get-Location` applet de commande pour récupérer le chemin d’accès à la table Employees.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-246">Let's now use the `Get-Location` cmdlet to retrieve the path to the Employees table.</span></span>

   ```powershell
   Get-Location
   ```

   ```output
   Path
   ----
   mydb:\Employees
   ```

5. <span data-ttu-id="1ef6d-247">À présent utiliser le `Get-Childitem` applet de commande dirigée vers le `Format-Table` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-247">Now use the `Get-Childitem` cmdlet piped to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="1ef6d-248">Cet ensemble d’applets de commande récupère les éléments de la table de données employés, qui correspondent aux lignes de table.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-248">This set of cmdlets retrieves the items for the Employees data table, which are the table rows.</span></span> <span data-ttu-id="1ef6d-249">Ils sont mis en forme comme spécifié par le `Format-Table` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-249">They are formatted as specified by the `Format-Table` cmdlet.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rownumber,psiscontainer,data -AutoSize
   ```

   ```output
   RowNumber   PSIsContainer   Data
   ---------   --------------   ----
   0           False            System.Data.DataRow
   1           False            System.Data.DataRow
   2           False            System.Data.DataRow
   3           False            System.Data.DataRow
   4           False            System.Data.DataRow
   5           False            System.Data.DataRow
   6           False            System.Data.DataRow
   7           False            System.Data.DataRow
   8           False            System.Data.DataRow
   ```

6. <span data-ttu-id="1ef6d-250">Vous pouvez maintenant exécuter le `Get-Item` applet de commande pour récupérer les éléments de la ligne 0 de la table de données d’employés.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-250">You can now run the `Get-Item` cmdlet to retrieve the items for row 0 of the Employees data table.</span></span>

   ```powershell
   Get-Item 0
   ```

   ```output
   PSPath        : AccessDB::C:\PS\Northwind.mdb\Employees\0
   PSParentPath  : AccessDB::C:\PS\Northwind.mdb\Employees
   PSChildName   : 0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data           : System.Data.DataRow
   RowNumber      : 0
   ```

7. <span data-ttu-id="1ef6d-251">Utilisez le `Get-Item` applet de commande pour récupérer les données employé pour les éléments dans la ligne 0.</span><span class="sxs-lookup"><span data-stu-id="1ef6d-251">Use the `Get-Item` cmdlet again to retrieve the employee data for the items in row 0.</span></span>

   ```powershell
   (Get-Item 0).data
   ```

   ```output
   EmployeeID      : 1
   LastName        : Davis
   FirstName       : Sara
   Title           : Sales Representative
   TitleOfCourtesy : Ms.
   BirthDate       : 12/8/1968 12:00:00 AM
   HireDate        : 5/1/1992 12:00:00 AM
   Address         : 4567 Main Street
                     Apt. 2A
   City            : Buffalo
   Region          : NY
   PostalCode      : 98052
   Country         : USA
   HomePhone       : (206) 555-9857
   Extension       : 5467
   Photo           : EmpID1.bmp
   Notes           : Education includes a BA in psychology from
                     Colorado State University. She also completed "The
                     Art of the Cold Call."  Nancy is a member of
                     Toastmasters International.
   ReportsTo       : 2
   ```

## <a name="see-also"></a><span data-ttu-id="1ef6d-252">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="1ef6d-252">See Also</span></span>

[<span data-ttu-id="1ef6d-253">Création de fournisseurs de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="1ef6d-253">Creating Windows PowerShell providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="1ef6d-254">Fournisseur de votre Windows PowerShell de conception</span><span class="sxs-lookup"><span data-stu-id="1ef6d-254">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="1ef6d-255">Extension des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="1ef6d-255">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="1ef6d-256">Extension des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="1ef6d-256">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="1ef6d-257">Implémenter un fournisseur de conteneur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="1ef6d-257">Implement a Container Windows PowerShell provider</span></span>](./creating-a-windows-powershell-container-provider.md)

[<span data-ttu-id="1ef6d-258">Comment inscrire les applets de commande, fournisseurs et héberger des Applications</span><span class="sxs-lookup"><span data-stu-id="1ef6d-258">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="1ef6d-259">Comment inscrire les applets de commande, fournisseurs et héberger des Applications</span><span class="sxs-lookup"><span data-stu-id="1ef6d-259">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="1ef6d-260">Guide du programmeur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="1ef6d-260">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="1ef6d-261">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="1ef6d-261">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)