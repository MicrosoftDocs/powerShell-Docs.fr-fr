---
title: Création d’un fournisseur d’éléments de PowerShell Windows | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- item providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], item provider
ms.assetid: a5a304ce-fc99-4a5b-a779-de7d85e031fe
caps.latest.revision: 6
ms.openlocfilehash: f2c9e10f0dc392399cf062500b7f28b3d1c07f6e
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2019
ms.locfileid: "62081867"
---
# <a name="creating-a-windows-powershell-item-provider"></a><span data-ttu-id="2b1f6-102">Création d’un fournisseur d’élément Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2b1f6-102">Creating a Windows PowerShell Item Provider</span></span>

<span data-ttu-id="2b1f6-103">Cette rubrique décrit comment créer un fournisseur Windows PowerShell qui peut manipuler les données dans un magasin de données.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-103">This topic describes how to create a Windows PowerShell provider that can manipulate the data in a data store.</span></span> <span data-ttu-id="2b1f6-104">Dans cette rubrique, les éléments de données dans le magasin sont désignés pour stocker les « éléments » des données.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-104">In this topic, the elements of data in the store are referred to as the "items" of the data store.</span></span> <span data-ttu-id="2b1f6-105">Par conséquent, un fournisseur qui peut manipuler les données dans le magasin est appelé un fournisseur d’éléments de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-105">As a consequence, a provider that can manipulate the data in the store is referred to as a Windows PowerShell item provider.</span></span>

> [!NOTE]
> <span data-ttu-id="2b1f6-106">Vous pouvez télécharger le C# le fichier source (AccessDBSampleProvider03.cs) pour ce fournisseur en utilisant le Microsoft Windows Software Development Kit pour Windows Vista et les composants d’exécution .NET Framework 3.0.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-106">You can download the C# source file (AccessDBSampleProvider03.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="2b1f6-107">Pour obtenir des instructions de téléchargement, consultez [comment PowerShell de Windows Installer et de télécharger le Kit de développement logiciel de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-107">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="2b1f6-108">Les fichiers source téléchargé sont disponibles dans le  **\<exemples PowerShell >** directory.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-108">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="2b1f6-109">Pour plus d’informations sur les autres implémentations du fournisseur Windows PowerShell, consultez [conception de votre fournisseur Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-109">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="2b1f6-110">Le fournisseur d’éléments de Windows PowerShell décrit dans cette rubrique Obtient les éléments de données à partir d’une base de données Access.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-110">The Windows PowerShell item provider described in this topic gets items of data from an Access database.</span></span> <span data-ttu-id="2b1f6-111">Dans ce cas, un « élément » est soit une table dans la base de données Access ou une ligne dans une table.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-111">In this case, an "item" is either a table in the Access database or a row in a table.</span></span>

<span data-ttu-id="2b1f6-112">La liste suivante contient les sections de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-112">The following list contains the sections in this topic.</span></span> <span data-ttu-id="2b1f6-113">Si vous n’êtes pas familiarisé avec l’écriture d’un fournisseur d’éléments de Windows PowerShell, lisez ces sections dans l’ordre où ils apparaissent.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-113">If you are unfamiliar with writing a Windows PowerShell item provider, read these sections in the order that they appear.</span></span> <span data-ttu-id="2b1f6-114">Toutefois, si vous êtes familiarisé avec l’écriture d’un fournisseur d’éléments de Windows PowerShell, accédez directement aux informations dont vous avez besoin :</span><span class="sxs-lookup"><span data-stu-id="2b1f6-114">However, if you are familiar with writing a Windows PowerShell item provider, go directly to the information that you need:</span></span>

- [<span data-ttu-id="2b1f6-115">Définition de la classe de fournisseur Windows PowerShell élément</span><span class="sxs-lookup"><span data-stu-id="2b1f6-115">Defining the Windows PowerShell Item Provider Class</span></span>](#Defining-the-Windows-PowerShell-Item-Provider-Class)

- [<span data-ttu-id="2b1f6-116">Définition des fonctionnalités de Base</span><span class="sxs-lookup"><span data-stu-id="2b1f6-116">Defining Base Functionality</span></span>](#Defining-Base-Functionality)

- [<span data-ttu-id="2b1f6-117">Vérification de la validité du chemin d’accès</span><span class="sxs-lookup"><span data-stu-id="2b1f6-117">Checking for Path Validity</span></span>](#Checking-for-Path-Validity)

- [<span data-ttu-id="2b1f6-118">Déterminer si un élément existe</span><span class="sxs-lookup"><span data-stu-id="2b1f6-118">Determining if an Item Exists</span></span>](#Determining-if-an-Item-Exists)

- [<span data-ttu-id="2b1f6-119">Attachement des paramètres dynamiques à la `Test-Path` applet de commande</span><span class="sxs-lookup"><span data-stu-id="2b1f6-119">Attaching Dynamic Parameters to the `Test-Path` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Test-Path-Cmdlet)

- [<span data-ttu-id="2b1f6-120">Extraction d’un élément</span><span class="sxs-lookup"><span data-stu-id="2b1f6-120">Retrieving an Item</span></span>](#Retrieving-an-Item)

- [<span data-ttu-id="2b1f6-121">Attachement des paramètres dynamiques à la `Get-Item` applet de commande</span><span class="sxs-lookup"><span data-stu-id="2b1f6-121">Attaching Dynamic Parameters to the `Get-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-Item-Cmdlet)

- [<span data-ttu-id="2b1f6-122">Spécification d’un élément</span><span class="sxs-lookup"><span data-stu-id="2b1f6-122">Setting an Item</span></span>](#Setting-an-Item)

- [<span data-ttu-id="2b1f6-123">Attachement des paramètres dynamiques à la `Set-Item` applet de commande</span><span class="sxs-lookup"><span data-stu-id="2b1f6-123">Attaching Dynamic Parameters to the `Set-Item` Cmdlet</span></span>](#Retrieving-Dynamic-Parameters-for-SetItem)

- [<span data-ttu-id="2b1f6-124">Efface un élément</span><span class="sxs-lookup"><span data-stu-id="2b1f6-124">Clearing an Item</span></span>](#Clearing-an-Item)

- [<span data-ttu-id="2b1f6-125">Attachement des paramètres dynamiques à l’applet de commande Clear-Item</span><span class="sxs-lookup"><span data-stu-id="2b1f6-125">Attaching Dynamic Parameters to the Clear-Item Cmdlet</span></span>](#Retrieve-Dynamic-Parameters-for-ClearItem)

- [<span data-ttu-id="2b1f6-126">Exécution d’une Action par défaut pour un élément</span><span class="sxs-lookup"><span data-stu-id="2b1f6-126">Performing a Default Action for an Item</span></span>](#Performing-a-Default-Action-for-an-Item)

- [<span data-ttu-id="2b1f6-127">Récupération des paramètres dynamiques pour InvokeDefaultAction</span><span class="sxs-lookup"><span data-stu-id="2b1f6-127">Retrieving Dynamic Parameters for InvokeDefaultAction</span></span>](#Retrieve-Dynamic-Parameters-for-InvokeDefaultAction)

- [<span data-ttu-id="2b1f6-128">Implémentation des Classes et méthodes d’assistance</span><span class="sxs-lookup"><span data-stu-id="2b1f6-128">Implementing Helper Methods and Classes</span></span>](#Implementing-Helper-Methods-and-Classes)

- [<span data-ttu-id="2b1f6-129">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="2b1f6-129">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="2b1f6-130">Définition des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="2b1f6-130">Defining Object Types and Formatting</span></span>](#Defining-Object-Types-and-Formatting)

- [<span data-ttu-id="2b1f6-131">Construction du fournisseur PowerShell de Windows</span><span class="sxs-lookup"><span data-stu-id="2b1f6-131">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-provider)

- [<span data-ttu-id="2b1f6-132">Test du fournisseur PowerShell de Windows</span><span class="sxs-lookup"><span data-stu-id="2b1f6-132">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-provider)

## <a name="defining-the-windows-powershell-item-provider-class"></a><span data-ttu-id="2b1f6-133">Définition de la classe de fournisseur Windows PowerShell élément</span><span class="sxs-lookup"><span data-stu-id="2b1f6-133">Defining the Windows PowerShell Item Provider Class</span></span>

<span data-ttu-id="2b1f6-134">Un fournisseur d’éléments de Windows PowerShell doive définir une classe .NET qui dérive de la [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) classe de base.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-134">A Windows PowerShell item provider must define a .NET class that derives from the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="2b1f6-135">Voici la définition de classe pour le fournisseur d’éléments décrit dans cette section.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-135">The following is the class definition for the item provider described in this section.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L34-L36 "AccessDBProviderSample03.cs")]

<span data-ttu-id="2b1f6-136">Notez que, dans cette définition, de la classe la [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribut inclut deux paramètres.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-136">Note that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="2b1f6-137">Le premier paramètre spécifie un nom convivial pour le fournisseur qui est utilisé par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-137">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="2b1f6-138">Le deuxième paramètre spécifie les fonctionnalités spécifiques de Windows PowerShell que le fournisseur expose à l’exécution de Windows PowerShell au cours du traitement de commande.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-138">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="2b1f6-139">Pour ce fournisseur, il n’existe aucun ajout capacités spécifiques de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-139">For this provider, there are no added Windows PowerShell specific capabilities.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="2b1f6-140">Définition des fonctionnalités de Base</span><span class="sxs-lookup"><span data-stu-id="2b1f6-140">Defining Base Functionality</span></span>

<span data-ttu-id="2b1f6-141">Comme décrit dans [fournisseur Design Your Windows PowerShell](./designing-your-windows-powershell-provider.md), le [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) classe est dérivée de plusieurs autres classes fourni différents fonctionnalités du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-141">As described in [Design Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="2b1f6-142">Un fournisseur d’éléments de Windows PowerShell, par conséquent, doive définir toutes les fonctionnalités fournies par les classes.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-142">A Windows PowerShell item provider, therefore, must define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="2b1f6-143">Pour plus d’informations sur la façon d’implémenter des fonctionnalités permettant d’ajouter des informations d’initialisation spécifiques à la session et pour libérer les ressources utilisées par le fournisseur, consultez [création d’un fournisseur de PowerShell Windows base](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-143">For more information about how to implement functionality for adding session-specific initialization information and for releasing resources used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="2b1f6-144">Toutefois, la plupart des fournisseurs, y compris le fournisseur décrit ici, peut utiliser l’implémentation par défaut de cette fonctionnalité est fournie par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-144">However, most providers, including the provider described here, can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="2b1f6-145">Avant que le fournisseur d’éléments de Windows PowerShell peut manipuler les éléments dans le magasin, il doit implémenter les méthodes de la [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) classe de base pour accéder au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-145">Before the Windows PowerShell item provider can manipulate the items in the store, it must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class to access to the data store.</span></span> <span data-ttu-id="2b1f6-146">Pour plus d’informations sur l’implémentation de cette classe, consultez [création d’un fournisseur de lecteur Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-146">For more information about implementing this class, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

## <a name="checking-for-path-validity"></a><span data-ttu-id="2b1f6-147">Vérification de la validité du chemin d’accès</span><span class="sxs-lookup"><span data-stu-id="2b1f6-147">Checking for Path Validity</span></span>

<span data-ttu-id="2b1f6-148">Lorsque vous recherchez un élément de données, le runtime Windows PowerShell fournit un chemin d’accès Windows PowerShell pour le fournisseur, tel que défini dans la section « Concepts PSPath » de [Windows PowerShell fonctionnement](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-148">When looking for an item of data, the Windows PowerShell runtime furnishes a Windows PowerShell path to the provider, as defined in the "PSPath Concepts" section of [How Windows PowerShell Works](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58).</span></span> <span data-ttu-id="2b1f6-149">Un fournisseur d’éléments de Windows PowerShell doit vérifier la validité syntaxique et sémantique de n’importe quel chemin d’accès passé en implémentant la [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) (méthode).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-149">An Windows PowerShell item provider must verify the syntactic and semantic validity of any path passed to it by implementing the [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) method.</span></span> <span data-ttu-id="2b1f6-150">Cette méthode retourne `true` si le chemin d’accès est valide, et `false` dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-150">This method returns `true` if the path is valid, and `false` otherwise.</span></span> <span data-ttu-id="2b1f6-151">Être conscient que l’implémentation de cette méthode ne doit pas vérifier l’existence de l’élément dans le chemin d’accès, mais uniquement le chemin d’accès est syntaxiquement et sémantiquement correct.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-151">Be aware that the implementation of this method should not verify the existence of the item at the path, but only that the path is syntactically and semantically correct.</span></span>

<span data-ttu-id="2b1f6-152">Voici l’implémentation de la [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) méthode pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-152">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) method for this provider.</span></span> <span data-ttu-id="2b1f6-153">Notez que cette implémentation appelle une méthode d’assistance de NormalizePath pour convertir tous les séparateurs dans le chemin d’accès vers un uniforme.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-153">Note that this implementation calls a NormalizePath helper method to convert all separators in the path to a uniform one.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L274-L298 "AccessDBProviderSample03.cs")]

## <a name="determining-if-an-item-exists"></a><span data-ttu-id="2b1f6-154">Déterminer si un élément existe</span><span class="sxs-lookup"><span data-stu-id="2b1f6-154">Determining if an Item Exists</span></span>

<span data-ttu-id="2b1f6-155">Après avoir vérifié le chemin d’accès, le runtime Windows PowerShell doit déterminer si un élément de données existe à ce chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-155">After verifying the path, the Windows PowerShell runtime must determine if an item of data exists at that path.</span></span> <span data-ttu-id="2b1f6-156">Pour prendre en charge ce type de requête, le fournisseur d’éléments de Windows PowerShell implémente le [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) (méthode).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-156">To support this type of query, the Windows PowerShell item provider implements the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method.</span></span> <span data-ttu-id="2b1f6-157">Cette méthode retourne `true` un élément est trouvé dans le chemin spécifié et `false` (par défaut) dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-157">This method returns `true` an item is found at the specified path and `false` (default) otherwise.</span></span>

<span data-ttu-id="2b1f6-158">Voici l’implémentation de la [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) méthode pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-158">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method for this provider.</span></span> <span data-ttu-id="2b1f6-159">Notez que cette méthode appelle les méthodes d’assistance PathIsDrive, ChunkPath et GetTable et utilise un fournisseur définis DatabaseTableInfo objet.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-159">Note that this method calls the PathIsDrive, ChunkPath, and GetTable helper methods, and uses a provider defined DatabaseTableInfo object.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L229-L267 "AccessDBProviderSample03.cs")]

#### <a name="things-to-remember-about-implementing-itemexists"></a><span data-ttu-id="2b1f6-160">Points à retenir sur l’implémentation ItemExists</span><span class="sxs-lookup"><span data-stu-id="2b1f6-160">Things to Remember About Implementing ItemExists</span></span>

<span data-ttu-id="2b1f6-161">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists):</span><span class="sxs-lookup"><span data-stu-id="2b1f6-161">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists):</span></span>

- <span data-ttu-id="2b1f6-162">Lorsque vous définissez la classe de fournisseur, un fournisseur d’éléments de Windows PowerShell peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)énumération.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-162">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="2b1f6-163">Dans ce cas, l’implémentation de la [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) méthode devez vous assurer que le chemin d’accès transmis à la méthode remplit les conditions de la valeur capabilities spécifiée.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-163">In these cases, the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="2b1f6-164">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriétés.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-164">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="2b1f6-165">L’implémentation de cette méthode doit gérer toutes les formes de l’accès à l’élément qui peut rendre l’élément visible par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-165">The implementation of this method should handle any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="2b1f6-166">Par exemple, si un utilisateur a accès à un fichier via le fournisseur FileSystem (fourni par Windows PowerShell), mais pas l’accès en lecture, le fichier existe toujours et [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) retourne `true`.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-166">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="2b1f6-167">Votre implémentation peut nécessiter la vérification d’un élément parent pour voir si l’élément enfant peut être énuméré.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-167">Your implementation might require checking a parent item to see if the child item can be enumerated.</span></span>

## <a name="attaching-dynamic-parameters-to-the-test-path-cmdlet"></a><span data-ttu-id="2b1f6-168">Attachement des paramètres dynamiques à l’applet de commande Test-Path</span><span class="sxs-lookup"><span data-stu-id="2b1f6-168">Attaching Dynamic Parameters to the Test-Path Cmdlet</span></span>

<span data-ttu-id="2b1f6-169">Parfois le `Test-Path` applet de commande qui appelle [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) requiert des paramètres supplémentaires qui sont spécifiés de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-169">Sometimes the `Test-Path` cmdlet that calls [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="2b1f6-170">Pour fournir ces paramètres dynamiques Windows PowerShell élément fournisseur doit implémenter la [System.Management.Automation.Provider.Itemcmdletprovider.Itemexistsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExistsDynamicParameters) (méthode).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-170">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexistsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExistsDynamicParameters) method.</span></span> <span data-ttu-id="2b1f6-171">Cette méthode récupère les paramètres dynamiques pour l’élément dans le chemin d’accès indiqué et retourne un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-171">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="2b1f6-172">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à la `Test-Path` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-172">The Windows PowerShell runtime uses the returned object to add the parameters to the `Test-Path` cmdlet.</span></span>

<span data-ttu-id="2b1f6-173">Ce fournisseur d’élément de Windows PowerShell n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-173">This Windows PowerShell item provider does not implement this method.</span></span> <span data-ttu-id="2b1f6-174">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-174">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovideritemexistdynamicparameters](Msh_samplestestcmdlets#testprovideritemexistdynamicparameters)]  -->

## <a name="retrieving-an-item"></a><span data-ttu-id="2b1f6-175">Extraction d’un élément</span><span class="sxs-lookup"><span data-stu-id="2b1f6-175">Retrieving an Item</span></span>

<span data-ttu-id="2b1f6-176">Pour récupérer un élément, le fournisseur d’éléments de Windows PowerShell doit remplacer [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) méthode pour prendre en charge les appels à partir de la `Get-Item` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-176">To retrieve an item, the Windows PowerShell item provider must override [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method to support calls from the `Get-Item` cmdlet.</span></span> <span data-ttu-id="2b1f6-177">Cette méthode écrit l’élément à l’aide du [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) (méthode).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-177">This method writes the item using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method.</span></span>

<span data-ttu-id="2b1f6-178">Voici l’implémentation de la [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) méthode pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-178">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for this provider.</span></span> <span data-ttu-id="2b1f6-179">Notez que cette méthode utilise les méthodes d’assistance GetTable et GetRow pour récupérer des éléments qui sont des tables dans la base de données Access ou des lignes dans une table de données.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-179">Note that this method uses the GetTable and GetRow helper methods to retrieve items that are either tables in the Access database or rows in a data table.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L132-L163 "AccessDBProviderSample03.cs")]

#### <a name="things-to-remember-about-implementing-getitem"></a><span data-ttu-id="2b1f6-180">Points à retenir sur l’implémentation GetItem</span><span class="sxs-lookup"><span data-stu-id="2b1f6-180">Things to Remember About Implementing GetItem</span></span>

<span data-ttu-id="2b1f6-181">Les conditions suivantes peuvent s’appliquer à une implémentation de [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem):</span><span class="sxs-lookup"><span data-stu-id="2b1f6-181">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem):</span></span>

- <span data-ttu-id="2b1f6-182">Lorsque vous définissez la classe de fournisseur, un fournisseur d’éléments de Windows PowerShell peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)énumération.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-182">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="2b1f6-183">Dans ce cas, l’implémentation de [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) devez vous assurer que le chemin d’accès transmis à la méthode répond à ces exigences.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-183">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="2b1f6-184">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriétés.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-184">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="2b1f6-185">Par défaut, les substitutions de cette méthode ne doivent pas récupérer les objets qui sont généralement masquées à partir de l’utilisateur, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-185">By default, overrides of this method should not retrieve objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="2b1f6-186">Par exemple, le [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) méthode pour les vérifications de fournisseur de système de fichiers le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété avant d’essayer d’appeler [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) cachés ou les fichiers système.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-186">For example, the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the FileSystem provider checks the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property before it attempts to call [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) for hidden or system files.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-item-cmdlet"></a><span data-ttu-id="2b1f6-187">Attachement des paramètres dynamiques à l’applet de commande Get-Item</span><span class="sxs-lookup"><span data-stu-id="2b1f6-187">Attaching Dynamic Parameters to the Get-Item Cmdlet</span></span>

<span data-ttu-id="2b1f6-188">Parfois le `Get-Item` applet de commande requiert des paramètres supplémentaires qui sont spécifiés de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-188">Sometimes the `Get-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="2b1f6-189">Pour fournir ces paramètres dynamiques Windows PowerShell élément fournisseur doit implémenter la [System.Management.Automation.Provider.Itemcmdletprovider.Getitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItemDynamicParameters) (méthode).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-189">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Getitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItemDynamicParameters) method.</span></span> <span data-ttu-id="2b1f6-190">Cette méthode récupère les paramètres dynamiques pour l’élément dans le chemin d’accès indiqué et retourne un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-190">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="2b1f6-191">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à la `Get-Item` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-191">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-Item` cmdlet.</span></span>

<span data-ttu-id="2b1f6-192">Ce fournisseur n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-192">This provider does not implement this method.</span></span> <span data-ttu-id="2b1f6-193">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-193">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetitemdynamicparameters](Msh_samplestestcmdlets#testprovidergetitemdynamicparameters)]  -->

## <a name="setting-an-item"></a><span data-ttu-id="2b1f6-194">Spécification d’un élément</span><span class="sxs-lookup"><span data-stu-id="2b1f6-194">Setting an Item</span></span>

<span data-ttu-id="2b1f6-195">Pour définir un élément, le fournisseur d’éléments de Windows PowerShell doit remplacer le [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) méthode pour prendre en charge les appels à partir de la `Set-Item` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-195">To set an item, the Windows PowerShell item provider must override the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method to support calls from the `Set-Item` cmdlet.</span></span> <span data-ttu-id="2b1f6-196">Cette méthode définit la valeur de l’élément dans le chemin spécifié.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-196">This method sets the value of the item at the specified path.</span></span>

<span data-ttu-id="2b1f6-197">Ce fournisseur ne fournit pas un remplacement pour le [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) (méthode).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-197">This provider does not provide an override for the  [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method.</span></span> <span data-ttu-id="2b1f6-198">Toutefois, ce qui suit est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-198">However, the following is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidersetitem](Msh_samplestestcmdlets#testprovidersetitem)]  -->

#### <a name="things-to-remember-about-implementing-setitem"></a><span data-ttu-id="2b1f6-199">Points à retenir sur l’implémentation SetItem</span><span class="sxs-lookup"><span data-stu-id="2b1f6-199">Things to Remember About Implementing SetItem</span></span>

<span data-ttu-id="2b1f6-200">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem):</span><span class="sxs-lookup"><span data-stu-id="2b1f6-200">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem):</span></span>

- <span data-ttu-id="2b1f6-201">Lorsque vous définissez la classe de fournisseur, un fournisseur d’éléments de Windows PowerShell peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)énumération.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-201">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="2b1f6-202">Dans ce cas, l’implémentation de [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) devez vous assurer que le chemin d’accès transmis à la méthode répond à ces exigences.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-202">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="2b1f6-203">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriétés.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-203">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="2b1f6-204">Par défaut, les substitutions de cette méthode ne doivent pas définir ou écrire des objets qui sont masqués à partir de l’utilisateur, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-204">By default, overrides of this method should not set or write objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="2b1f6-205">Une erreur doit être envoyée à la [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) méthode si le chemin d’accès représente un élément caché et [ System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) est défini sur `false`.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-205">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents a hidden item and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="2b1f6-206">Votre implémentation de la [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) méthode doit appeler [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)et vérifier sa valeur de retour avant d’apporter des modifications au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-206">Your implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="2b1f6-207">Cette méthode est utilisée pour confirmer l’exécution d’une opération lorsqu’une modification est apportée au magasin de données, par exemple, la suppression de fichiers.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-207">This method is used to confirm execution of an operation when a change is made to the data store, for example, deleting files.</span></span> <span data-ttu-id="2b1f6-208">Le [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) méthode envoie le nom de la ressource à modifier à l’utilisateur, avec le runtime de Windows PowerShell en prenant en compte tous les paramètres de ligne de commande ou variables de préférence pour déterminer ce qui doit être affiché.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-208">The [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) method sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="2b1f6-209">Après l’appel à [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourne `true`, le [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem)méthode doit appeler la [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) (méthode).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-209">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="2b1f6-210">Cette méthode envoie un message à l’utilisateur pour que les commentaires vérifier si l’opération doit être poursuivie.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-210">This method sends a message to the user to allow feedback to verify if the operation should be continued.</span></span> <span data-ttu-id="2b1f6-211">L’appel à [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) permet une vérification supplémentaire pour les modifications du système potentiellement dangereux.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-211">The call to [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) allows an additional check for potentially dangerous system modifications.</span></span>

## <a name="retrieving-dynamic-parameters-for-setitem"></a><span data-ttu-id="2b1f6-212">Récupération des paramètres dynamiques pour SetItem</span><span class="sxs-lookup"><span data-stu-id="2b1f6-212">Retrieving Dynamic Parameters for SetItem</span></span>

<span data-ttu-id="2b1f6-213">Parfois le `Set-Item` applet de commande requiert des paramètres supplémentaires qui sont spécifiés de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-213">Sometimes the `Set-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="2b1f6-214">Pour fournir ces paramètres dynamiques Windows PowerShell élément fournisseur doit implémenter la [System.Management.Automation.Provider.Itemcmdletprovider.Setitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItemDynamicParameters) (méthode).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-214">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Setitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItemDynamicParameters) method.</span></span> <span data-ttu-id="2b1f6-215">Cette méthode récupère les paramètres dynamiques pour l’élément dans le chemin d’accès indiqué et retourne un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-215">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="2b1f6-216">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à la `Set-Item` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-216">The Windows PowerShell runtime uses the returned object to add the parameters to the `Set-Item` cmdlet.</span></span>

<span data-ttu-id="2b1f6-217">Ce fournisseur n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-217">This provider does not implement this method.</span></span> <span data-ttu-id="2b1f6-218">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-218">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidersetitemdynamicparameters](Msh_samplestestcmdlets#testprovidersetitemdynamicparameters)]  -->

## <a name="clearing-an-item"></a><span data-ttu-id="2b1f6-219">Efface un élément</span><span class="sxs-lookup"><span data-stu-id="2b1f6-219">Clearing an Item</span></span>

<span data-ttu-id="2b1f6-220">Pour supprimer un élément, le fournisseur d’éléments de Windows PowerShell implémente le [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) méthode pour prendre en charge les appels à partir de la `Clear-Item` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-220">To clear an item, the Windows PowerShell item provider implements the [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) method to support calls from the `Clear-Item` cmdlet.</span></span> <span data-ttu-id="2b1f6-221">Cette méthode efface l’élément de données dans le chemin spécifié.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-221">This method erases the data item at the specified path.</span></span>

<span data-ttu-id="2b1f6-222">Ce fournisseur n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-222">This provider does not implement this method.</span></span> <span data-ttu-id="2b1f6-223">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-223">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderclearitem](Msh_samplestestcmdlets#testproviderclearitem)]  -->

#### <a name="things-to-remember-about-implementing-clearitem"></a><span data-ttu-id="2b1f6-224">Points à retenir sur l’implémentation ClearItem</span><span class="sxs-lookup"><span data-stu-id="2b1f6-224">Things to Remember About Implementing ClearItem</span></span>

<span data-ttu-id="2b1f6-225">Les conditions suivantes peuvent s’appliquer à une implémentation de [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem):</span><span class="sxs-lookup"><span data-stu-id="2b1f6-225">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem):</span></span>

- <span data-ttu-id="2b1f6-226">Lorsque vous définissez la classe de fournisseur, un fournisseur d’éléments de Windows PowerShell peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)énumération.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-226">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="2b1f6-227">Dans ce cas, l’implémentation de [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) devez vous assurer que le chemin d’accès transmis à la méthode répond à ces exigences.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-227">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="2b1f6-228">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriétés.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-228">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="2b1f6-229">Par défaut, les substitutions de cette méthode ne doivent pas définir ou écrire des objets qui sont masqués à partir de l’utilisateur, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-229">By default, overrides of this method should not set or write objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="2b1f6-230">Une erreur doit être envoyée à la [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) méthode si le chemin d’accès représente un élément est masqué pour l’utilisateur et [ System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) est défini sur `false`.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-230">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="2b1f6-231">Votre implémentation de la [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) méthode doit appeler [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)et vérifier sa valeur de retour avant d’apporter des modifications au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-231">Your implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="2b1f6-232">Cette méthode est utilisée pour confirmer l’exécution d’une opération lorsqu’une modification est apportée au magasin de données, par exemple, la suppression de fichiers.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-232">This method is used to confirm execution of an operation when a change is made to the data store, for example, deleting files.</span></span> <span data-ttu-id="2b1f6-233">Le [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) méthode envoie le nom de la ressource à être modifié à l’utilisateur, avec le runtime de Windows PowerShell et de gérer les paramètres de ligne de commande ou une préférence variables de déterminer ce qui doit être affiché.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-233">The [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) method sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handle any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="2b1f6-234">Après l’appel à [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourne `true`, le [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem)méthode doit appeler la [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) (méthode).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-234">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="2b1f6-235">Cette méthode envoie un message à l’utilisateur pour que les commentaires vérifier si l’opération doit être poursuivie.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-235">This method sends a message to the user to allow feedback to verify if the operation should be continued.</span></span> <span data-ttu-id="2b1f6-236">L’appel à [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) permet une vérification supplémentaire pour les modifications du système potentiellement dangereux.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-236">The call to [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) allows an additional check for potentially dangerous system modifications.</span></span>

## <a name="retrieve-dynamic-parameters-for-clearitem"></a><span data-ttu-id="2b1f6-237">Récupérer les paramètres dynamiques pour ClearItem</span><span class="sxs-lookup"><span data-stu-id="2b1f6-237">Retrieve Dynamic Parameters for ClearItem</span></span>

<span data-ttu-id="2b1f6-238">Parfois le `Clear-Item` applet de commande requiert des paramètres supplémentaires qui sont spécifiés de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-238">Sometimes the `Clear-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="2b1f6-239">Pour fournir ces paramètres dynamiques Windows PowerShell élément fournisseur doit implémenter la [System.Management.Automation.Provider.Itemcmdletprovider.Clearitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItemDynamicParameters) (méthode).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-239">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Clearitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItemDynamicParameters) method.</span></span> <span data-ttu-id="2b1f6-240">Cette méthode récupère les paramètres dynamiques pour l’élément dans le chemin d’accès indiqué et retourne un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-240">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="2b1f6-241">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à la `Clear-Item` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-241">The Windows PowerShell runtime uses the returned object to add the parameters to the `Clear-Item` cmdlet.</span></span>

<span data-ttu-id="2b1f6-242">Ce fournisseur de l’élément n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-242">This item provider does not implement this method.</span></span> <span data-ttu-id="2b1f6-243">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-243">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderclearitemdynamicparameters](Msh_samplestestcmdlets#testproviderclearitemdynamicparameters)]  -->

## <a name="performing-a-default-action-for-an-item"></a><span data-ttu-id="2b1f6-244">Exécution d’une Action par défaut pour un élément</span><span class="sxs-lookup"><span data-stu-id="2b1f6-244">Performing a Default Action for an Item</span></span>

<span data-ttu-id="2b1f6-245">Un fournisseur d’éléments de Windows PowerShell peut implémenter la [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) méthode pour prendre en charge les appels à partir de la `Invoke-Item` applet de commande, qui permet au fournisseur à effectuer une action par défaut pour l’élément dans le chemin spécifié.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-245">A Windows PowerShell item provider can implement the [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) method to support calls from the `Invoke-Item` cmdlet, which allows the provider to perform a default action for the item at the specified path.</span></span> <span data-ttu-id="2b1f6-246">Par exemple, le fournisseur FileSystem peut utiliser cette méthode à appeler ShellExecute pour un élément spécifique.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-246">For example, the FileSystem provider might use this method to call ShellExecute for a specific item.</span></span>

<span data-ttu-id="2b1f6-247">Ce fournisseur n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-247">This provider does not implement this method.</span></span> <span data-ttu-id="2b1f6-248">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-248">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderinvokedefaultaction](Msh_samplestestcmdlets#testproviderinvokedefaultaction)]  -->

#### <a name="things-to-remember-about-implementing-invokedefaultaction"></a><span data-ttu-id="2b1f6-249">Points à retenir sur l’implémentation InvokeDefaultAction</span><span class="sxs-lookup"><span data-stu-id="2b1f6-249">Things to Remember About Implementing InvokeDefaultAction</span></span>

<span data-ttu-id="2b1f6-250">Les conditions suivantes peuvent s’appliquer à une implémentation de [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction):</span><span class="sxs-lookup"><span data-stu-id="2b1f6-250">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction):</span></span>

- <span data-ttu-id="2b1f6-251">Lorsque vous définissez la classe de fournisseur, un fournisseur d’éléments de Windows PowerShell peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)énumération.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-251">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="2b1f6-252">Dans ce cas, l’implémentation de [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) devez vous assurer que le chemin d’accès transmis à la méthode répond à ces exigences.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-252">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="2b1f6-253">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriétés.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-253">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="2b1f6-254">Par défaut, les substitutions de cette méthode ne doivent pas définir ou écrire des objets masqués à partir de l’utilisateur, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-254">By default, overrides of this method should not set or write objects hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="2b1f6-255">Une erreur doit être envoyée à la [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) méthode si le chemin d’accès représente un élément est masqué pour l’utilisateur et [ System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) est défini sur `false`.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-255">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.WriteError](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="retrieve-dynamic-parameters-for-invokedefaultaction"></a><span data-ttu-id="2b1f6-256">Récupérer les paramètres dynamiques pour InvokeDefaultAction</span><span class="sxs-lookup"><span data-stu-id="2b1f6-256">Retrieve Dynamic Parameters for InvokeDefaultAction</span></span>

<span data-ttu-id="2b1f6-257">Parfois le `Invoke-Item` applet de commande requiert des paramètres supplémentaires qui sont spécifiés de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-257">Sometimes the `Invoke-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="2b1f6-258">Pour fournir ces paramètres dynamiques Windows PowerShell élément fournisseur doit implémenter la [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultactiondynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultActionDynamicParameters) (méthode).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-258">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultactiondynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultActionDynamicParameters) method.</span></span> <span data-ttu-id="2b1f6-259">Cette méthode récupère les paramètres dynamiques pour l’élément dans le chemin d’accès indiqué et retourne un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-259">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="2b1f6-260">Le runtime de Windows PowerShell utilise l’objet retourné pour ajouter les paramètres dynamiques à la `Invoke-Item` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-260">The Windows PowerShell runtime uses the returned object to add the dynamic parameters to the `Invoke-Item` cmdlet.</span></span>

<span data-ttu-id="2b1f6-261">Ce fournisseur de l’élément n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-261">This item provider does not implement this method.</span></span> <span data-ttu-id="2b1f6-262">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-262">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderinvokedefaultactiondynamicparameters](Msh_samplestestcmdlets#testproviderinvokedefaultactiondynamicparameters)]  -->

## <a name="implementing-helper-methods-and-classes"></a><span data-ttu-id="2b1f6-263">Implémentation des Classes et méthodes d’assistance</span><span class="sxs-lookup"><span data-stu-id="2b1f6-263">Implementing Helper Methods and Classes</span></span>

<span data-ttu-id="2b1f6-264">Ce fournisseur d’élément implémente plusieurs méthodes d’assistance et les classes qui sont utilisées par le public substituer les méthodes définies par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-264">This item provider implements several helper methods and classes that are used by the public override methods defined by Windows PowerShell.</span></span> <span data-ttu-id="2b1f6-265">Le code de ces classes et méthodes d’assistance sont affichés dans le [exemple de Code](#Code-Sample) section.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-265">The code for these helper methods and classes are shown in the [Code Sample](#Code-Sample) section.</span></span>

### <a name="normalizepath-method"></a><span data-ttu-id="2b1f6-266">NormalizePath (méthode)</span><span class="sxs-lookup"><span data-stu-id="2b1f6-266">NormalizePath Method</span></span>

<span data-ttu-id="2b1f6-267">Ce fournisseur d’élément implémente une méthode d’assistance de NormalizePath pour vérifier que le chemin d’accès a un format cohérent.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-267">This item provider implements a NormalizePath helper method to ensure that the path has a consistent format.</span></span> <span data-ttu-id="2b1f6-268">Le format spécifié utilise une barre oblique inverse (\\) comme séparateur.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-268">The format specified uses a backslash (\\) as a separator.</span></span>

### <a name="pathisdrive-method"></a><span data-ttu-id="2b1f6-269">PathIsDrive (méthode)</span><span class="sxs-lookup"><span data-stu-id="2b1f6-269">PathIsDrive Method</span></span>

<span data-ttu-id="2b1f6-270">Ce fournisseur d’élément implémente une méthode d’assistance de PathIsDrive pour déterminer si le chemin d’accès spécifié est en fait le nom du lecteur.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-270">This item provider implements a PathIsDrive helper method to determine if the specified path is actually the drive name.</span></span>

### <a name="chunkpath-method"></a><span data-ttu-id="2b1f6-271">ChunkPath (méthode)</span><span class="sxs-lookup"><span data-stu-id="2b1f6-271">ChunkPath Method</span></span>

<span data-ttu-id="2b1f6-272">Ce fournisseur d’élément implémente une méthode d’assistance ChunkPath qui répartit le chemin d’accès spécifié afin que le fournisseur puisse identifier ses éléments individuels.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-272">This item provider implements a ChunkPath helper method that breaks up the specified path so that the provider can identify its individual elements.</span></span> <span data-ttu-id="2b1f6-273">Elle retourne qu'un tableau composé des éléments de chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-273">It returns an array composed of the path elements.</span></span>

### <a name="gettable-method"></a><span data-ttu-id="2b1f6-274">GetTable (méthode)</span><span class="sxs-lookup"><span data-stu-id="2b1f6-274">GetTable Method</span></span>

<span data-ttu-id="2b1f6-275">Ce fournisseur d’élément implémente la méthode d’assistance GetTables qui retourne un objet DatabaseTableInfo qui représente des informations sur la table spécifiée dans l’appel.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-275">This item provider implements the GetTables helper method that returns a DatabaseTableInfo object that represents information about the table specified in the call.</span></span>

### <a name="getrow-method"></a><span data-ttu-id="2b1f6-276">GetRow, méthode</span><span class="sxs-lookup"><span data-stu-id="2b1f6-276">GetRow Method</span></span>

<span data-ttu-id="2b1f6-277">Le [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) méthode de ce fournisseur d’élément appelle la méthode d’assistance de GetRows.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-277">The [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method of this item provider calls the GetRows helper method.</span></span> <span data-ttu-id="2b1f6-278">Cette méthode d’assistance récupère un objet DatabaseRowInfo qui représente des informations sur la ligne spécifiée dans la table.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-278">This helper method retrieves a DatabaseRowInfo object that represents information about the specified row in the table.</span></span>

### <a name="databasetableinfo-class"></a><span data-ttu-id="2b1f6-279">Classe de DatabaseTableInfo</span><span class="sxs-lookup"><span data-stu-id="2b1f6-279">DatabaseTableInfo Class</span></span>

<span data-ttu-id="2b1f6-280">Ce fournisseur de l’élément définit une classe DatabaseTableInfo qui représente une collection d’informations dans une table de données dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-280">This item provider defines a DatabaseTableInfo class that represents a collection of information in a data table in the database.</span></span> <span data-ttu-id="2b1f6-281">Cette classe est semblable à la [System.IO.Directoryinfo](/dotnet/api/System.IO.DirectoryInfo) classe.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-281">This class is similar to the [System.IO.Directoryinfo](/dotnet/api/System.IO.DirectoryInfo) class.</span></span>

<span data-ttu-id="2b1f6-282">L’exemple de fournisseur d’élément définit une méthode DatabaseTableInfo.GetTables qui retourne une collection d’objets d’informations de table définissant les tables dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-282">The sample item provider defines a DatabaseTableInfo.GetTables method that returns a collection of table information objects defining the tables in the database.</span></span> <span data-ttu-id="2b1f6-283">Cette méthode inclut un bloc try/catch pour vous assurer que toute erreur de base de données s’affiche comme une ligne avec les entrées de zéro.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-283">This method includes a try/catch block to ensure that any database error shows up as a row with zero entries.</span></span>

### <a name="databaserowinfo-class"></a><span data-ttu-id="2b1f6-284">DatabaseRowInfo Class</span><span class="sxs-lookup"><span data-stu-id="2b1f6-284">DatabaseRowInfo Class</span></span>

<span data-ttu-id="2b1f6-285">Ce fournisseur d’élément définit la classe d’assistance DatabaseRowInfo qui représente une ligne dans une table de la base de données.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-285">This item provider defines the DatabaseRowInfo helper class that represents a row in a table of the database.</span></span> <span data-ttu-id="2b1f6-286">Cette classe est semblable à la [System.IO.FileInfo](/dotnet/api/System.IO.FileInfo) classe.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-286">This class is similar to the [System.IO.FileInfo](/dotnet/api/System.IO.FileInfo) class.</span></span>

<span data-ttu-id="2b1f6-287">L’exemple de fournisseur définit une méthode DatabaseRowInfo.GetRows pour retourner une collection d’objets d’informations de ligne pour la table spécifiée.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-287">The sample provider defines a DatabaseRowInfo.GetRows method to return a collection of row information objects for the specified table.</span></span> <span data-ttu-id="2b1f6-288">Cette méthode inclut un bloc try/catch pour intercepter les exceptions.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-288">This method includes a try/catch block to trap exceptions.</span></span> <span data-ttu-id="2b1f6-289">Aucune information de ligne entraîne des erreurs.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-289">Any errors will result in no row information.</span></span>

## <a name="code-sample"></a><span data-ttu-id="2b1f6-290">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="2b1f6-290">Code Sample</span></span>

<span data-ttu-id="2b1f6-291">Pour l’exemple de code complet, consultez [exemple de Code AccessDbProviderSample03](./accessdbprovidersample03-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-291">For complete sample code, see [AccessDbProviderSample03 Code Sample](./accessdbprovidersample03-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="2b1f6-292">Définition des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="2b1f6-292">Defining Object Types and Formatting</span></span>

<span data-ttu-id="2b1f6-293">Lorsque vous écrivez un fournisseur, il peut être nécessaire d’ajouter des membres à des objets existants ou définir de nouveaux objets.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-293">When writing a provider, it may be necessary to add members to existing objects or define new objects.</span></span> <span data-ttu-id="2b1f6-294">Lorsque vous avez terminé, créez un fichier de Types que Windows PowerShell peut utiliser pour identifier les membres de l’objet et un fichier de Format qui définit comment l’objet est affiché.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-294">When finished, create a Types file that Windows PowerShell can use to identify the members of the object and a Format file that defines how the object is displayed.</span></span> <span data-ttu-id="2b1f6-295">Pour plus d’informations, consultez [étendant les Types d’objets et de mise en forme](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-295">For more information about , see [Extending Object Types and Formatting](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="2b1f6-296">Construction du fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2b1f6-296">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="2b1f6-297">Consultez [comment inscrire les applets de commande, fournisseurs et héberger des Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-297">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="2b1f6-298">Test du fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2b1f6-298">Testing the Windows PowerShell provider</span></span>

<span data-ttu-id="2b1f6-299">Lorsque ce fournisseur d’élément de Windows PowerShell est enregistré avec Windows PowerShell, vous pouvez uniquement tester le basic et lecteur de fonctionnalité du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2b1f6-299">When this Windows PowerShell item provider is registered with Windows PowerShell, you can only test the basic and drive functionality of the provider.</span></span> <span data-ttu-id="2b1f6-300">Pour tester la manipulation d’éléments, vous devez également implémenter des fonctionnalités de conteneur décrites dans [implémentation d’un fournisseur de PowerShell de conteneur Windows](./creating-a-windows-powershell-container-provider.md).</span><span class="sxs-lookup"><span data-stu-id="2b1f6-300">To test the manipulation of items, you must also implement container functionality described in [Implementing a Container Windows PowerShell Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="2b1f6-301">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2b1f6-301">See Also</span></span>

[<span data-ttu-id="2b1f6-302">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="2b1f6-302">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="2b1f6-303">Guide du programmeur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2b1f6-303">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="2b1f6-304">Création de fournisseurs de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2b1f6-304">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="2b1f6-305">Conception du fournisseur de votre Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2b1f6-305">Designing Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="2b1f6-306">Extension des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="2b1f6-306">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="2b1f6-307">Fonctionnement de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2b1f6-307">How Windows PowerShell Works</span></span>](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58)

[<span data-ttu-id="2b1f6-308">Création d’un fournisseur de conteneur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2b1f6-308">Creating a Container Windows PowerShell provider</span></span>](./creating-a-windows-powershell-container-provider.md)

[<span data-ttu-id="2b1f6-309">Création d’un fournisseur de lecteur de PowerShell de Windows</span><span class="sxs-lookup"><span data-stu-id="2b1f6-309">Creating a Drive Windows PowerShell provider</span></span>](./creating-a-windows-powershell-drive-provider.md)

[<span data-ttu-id="2b1f6-310">Comment inscrire les applets de commande, fournisseurs et héberger des Applications</span><span class="sxs-lookup"><span data-stu-id="2b1f6-310">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)