---
title: Création d’un fournisseur de contenu PowerShell Windows | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- content providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], content provider
ms.assetid: 3da88ff9-c4c7-4ace-aa24-0a29c8cfa060
caps.latest.revision: 6
ms.openlocfilehash: 35c68a2b0f8c9bd1ed4fc54c41aa427ddd75907c
ms.sourcegitcommit: caac7d098a448232304c9d6728e7340ec7517a71
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/16/2019
ms.locfileid: "58056632"
---
# <a name="creating-a-windows-powershell-content-provider"></a><span data-ttu-id="11cbf-102">Création d’un fournisseur de contenu Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="11cbf-102">Creating a Windows PowerShell Content Provider</span></span>

<span data-ttu-id="11cbf-103">Cette rubrique décrit comment créer un fournisseur Windows PowerShell qui permet à l’utilisateur de manipuler le contenu des éléments dans un magasin de données.</span><span class="sxs-lookup"><span data-stu-id="11cbf-103">This topic describes how to create a Windows PowerShell provider that enables the user to manipulate the contents of the items in a data store.</span></span> <span data-ttu-id="11cbf-104">Par conséquent, un fournisseur qui permet de manipuler le contenu d’éléments est appelé un fournisseur de contenu Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="11cbf-104">As a consequence, a provider that can manipulate the contents of items is referred to as a Windows PowerShell content provider.</span></span>

> [!NOTE]
> <span data-ttu-id="11cbf-105">Vous pouvez télécharger le C# le fichier source (AccessDBSampleProvider06.cs) pour ce fournisseur en utilisant le Microsoft Windows Software Development Kit pour Windows Vista et les composants d’exécution .NET Framework 3.0.</span><span class="sxs-lookup"><span data-stu-id="11cbf-105">You can download the C# source file (AccessDBSampleProvider06.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="11cbf-106">Pour obtenir des instructions de téléchargement, consultez [comment PowerShell de Windows Installer et de télécharger le Kit de développement logiciel de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="11cbf-106">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="11cbf-107">Les fichiers source téléchargé sont disponibles dans le  **\<exemples PowerShell >** directory.</span><span class="sxs-lookup"><span data-stu-id="11cbf-107">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="11cbf-108">Pour plus d’informations sur les autres implémentations du fournisseur Windows PowerShell, consultez [conception de votre fournisseur Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="11cbf-108">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="11cbf-109">La liste suivante contient les sections de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="11cbf-109">The following list contains the sections in this topic.</span></span> <span data-ttu-id="11cbf-110">Si vous n’êtes pas familiarisé avec l’écriture d’un fournisseur de contenu Windows PowerShell, lisez ces sections dans l’ordre où ils apparaissent.</span><span class="sxs-lookup"><span data-stu-id="11cbf-110">If you are unfamiliar with writing a Windows PowerShell content provider, read these sections in the order that they appear.</span></span> <span data-ttu-id="11cbf-111">Toutefois, si vous êtes familiarisé avec l’écriture d’un fournisseur de contenu Windows PowerShell, accédez directement aux informations dont vous avez besoin.</span><span class="sxs-lookup"><span data-stu-id="11cbf-111">However, if you are familiar with writing a Windows PowerShell content provider, go directly to the information that you need.</span></span>

- [<span data-ttu-id="11cbf-112">Définition de la classe de fournisseur Windows PowerShell contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-112">Defining the Windows PowerShell Content Provider Class</span></span>](#Define-the-Windows-PowerShell-Content-Provider-Class)

- [<span data-ttu-id="11cbf-113">Définition des fonctionnalités de Base</span><span class="sxs-lookup"><span data-stu-id="11cbf-113">Defining Base Functionality</span></span>](#Define-Functionality-of-Base-Class)

- [<span data-ttu-id="11cbf-114">Implémentation d’un lecteur de contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-114">Implementing a Content Reader</span></span>](#Implementing-a-Content-Reader)

- [<span data-ttu-id="11cbf-115">Implémentation d’un Writer de contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-115">Implementing a Content Writer</span></span>](#Implementing-a-Content-Writer)

- [<span data-ttu-id="11cbf-116">Récupération du lecteur de contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-116">Retrieving the Content Reader</span></span>](#Retrieving-the-Content-Reader)

- [<span data-ttu-id="11cbf-117">Attachement des paramètres dynamiques à la `Get-Content` applet de commande</span><span class="sxs-lookup"><span data-stu-id="11cbf-117">Attaching Dynamic Parameters to the `Get-Content` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-Content-Cmdlet)

- [<span data-ttu-id="11cbf-118">Récupération de l’enregistreur de contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-118">Retrieving the Content Writer</span></span>](#Retrieving-the-Content-Writer)

- [<span data-ttu-id="11cbf-119">Attachement des paramètres dynamiques à la Add_Content et `Set-Content` applets de commande</span><span class="sxs-lookup"><span data-stu-id="11cbf-119">Attaching Dynamic Parameters to the Add_Content and `Set-Content` Cmdlets</span></span>](#Attaching-Dynamic-Parameters-to-the-Add-Content-and-Set-Content-Cmdlets)

- [<span data-ttu-id="11cbf-120">Effacement du contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-120">Clearing Content</span></span>](#Clearing-Content)

- [<span data-ttu-id="11cbf-121">Attachement des paramètres dynamiques à la `Clear-Content` applet de commande</span><span class="sxs-lookup"><span data-stu-id="11cbf-121">Attaching Dynamic Parameters to the  `Clear-Content` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Clear-Content-Cmdlet)

- [<span data-ttu-id="11cbf-122">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="11cbf-122">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="11cbf-123">Définition des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="11cbf-123">Defining Object Types and Formatting</span></span>](#defining-object-types-and-formatting)

- [<span data-ttu-id="11cbf-124">Construction du fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="11cbf-124">Building the Windows PowerShell provider</span></span>](#Building-the-Windows-PowerShell-Provider)

- [<span data-ttu-id="11cbf-125">Test du fournisseur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="11cbf-125">Testing the Windows PowerShell provider</span></span>](#Testing-the-Windows-PowerShell-Provider)

## <a name="define-the-windows-powershell-content-provider-class"></a><span data-ttu-id="11cbf-126">Définir la classe de fournisseur Windows PowerShell contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-126">Define the Windows PowerShell Content Provider Class</span></span>

<span data-ttu-id="11cbf-127">Un fournisseur de contenu Windows PowerShell doit créer une classe .NET qui prend en charge la [System.Management.Automation.Provider.Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider) interface.</span><span class="sxs-lookup"><span data-stu-id="11cbf-127">A Windows PowerShell content provider must create a .NET class that supports the [System.Management.Automation.Provider.Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider) interface.</span></span> <span data-ttu-id="11cbf-128">Voici la définition de classe pour le fournisseur d’éléments décrit dans cette section.</span><span class="sxs-lookup"><span data-stu-id="11cbf-128">Here is the class definition for the item provider described in this section.</span></span>

[!code-csharp[AccessDBProviderSample06.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L32-L33 "AccessDBProviderSample06.cs")]

<span data-ttu-id="11cbf-129">Notez que, dans cette définition, de la classe la [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribut inclut deux paramètres.</span><span class="sxs-lookup"><span data-stu-id="11cbf-129">Note that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="11cbf-130">Le premier paramètre spécifie un nom convivial pour le fournisseur qui est utilisé par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="11cbf-130">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="11cbf-131">Le deuxième paramètre spécifie les fonctionnalités spécifiques de Windows PowerShell que le fournisseur expose à l’exécution de Windows PowerShell au cours du traitement de commande.</span><span class="sxs-lookup"><span data-stu-id="11cbf-131">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="11cbf-132">Pour ce fournisseur, il n’existe aucun ajout capacités spécifiques de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="11cbf-132">For this provider, there are no added Windows PowerShell specific capabilities.</span></span>

## <a name="define-functionality-of-base-class"></a><span data-ttu-id="11cbf-133">Définir des fonctionnalités de classe de Base</span><span class="sxs-lookup"><span data-stu-id="11cbf-133">Define Functionality of Base Class</span></span>

<span data-ttu-id="11cbf-134">Comme décrit dans [fournisseur Design Your Windows PowerShell](./designing-your-windows-powershell-provider.md), le [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) classe est dérivée de plusieurs autres classes fourni fonctionnalités de l’autre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="11cbf-134">As described in [Design Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="11cbf-135">Un fournisseur de contenu Windows PowerShell, par conséquent, généralement définit toutes les fonctionnalités fournies par les classes.</span><span class="sxs-lookup"><span data-stu-id="11cbf-135">A Windows PowerShell content provider, therefore, typically defines all of the functionality provided by those classes.</span></span>

<span data-ttu-id="11cbf-136">Pour plus d’informations sur la façon d’implémenter des fonctionnalités permettant d’ajouter des informations d’initialisation spécifiques à la session et pour libérer les ressources utilisées par le fournisseur, consultez [création d’un fournisseur de PowerShell Windows base](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="11cbf-136">For more information about how to implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="11cbf-137">Toutefois, la plupart des fournisseurs, y compris le fournisseur décrit ici, peut utiliser l’implémentation par défaut de cette fonctionnalité est fournie par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="11cbf-137">However, most providers, including the provider described here, can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="11cbf-138">Pour accéder à la banque de données, le fournisseur doit implémenter les méthodes de la [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) classe de base.</span><span class="sxs-lookup"><span data-stu-id="11cbf-138">To access the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="11cbf-139">Pour plus d’informations sur l’implémentation de ces méthodes, consultez [création d’un fournisseur de lecteur Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="11cbf-139">For more information about implementing these methods, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="11cbf-140">Pour manipuler les éléments d’un magasin de données, telles que l’obtention de paramètre et effacement des éléments, le fournisseur doit implémenter les méthodes fournies par le [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) classe de base.</span><span class="sxs-lookup"><span data-stu-id="11cbf-140">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="11cbf-141">Pour plus d’informations sur l’implémentation de ces méthodes, consultez [création d’un fournisseur d’éléments de Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="11cbf-141">For more information about implementing these methods, see [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

<span data-ttu-id="11cbf-142">Pour travailler sur des magasins de données de plusieurs couches, le fournisseur doit implémenter les méthodes fournies par le [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) classe de base.</span><span class="sxs-lookup"><span data-stu-id="11cbf-142">To work on multi-layer data stores, the provider must implement the methods provided by the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="11cbf-143">Pour plus d’informations sur l’implémentation de ces méthodes, consultez [création d’un fournisseur de conteneur Windows PowerShell](./creating-a-windows-powershell-container-provider.md).</span><span class="sxs-lookup"><span data-stu-id="11cbf-143">For more information about implementing these methods, see [Creating a Windows PowerShell Container Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

<span data-ttu-id="11cbf-144">Pour prendre en charge les commandes récursives, les conteneurs imbriqués et les chemins d’accès relatifs, le fournisseur doit implémenter la [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) classe de base.</span><span class="sxs-lookup"><span data-stu-id="11cbf-144">To support recursive commands, nested containers, and relative paths, the provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class.</span></span> <span data-ttu-id="11cbf-145">En outre, ce fournisseur de contenu Windows PowerShell peut attache [System.Management.Automation.Provider.Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider) interface pour le [ System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) classe de base et doit donc implémenter les méthodes fournies par cette classe.</span><span class="sxs-lookup"><span data-stu-id="11cbf-145">In addition, this Windows PowerShell content provider can attaches [System.Management.Automation.Provider.Icontentcmdletprovider](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider) interface to the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class, and must therefore implement the methods provided by that class.</span></span> <span data-ttu-id="11cbf-146">Pour plus d’informations, consultez l’implémentation de ces méthodes, consultez [implémenter un fournisseur de PowerShell Navigation Windows](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="11cbf-146">For more information, see implementing those methods, see [Implement a Navigation Windows PowerShell Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

## <a name="implementing-a-content-reader"></a><span data-ttu-id="11cbf-147">Implémentation d’un lecteur de contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-147">Implementing a Content Reader</span></span>

<span data-ttu-id="11cbf-148">Pour lire le contenu à partir d’un élément, un fournisseur doit implémente une classe de lecteur de contenu qui dérive de [System.Management.Automation.Provider.Icontentreader](/dotnet/api/System.Management.Automation.Provider.IContentReader).</span><span class="sxs-lookup"><span data-stu-id="11cbf-148">To read content from an item, a provider must implements a content reader class that derives from [System.Management.Automation.Provider.Icontentreader](/dotnet/api/System.Management.Automation.Provider.IContentReader).</span></span> <span data-ttu-id="11cbf-149">Le lecteur de contenu pour ce fournisseur autorise l’accès au contenu d’une ligne dans une table de données.</span><span class="sxs-lookup"><span data-stu-id="11cbf-149">The content reader for this provider allows access to the contents of a row in a data table.</span></span> <span data-ttu-id="11cbf-150">La classe du lecteur de contenu définit un **en lecture** méthode qui Récupère les données à partir de la ligne indiquée et retourne une liste de ces données, un **recherche** méthode qui déplace le lecteur de contenu, un  **Fermer** méthode qui ferme le lecteur de contenu, et un **Dispose** (méthode).</span><span class="sxs-lookup"><span data-stu-id="11cbf-150">The content reader class defines a **Read** method that retrieves the data from the indicated row and returns a list representing that data, a **Seek** method that moves the content reader, a **Close** method that closes the content reader, and a **Dispose** method.</span></span>

[!code-csharp[AccessDBProviderSample06.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L2115-L2241 "AccessDBProviderSample06.cs")]

## <a name="implementing-a-content-writer"></a><span data-ttu-id="11cbf-151">Implémentation d’un Writer de contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-151">Implementing a Content Writer</span></span>

<span data-ttu-id="11cbf-152">Pour écrire du contenu à un élément, un fournisseur doit implémenter un contenu dérive de la classe du writer [System.Management.Automation.Provider.Icontentwriter](/dotnet/api/System.Management.Automation.Provider.IContentWriter).</span><span class="sxs-lookup"><span data-stu-id="11cbf-152">To write content to an item, a provider must implement a content writer class derives from [System.Management.Automation.Provider.Icontentwriter](/dotnet/api/System.Management.Automation.Provider.IContentWriter).</span></span> <span data-ttu-id="11cbf-153">Définit la classe de contenu writer un **écrire** méthode qui écrit le contenu de la ligne spécifiée, un **recherche** méthode qui déplace l’enregistreur de contenu, un **fermer** méthode ferme le writer de contenu et un **Dispose** (méthode).</span><span class="sxs-lookup"><span data-stu-id="11cbf-153">The content writer class defines a **Write** method that writes the specified row content, a **Seek** method that moves the content writer, a **Close** method that closes the content writer, and a **Dispose** method.</span></span>

[!code-csharp[AccessDBProviderSample06.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L2250-L2394 "AccessDBProviderSample06.cs")]

## <a name="retrieving-the-content-reader"></a><span data-ttu-id="11cbf-154">Récupération du lecteur de contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-154">Retrieving the Content Reader</span></span>

<span data-ttu-id="11cbf-155">Pour obtenir le contenu à partir d’un élément, le fournisseur doit implémenter la [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) pour prendre en charge la `Get-Content` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="11cbf-155">To get content from an item, the provider must implement the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) to support the `Get-Content` cmdlet.</span></span> <span data-ttu-id="11cbf-156">Cette méthode retourne le lecteur de contenu pour l’élément situé dans le chemin d’accès spécifié.</span><span class="sxs-lookup"><span data-stu-id="11cbf-156">This method returns the content reader for the item located at the specified path.</span></span> <span data-ttu-id="11cbf-157">L’objet de lecteur peut ensuite être ouvert pour lire le contenu.</span><span class="sxs-lookup"><span data-stu-id="11cbf-157">The reader object can then be opened to read the content.</span></span>

<span data-ttu-id="11cbf-158">Voici l’implémentation de [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) pour cette méthode pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="11cbf-158">Here is the implementation of [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) for this method for this provider.</span></span>

```csharp
public IContentReader GetContentReader(string path)
{
    string tableName;
    int rowNumber;

    PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

    if (type == PathType.Invalid)
    {
        ThrowTerminatingInvalidPathException(path);
    }
    else if (type == PathType.Row)
    {
        throw new InvalidOperationException("contents can be obtained only for tables");
    }

    return new AccessDBContentReader(path, this);
} // GetContentReader
```

[!code-csharp[AccessDBProviderSample06.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1829-L1846 "AccessDBProviderSample06.cs")]

#### <a name="things-to-remember-about-implementing-getcontentreader"></a><span data-ttu-id="11cbf-159">Points à retenir sur l’implémentation GetContentReader</span><span class="sxs-lookup"><span data-stu-id="11cbf-159">Things to Remember About Implementing GetContentReader</span></span>

<span data-ttu-id="11cbf-160">Les conditions suivantes peuvent s’appliquer à une implémentation de [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader):</span><span class="sxs-lookup"><span data-stu-id="11cbf-160">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader):</span></span>

- <span data-ttu-id="11cbf-161">Lorsque vous définissez la classe de fournisseur, un fournisseur de contenu Windows PowerShell peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)énumération.</span><span class="sxs-lookup"><span data-stu-id="11cbf-161">When defining the provider class, a Windows PowerShell content provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="11cbf-162">Dans ce cas, l’implémentation de la [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) méthode devez vous assurer que le chemin d’accès transmis à la méthode remplit les conditions de l’élément spécifié fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="11cbf-162">In these cases, the implementation of the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreader\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReader) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="11cbf-163">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriétés.</span><span class="sxs-lookup"><span data-stu-id="11cbf-163">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="11cbf-164">Par défaut, les substitutions de cette méthode ne doivent pas récupérer un lecteur pour les objets qui sont masqués à partir de l’utilisateur, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="11cbf-164">By default, overrides of this method should not retrieve a reader for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="11cbf-165">Une erreur doit être écrits si le chemin d’accès représente un élément est masqué pour l’utilisateur et [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) est défini sur `false`.</span><span class="sxs-lookup"><span data-stu-id="11cbf-165">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-content-cmdlet"></a><span data-ttu-id="11cbf-166">Attachement des paramètres dynamiques à l’applet de commande Get-Content</span><span class="sxs-lookup"><span data-stu-id="11cbf-166">Attaching Dynamic Parameters to the Get-Content Cmdlet</span></span>

<span data-ttu-id="11cbf-167">Le `Get-Content` applet de commande peut-être nécessiter des paramètres supplémentaires qui sont spécifiés de manière dynamique lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="11cbf-167">The `Get-Content` cmdlet might require additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="11cbf-168">Pour fournir ces paramètres dynamiques, le fournisseur de contenu de Windows PowerShell doit implémenter le [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreaderdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReaderDynamicParameters) (méthode).</span><span class="sxs-lookup"><span data-stu-id="11cbf-168">To provide these dynamic parameters, the Windows PowerShell content provider must implement the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentreaderdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentReaderDynamicParameters) method.</span></span> <span data-ttu-id="11cbf-169">Cette méthode récupère les paramètres dynamiques pour l’élément dans le chemin d’accès indiqué et retourne un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="11cbf-169">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="11cbf-170">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="11cbf-170">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="11cbf-171">Ce fournisseur de conteneur Windows PowerShell n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="11cbf-171">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="11cbf-172">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="11cbf-172">However, the following code is the default implementation of this method.</span></span>

```csharp
public object GetContentReaderDynamicParameters(string path)
{
    return null;
}
```

[!code-csharp[AccessDBProviderSample06.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1853-L1856 "AccessDBProviderSample06.cs")]

## <a name="retrieving-the-content-writer"></a><span data-ttu-id="11cbf-173">Récupération de l’enregistreur de contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-173">Retrieving the Content Writer</span></span>

<span data-ttu-id="11cbf-174">Pour écrire du contenu à un élément, le fournisseur doit implémenter la [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) pour prendre en charge la `Set-Content` et `Add-Content` applets de commande.</span><span class="sxs-lookup"><span data-stu-id="11cbf-174">To write content to an item, the provider must implement the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) to support the `Set-Content` and `Add-Content` cmdlets.</span></span> <span data-ttu-id="11cbf-175">Cette méthode retourne le writer de contenu pour l’élément situé dans le chemin d’accès spécifié.</span><span class="sxs-lookup"><span data-stu-id="11cbf-175">This method returns the content writer for the item located at the specified path.</span></span>

<span data-ttu-id="11cbf-176">Voici l’implémentation de [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) pour cette méthode.</span><span class="sxs-lookup"><span data-stu-id="11cbf-176">Here is the implementation of [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) for this method.</span></span>

```csharp
public IContentWriter GetContentWriter(string path)
{
    string tableName;
    int rowNumber;

    PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

    if (type == PathType.Invalid)
    {
        ThrowTerminatingInvalidPathException(path);
    }
    else if (type == PathType.Row)
    {
        throw new InvalidOperationException("contents can be added only to tables");
    }

    return new AccessDBContentWriter(path, this);
}
```

[!code-csharp[AccessDBProviderSample06.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1863-L1880 "AccessDBProviderSample06.cs")]

#### <a name="things-to-remember-about-implementing-getcontentwriter"></a><span data-ttu-id="11cbf-177">Points à retenir sur l’implémentation GetContentWriter</span><span class="sxs-lookup"><span data-stu-id="11cbf-177">Things to Remember About Implementing GetContentWriter</span></span>

<span data-ttu-id="11cbf-178">Les conditions suivantes peuvent s’appliquer à votre implémentation de [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter):</span><span class="sxs-lookup"><span data-stu-id="11cbf-178">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter):</span></span>

- <span data-ttu-id="11cbf-179">Lorsque vous définissez la classe de fournisseur, un fournisseur de contenu Windows PowerShell peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)énumération.</span><span class="sxs-lookup"><span data-stu-id="11cbf-179">When defining the provider class, a Windows PowerShell content provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="11cbf-180">Dans ce cas, l’implémentation de la [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) méthode devez vous assurer que le chemin d’accès transmis à la méthode remplit les conditions de l’élément spécifié fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="11cbf-180">In these cases, the implementation of the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriter\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriter) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="11cbf-181">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriétés.</span><span class="sxs-lookup"><span data-stu-id="11cbf-181">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="11cbf-182">Par défaut, les substitutions de cette méthode ne doivent pas récupérer un enregistreur pour les objets qui sont masqués à partir de l’utilisateur, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="11cbf-182">By default, overrides of this method should not retrieve a writer for objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="11cbf-183">Une erreur doit être écrits si le chemin d’accès représente un élément est masqué pour l’utilisateur et [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) est défini sur `false`.</span><span class="sxs-lookup"><span data-stu-id="11cbf-183">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="attaching-dynamic-parameters-to-the-add-content-and-set-content-cmdlets"></a><span data-ttu-id="11cbf-184">Attachement des paramètres dynamiques pour les applets de commande Add-Content et Set-Content</span><span class="sxs-lookup"><span data-stu-id="11cbf-184">Attaching Dynamic Parameters to the Add-Content and Set-Content Cmdlets</span></span>

<span data-ttu-id="11cbf-185">Le `Add-Content` et `Set-Content` applets de commande peut nécessiter des paramètres dynamiques supplémentaires qui sont ajoutés à un runtime.</span><span class="sxs-lookup"><span data-stu-id="11cbf-185">The `Add-Content` and `Set-Content` cmdlets might require additional dynamic parameters that are added a runtime.</span></span> <span data-ttu-id="11cbf-186">Pour fournir ces paramètres dynamiques, le fournisseur de contenu de Windows PowerShell doit implémenter le [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriterdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriterDynamicParameters) gérer ces (méthode) paramètres.</span><span class="sxs-lookup"><span data-stu-id="11cbf-186">To provide these dynamic parameters, the Windows PowerShell content provider must implement the [System.Management.Automation.Provider.Icontentcmdletprovider.Getcontentwriterdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.GetContentWriterDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="11cbf-187">Cette méthode récupère les paramètres dynamiques pour l’élément dans le chemin d’accès indiqué et retourne un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="11cbf-187">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="11cbf-188">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres aux applets de commande.</span><span class="sxs-lookup"><span data-stu-id="11cbf-188">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlets.</span></span>

<span data-ttu-id="11cbf-189">Ce fournisseur de conteneur Windows PowerShell n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="11cbf-189">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="11cbf-190">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="11cbf-190">However, the following code is the default implementation of this method.</span></span>

[!code-csharp[AccessDBProviderSample06.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1887-L1890 "AccessDBProviderSample06.cs")]

## <a name="clearing-content"></a><span data-ttu-id="11cbf-191">Effacement du contenu</span><span class="sxs-lookup"><span data-stu-id="11cbf-191">Clearing Content</span></span>

<span data-ttu-id="11cbf-192">Votre fournisseur de contenu d’implémente le [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) méthode à l’appui de la `Clear-Content` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="11cbf-192">Your content provider implements the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) method in support of the `Clear-Content` cmdlet.</span></span> <span data-ttu-id="11cbf-193">Cette méthode supprime le contenu de l’élément dans le chemin spécifié, mais toucher à l’élément.</span><span class="sxs-lookup"><span data-stu-id="11cbf-193">This method removes the contents of the item at the specified path, but leaves the item intact.</span></span>

<span data-ttu-id="11cbf-194">Voici l’implémentation de la [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) méthode pour ce fournisseur.</span><span class="sxs-lookup"><span data-stu-id="11cbf-194">Here is the implementation of the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) method for this provider.</span></span>

[!code-csharp[AccessDBProviderSample06.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1775-L1812 "AccessDBProviderSample06.cs")]

#### <a name="things-to-remember-about-implementing-clearcontent"></a><span data-ttu-id="11cbf-195">Points à retenir sur l’implémentation ClearContent</span><span class="sxs-lookup"><span data-stu-id="11cbf-195">Things to Remember About Implementing ClearContent</span></span>

<span data-ttu-id="11cbf-196">Les conditions suivantes peuvent s’appliquer à une implémentation de [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent):</span><span class="sxs-lookup"><span data-stu-id="11cbf-196">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent):</span></span>

- <span data-ttu-id="11cbf-197">Lorsque vous définissez la classe de fournisseur, un fournisseur de contenu Windows PowerShell peut déclarer des capacités du fournisseur de ExpandWildcards, filtre, Include ou Exclude, à partir de la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)énumération.</span><span class="sxs-lookup"><span data-stu-id="11cbf-197">When defining the provider class, a Windows PowerShell content provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="11cbf-198">Dans ce cas, l’implémentation de la [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) méthode devez vous assurer que le chemin d’accès transmis à la méthode remplit les conditions de l’élément spécifié fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="11cbf-198">In these cases, the implementation of the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="11cbf-199">Pour ce faire, la méthode doit accéder à la propriété appropriée, par exemple, le [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) et [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propriétés.</span><span class="sxs-lookup"><span data-stu-id="11cbf-199">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="11cbf-200">Par défaut, les substitutions de cette méthode ne doivent pas effacer le contenu des objets qui sont masqués à partir de l’utilisateur, sauf si le [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propriété est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="11cbf-200">By default, overrides of this method should not clear the contents of objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="11cbf-201">Une erreur doit être écrits si le chemin d’accès représente un élément est masqué pour l’utilisateur et [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) est défini sur `false`.</span><span class="sxs-lookup"><span data-stu-id="11cbf-201">An error should be written if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="11cbf-202">Votre implémentation de la [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) méthode doit appeler [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) et vérifier sa valeur de retour avant d’apporter des modifications au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="11cbf-202">Your implementation of the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="11cbf-203">Cette méthode est utilisée pour confirmer l’exécution d’une opération lorsqu’une modification est apportée au magasin de données, telles que l’effacement du contenu.</span><span class="sxs-lookup"><span data-stu-id="11cbf-203">This method is used to confirm execution of an operation when a change is made to the data store, such as clearing content.</span></span> <span data-ttu-id="11cbf-204">Le [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) méthode envoie le nom de la ressource à modifier à l’utilisateur, avec le runtime de Windows PowerShell de gestion des paramètres de ligne de commande ni préférence variables de déterminer ce qui doit être affiché.</span><span class="sxs-lookup"><span data-stu-id="11cbf-204">The [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) method sends the name of the resource to be changed to the user, with the Windows PowerShell runtime handling any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="11cbf-205">Après l’appel à [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) retourne `true`, le [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) méthode doit appeler la [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) (méthode).</span><span class="sxs-lookup"><span data-stu-id="11cbf-205">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontent\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContent) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="11cbf-206">Cette méthode envoie un message à l’utilisateur pour que les commentaires vérifier si l’opération doit être poursuivie.</span><span class="sxs-lookup"><span data-stu-id="11cbf-206">This method sends a message to the user to allow feedback to verify if the operation should be continued.</span></span> <span data-ttu-id="11cbf-207">L’appel à [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) permet une vérification supplémentaire pour les modifications du système potentiellement dangereux.</span><span class="sxs-lookup"><span data-stu-id="11cbf-207">The call to [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) allows an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-clear-content-cmdlet"></a><span data-ttu-id="11cbf-208">Attachement des paramètres dynamiques à l’applet de commande Clear-Content</span><span class="sxs-lookup"><span data-stu-id="11cbf-208">Attaching Dynamic Parameters to the Clear-Content Cmdlet</span></span>

<span data-ttu-id="11cbf-209">Le `Clear-Content` applet de commande peut-être nécessiter des paramètres dynamiques supplémentaires qui sont ajoutés lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="11cbf-209">The `Clear-Content` cmdlet might require additional dynamic parameters that are added at runtime.</span></span> <span data-ttu-id="11cbf-210">Pour fournir ces paramètres dynamiques, le fournisseur de contenu de Windows PowerShell doit implémenter le [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontentdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContentDynamicParameters) gérer ces (méthode) paramètres.</span><span class="sxs-lookup"><span data-stu-id="11cbf-210">To provide these dynamic parameters, the Windows PowerShell content provider must implement the [System.Management.Automation.Provider.Icontentcmdletprovider.Clearcontentdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.IContentCmdletProvider.ClearContentDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="11cbf-211">Cette méthode récupère les paramètres de l’article sur le chemin d’accès indiqué.</span><span class="sxs-lookup"><span data-stu-id="11cbf-211">This method retrieves the parameters for the item at the indicated path.</span></span> <span data-ttu-id="11cbf-212">Cette méthode récupère les paramètres dynamiques pour l’élément dans le chemin d’accès indiqué et retourne un objet qui a les propriétés et champs avec l’analyse des attributs similaires à une classe de l’applet de commande ou un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objet.</span><span class="sxs-lookup"><span data-stu-id="11cbf-212">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="11cbf-213">Le runtime Windows PowerShell utilise l’objet retourné pour ajouter les paramètres à l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="11cbf-213">The Windows PowerShell runtime uses the returned object to add the parameters to the cmdlet.</span></span>

<span data-ttu-id="11cbf-214">Ce fournisseur de conteneur Windows PowerShell n’implémente pas cette méthode.</span><span class="sxs-lookup"><span data-stu-id="11cbf-214">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="11cbf-215">Toutefois, le code suivant est l’implémentation par défaut de cette méthode.</span><span class="sxs-lookup"><span data-stu-id="11cbf-215">However, the following code is the default implementation of this method.</span></span>

```csharp
public object ClearContentDynamicParameters(string path)
{
    return null;
}
```

[!code-csharp[AccessDBProviderSample06.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample06/AccessDBProviderSample06.cs#L1819-L1822 "AccessDBProviderSample06.cs")]

## <a name="code-sample"></a><span data-ttu-id="11cbf-216">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="11cbf-216">Code Sample</span></span>

<span data-ttu-id="11cbf-217">Pour l’exemple de code complet, consultez [exemple de Code AccessDbProviderSample06](./accessdbprovidersample06-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="11cbf-217">For complete sample code, see [AccessDbProviderSample06 Code Sample](./accessdbprovidersample06-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="11cbf-218">Définition des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="11cbf-218">Defining Object Types and Formatting</span></span>

<span data-ttu-id="11cbf-219">Lorsque vous écrivez un fournisseur, il peut être nécessaire d’ajouter des membres à des objets existants ou définir de nouveaux objets.</span><span class="sxs-lookup"><span data-stu-id="11cbf-219">When writing a provider, it may be necessary to add members to existing objects or define new objects.</span></span> <span data-ttu-id="11cbf-220">Dans ce cas, vous devez créer un fichier de Types que Windows PowerShell peut utiliser pour identifier les membres de l’objet et un fichier de Format qui définit comment l’objet est affiché.</span><span class="sxs-lookup"><span data-stu-id="11cbf-220">When this is done, you must create a Types file that Windows PowerShell can use to identify the members of the object and a Format file that defines how the object is displayed.</span></span> <span data-ttu-id="11cbf-221">Pour plus d’informations, consultez [étendant les Types d’objets et de mise en forme](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="11cbf-221">For more information, see [Extending Object Types and Formatting](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="11cbf-222">Construction du fournisseur PowerShell de Windows</span><span class="sxs-lookup"><span data-stu-id="11cbf-222">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="11cbf-223">Consultez [comment inscrire les applets de commande, fournisseurs et héberger des Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="11cbf-223">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="11cbf-224">Test du fournisseur PowerShell de Windows</span><span class="sxs-lookup"><span data-stu-id="11cbf-224">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="11cbf-225">Lorsque votre fournisseur de Windows PowerShell a été enregistré avec Windows PowerShell, vous pouvez le tester en exécutant les applets de commande pris en charge sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="11cbf-225">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="11cbf-226">Par exemple, tester l’exemple de fournisseur de contenu.</span><span class="sxs-lookup"><span data-stu-id="11cbf-226">For example, test the sample content provider.</span></span>

<span data-ttu-id="11cbf-227">Utilisez le `Get-Content` applet de commande pour récupérer le contenu de l’élément spécifié dans la table de base de données sur le chemin d’accès spécifié par le `Path` paramètre.</span><span class="sxs-lookup"><span data-stu-id="11cbf-227">Use the `Get-Content` cmdlet to retrieve the contents of specified item in the database table at the path specified by the `Path` parameter.</span></span> <span data-ttu-id="11cbf-228">Le `ReadCount` paramètre spécifie le nombre d’éléments pour le lecteur de contenu défini à lire (par défaut 1).</span><span class="sxs-lookup"><span data-stu-id="11cbf-228">The `ReadCount` parameter specifies the number of items for the defined content reader to read (default 1).</span></span> <span data-ttu-id="11cbf-229">Avec l’entrée de commande suivante, l’applet de commande extrait les deux lignes (éléments) de la table et affiche leur contenu.</span><span class="sxs-lookup"><span data-stu-id="11cbf-229">With the following command entry, the cmdlet retrieves two rows (items) from the table and displays their contents.</span></span> <span data-ttu-id="11cbf-230">Notez que l’exemple suivant utilise une base de données Access fictive.</span><span class="sxs-lookup"><span data-stu-id="11cbf-230">Note that the following example output uses a fictitious Access database.</span></span>

```powershell
Get-Content -Path mydb:\Customers -ReadCount 2
```

```output
ID        : 1
FirstName : Eric
LastName  : Gruber
Email     : ericgruber@fabrikam.com
Title     : President
Company   : Fabrikam
WorkPhone : (425) 555-0100
Address   : 4567 Main Street
City      : Buffalo
State     : NY
Zip       : 98052
Country   : USA
ID        : 2
FirstName : Eva
LastName  : Corets
Email     : evacorets@cohowinery.com
Title     : Sales Representative
Company   : Coho Winery
WorkPhone : (360) 555-0100
Address   : 8910 Main Street
City      : Cabmerlot
State     : WA
Zip       : 98089
Country   : USA
```

## <a name="see-also"></a><span data-ttu-id="11cbf-231">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="11cbf-231">See Also</span></span>

[<span data-ttu-id="11cbf-232">Création de fournisseurs de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="11cbf-232">Creating Windows PowerShell providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="11cbf-233">Fournisseur de votre Windows PowerShell de conception</span><span class="sxs-lookup"><span data-stu-id="11cbf-233">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="11cbf-234">Extension des Types d’objets et mise en forme</span><span class="sxs-lookup"><span data-stu-id="11cbf-234">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="11cbf-235">Implémenter un fournisseur de Navigation Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="11cbf-235">Implement a Navigation Windows PowerShell provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

[<span data-ttu-id="11cbf-236">Comment inscrire les applets de commande, fournisseurs et héberger des Applications</span><span class="sxs-lookup"><span data-stu-id="11cbf-236">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="11cbf-237">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="11cbf-237">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="11cbf-238">Guide du programmeur Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="11cbf-238">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)
