---
title: Instructions de développement requises | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 41d2b308-a36a-496f-8542-666b6a21eedc
caps.latest.revision: 19
ms.openlocfilehash: e68e43a91f9139e8d3dc636b5740121515aab2e6
ms.sourcegitcommit: 5a004064f33acc0145ccd414535763e95f998c89
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/23/2019
ms.locfileid: "69986667"
---
# <a name="required-development-guidelines"></a><span data-ttu-id="2a8fc-102">Instructions dont le suivi est impératif pour le développement</span><span class="sxs-lookup"><span data-stu-id="2a8fc-102">Required Development Guidelines</span></span>

<span data-ttu-id="2a8fc-103">Les instructions suivantes doivent être suivies lors de l’écriture de vos applets de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-103">The following guidelines must be followed when you write your cmdlets.</span></span> <span data-ttu-id="2a8fc-104">Elles sont réparties en instructions pour concevoir des applets de commande et des instructions pour l’écriture de votre code d’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="2a8fc-105">Si vous ne suivez pas ces instructions, vos applets de commande peuvent échouer et vos utilisateurs peuvent avoir une expérience médiocre lorsqu’ils utilisent vos applets de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-105">If you do not follow these guidelines, your cmdlets could fail, and your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="in-this-topic"></a><span data-ttu-id="2a8fc-106">Dans cette rubrique</span><span class="sxs-lookup"><span data-stu-id="2a8fc-106">In this Topic</span></span>

### <a name="design-guidelines"></a><span data-ttu-id="2a8fc-107">Instructions de conception</span><span class="sxs-lookup"><span data-stu-id="2a8fc-107">Design Guidelines</span></span>

- [<span data-ttu-id="2a8fc-108">Utiliser uniquement les verbes approuvés (RD01)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-108">Use Only Approved Verbs (RD01)</span></span>](./required-development-guidelines.md#use-only-approved-verbs-rd01)

- [<span data-ttu-id="2a8fc-109">Noms des applets de commande: Caractères qui ne peuvent pas être utilisés (RD02)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-109">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>](./required-development-guidelines.md#cmdlet-names-characters-that-cannot-be-used-rd02)

- [<span data-ttu-id="2a8fc-110">Noms de paramètres qui ne peuvent pas être utilisés (RD03)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-110">Parameters Names that cannot be Used (RD03)</span></span>](./required-development-guidelines.md#parameters-names-that-cannot-be-used-rd03)

- [<span data-ttu-id="2a8fc-111">Demandes de confirmation de support (RD04)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-111">Support Confirmation Requests (RD04)</span></span>](./required-development-guidelines.md#support-confirmation-requests-rd04)

- [<span data-ttu-id="2a8fc-112">Paramètre force de support pour les sessions interactives (RD05)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-112">Support Force Parameter for Interactive Sessions (RD05)</span></span>](./required-development-guidelines.md#support-force-parameter-for-interactive-sessions-rd05)

- [<span data-ttu-id="2a8fc-113">Objets de sortie de document (RD06)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-113">Document Output Objects (RD06)</span></span>](./required-development-guidelines.md#document-output-objects-rd06)

### <a name="code-guidelines"></a><span data-ttu-id="2a8fc-114">Instructions de code</span><span class="sxs-lookup"><span data-stu-id="2a8fc-114">Code Guidelines</span></span>

- [<span data-ttu-id="2a8fc-115">Dérivation à partir de l’applet de commande ou des classes PSCmdlet (RC01)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-115">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>](./required-development-guidelines.md#derive-from-the-cmdlet-or-pscmdlet-classes-rc01)

- [<span data-ttu-id="2a8fc-116">Spécifier l’attribut d’applet de commande (RC02)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-116">Specify the Cmdlet Attribute (RC02)</span></span>](./required-development-guidelines.md#specify-the-cmdlet-attribute-rc02)

- [<span data-ttu-id="2a8fc-117">Remplacer une méthode de traitement d’entrée (RC03)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-117">Override an Input Processing Method (RC03)</span></span>](./required-development-guidelines.md#override-an-input-processing-method-rc03)

- [<span data-ttu-id="2a8fc-118">Spécifier l’attribut OutputType (RC04)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-118">Specify the OutputType Attribute (RC04)</span></span>](./required-development-guidelines.md#specify-the-outputtype-attribute-rc04)

- [<span data-ttu-id="2a8fc-119">Ne pas conserver les descripteurs des objets de sortie (RC05)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-119">Do Not Retain Handles to Output Objects (RC05)</span></span>](./required-development-guidelines.md#do-not-retain-handles-to-output-objects-rc05)

- [<span data-ttu-id="2a8fc-120">Gérer les erreurs de façon robuste (RC06)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-120">Handle Errors Robustly (RC06)</span></span>](./required-development-guidelines.md#handle-errors-robustly-rc06)

- [<span data-ttu-id="2a8fc-121">Utiliser un module Windows PowerShell pour déployer vos applets de commande (RC07)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-121">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>](./required-development-guidelines.md#use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07)

## <a name="design-guidelines"></a><span data-ttu-id="2a8fc-122">Instructions de conception</span><span class="sxs-lookup"><span data-stu-id="2a8fc-122">Design Guidelines</span></span>

<span data-ttu-id="2a8fc-123">Les instructions suivantes doivent être suivies lors de la conception des applets de commande pour garantir une expérience utilisateur cohérente entre l’utilisation de vos applets de commande et d’autres applets de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-123">The following guidelines must be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="2a8fc-124">Lorsque vous trouvez une instruction de conception qui s’applique à votre situation, veillez à consulter les instructions de code pour obtenir des instructions similaires.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-124">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-only-approved-verbs-rd01"></a><span data-ttu-id="2a8fc-125">Utiliser uniquement les verbes approuvés (RD01)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-125">Use Only Approved Verbs (RD01)</span></span>

<span data-ttu-id="2a8fc-126">Le verbe spécifié dans l’attribut d’applet de commande doit provenir du jeu de verbes reconnu fourni par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-126">The verb specified in the Cmdlet attribute must come from the recognized set of verbs provided by Windows PowerShell.</span></span> <span data-ttu-id="2a8fc-127">Il ne doit pas s’agir de l’un des synonymes interdits.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-127">It must not be one of the prohibited synonyms.</span></span> <span data-ttu-id="2a8fc-128">Utilisez les chaînes constantes définies par les énumérations suivantes pour spécifier des verbes d’applet de commande:</span><span class="sxs-lookup"><span data-stu-id="2a8fc-128">Use the constant strings that are defined by the following enumerations to specify cmdlet verbs:</span></span>

- [<span data-ttu-id="2a8fc-129">System. Management. Automation. VerbsCommon</span><span class="sxs-lookup"><span data-stu-id="2a8fc-129">System.Management.Automation.VerbsCommon</span></span>](/dotnet/api/System.Management.Automation.VerbsCommon)

- [<span data-ttu-id="2a8fc-130">System. Management. Automation. VerbsCommunications</span><span class="sxs-lookup"><span data-stu-id="2a8fc-130">System.Management.Automation.VerbsCommunications</span></span>](/dotnet/api/System.Management.Automation.VerbsCommunications)

- [<span data-ttu-id="2a8fc-131">System. Management. Automation. VerbsData</span><span class="sxs-lookup"><span data-stu-id="2a8fc-131">System.Management.Automation.VerbsData</span></span>](/dotnet/api/System.Management.Automation.VerbsData)

- [<span data-ttu-id="2a8fc-132">System. Management. Automation. VerbsDiagnostic</span><span class="sxs-lookup"><span data-stu-id="2a8fc-132">System.Management.Automation.VerbsDiagnostic</span></span>](/dotnet/api/System.Management.Automation.VerbsDiagnostic)

- [<span data-ttu-id="2a8fc-133">System. Management. Automation. VerbsLifeCycle</span><span class="sxs-lookup"><span data-stu-id="2a8fc-133">System.Management.Automation.VerbsLifeCycle</span></span>](/dotnet/api/System.Management.Automation.VerbsLifeCycle)

- [<span data-ttu-id="2a8fc-134">System. Management. Automation. VerbsSecurity</span><span class="sxs-lookup"><span data-stu-id="2a8fc-134">System.Management.Automation.VerbsSecurity</span></span>](/dotnet/api/System.Management.Automation.VerbsSecurity)

- [<span data-ttu-id="2a8fc-135">System. Management. Automation. VerbsOther</span><span class="sxs-lookup"><span data-stu-id="2a8fc-135">System.Management.Automation.VerbsOther</span></span>](/dotnet/api/System.Management.Automation.VerbsOther)

<span data-ttu-id="2a8fc-136">Pour plus d’informations sur les noms de verbe approuvés, consultez verbes d' [applet](./approved-verbs-for-windows-powershell-commands.md)de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-136">For more information about the approved verb names, see [Cmdlet Verbs](./approved-verbs-for-windows-powershell-commands.md).</span></span>

<span data-ttu-id="2a8fc-137">Les utilisateurs ont besoin d’un ensemble de noms d’applets de commande détectables et attendus.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-137">Users need a set of discoverable and expected cmdlet names.</span></span> <span data-ttu-id="2a8fc-138">Utilisez le verbe approprié pour permettre à l’utilisateur d’effectuer une évaluation rapide de ce que fait une applet de commande et de découvrir facilement les fonctionnalités du système.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-138">Use the appropriate verb so that the user can make a quick assessment of what a cmdlet does and to easily discover the capabilities of the system.</span></span> <span data-ttu-id="2a8fc-139">Par exemple, la commande de ligne de commande suivante obtient une liste de toutes les commandes du système dont les noms commencent par «Start» `get-command start-*`:.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-139">For example, the following command-line command gets a list of all the commands on the system whose names begin with "start": `get-command start-*`.</span></span> <span data-ttu-id="2a8fc-140">Utilisez les noms de vos applets de commande pour différencier vos applets de commande des autres applets de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-140">Use the nouns in your cmdlets to differentiate your cmdlets from other cmdlets.</span></span> <span data-ttu-id="2a8fc-141">Le nom indique la ressource sur laquelle l’opération sera effectuée.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-141">The noun indicates the resource on which the operation will be performed.</span></span> <span data-ttu-id="2a8fc-142">L’opération elle-même est représentée par le verbe.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-142">The operation itself is represented by the verb.</span></span>

### <a name="cmdlet-names-characters-that-cannot-be-used-rd02"></a><span data-ttu-id="2a8fc-143">Noms des applets de commande: Caractères qui ne peuvent pas être utilisés (RD02)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-143">Cmdlet Names: Characters that cannot be Used (RD02)</span></span>

<span data-ttu-id="2a8fc-144">Lorsque vous nommez des applets de commande, n’utilisez pas les caractères spéciaux suivants.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-144">When you name cmdlets, do not use any of the following special characters.</span></span>

|<span data-ttu-id="2a8fc-145">Caractère</span><span class="sxs-lookup"><span data-stu-id="2a8fc-145">Character</span></span>|<span data-ttu-id="2a8fc-146">Name</span><span class="sxs-lookup"><span data-stu-id="2a8fc-146">Name</span></span>|
|---------------|----------|
|#|<span data-ttu-id="2a8fc-147">signe dièse</span><span class="sxs-lookup"><span data-stu-id="2a8fc-147">number sign</span></span>|
|<span data-ttu-id="2a8fc-148">.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-148">,</span></span>|<span data-ttu-id="2a8fc-149">point</span><span class="sxs-lookup"><span data-stu-id="2a8fc-149">comma</span></span>|
|<span data-ttu-id="2a8fc-150">()</span><span class="sxs-lookup"><span data-stu-id="2a8fc-150">()</span></span>|<span data-ttu-id="2a8fc-151">parenthèses</span><span class="sxs-lookup"><span data-stu-id="2a8fc-151">parentheses</span></span>|
|{}|<span data-ttu-id="2a8fc-152">accolades</span><span class="sxs-lookup"><span data-stu-id="2a8fc-152">braces</span></span>|
|<span data-ttu-id="2a8fc-153">[]</span><span class="sxs-lookup"><span data-stu-id="2a8fc-153">[]</span></span>|<span data-ttu-id="2a8fc-154">crochets</span><span class="sxs-lookup"><span data-stu-id="2a8fc-154">brackets</span></span>|
|&|<span data-ttu-id="2a8fc-155">reprises</span><span class="sxs-lookup"><span data-stu-id="2a8fc-155">ampersand</span></span>|
|-|<span data-ttu-id="2a8fc-156">Note du trait d’Union **:**  Le trait d’Union peut être utilisé pour séparer le verbe du nom, mais il ne peut pas être utilisé dans le substantif ou dans le verbe.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-156">hyphen **Note:**  The hyphen can be used to separate the verb from the noun, but it cannot be used within the noun or within the verb.</span></span>|
|/|<span data-ttu-id="2a8fc-157">barre oblique</span><span class="sxs-lookup"><span data-stu-id="2a8fc-157">slash mark</span></span>|
|<span data-ttu-id="2a8fc-158">\\| barre oblique inverse</span><span class="sxs-lookup"><span data-stu-id="2a8fc-158">\\|backslash</span></span>|
|$|<span data-ttu-id="2a8fc-159">signe dollar</span><span class="sxs-lookup"><span data-stu-id="2a8fc-159">dollar sign</span></span>|
|^|<span data-ttu-id="2a8fc-160">signe insertion</span><span class="sxs-lookup"><span data-stu-id="2a8fc-160">caret</span></span>|
|<span data-ttu-id="2a8fc-161">;</span><span class="sxs-lookup"><span data-stu-id="2a8fc-161">;</span></span>|<span data-ttu-id="2a8fc-162">virgule</span><span class="sxs-lookup"><span data-stu-id="2a8fc-162">semicolon</span></span>|
|<span data-ttu-id="2a8fc-163">:</span><span class="sxs-lookup"><span data-stu-id="2a8fc-163">:</span></span>|<span data-ttu-id="2a8fc-164">signe</span><span class="sxs-lookup"><span data-stu-id="2a8fc-164">colon</span></span>|
|<span data-ttu-id="2a8fc-165">"</span><span class="sxs-lookup"><span data-stu-id="2a8fc-165">"</span></span>|<span data-ttu-id="2a8fc-166">guillemet double</span><span class="sxs-lookup"><span data-stu-id="2a8fc-166">double quotation mark</span></span>|
|<span data-ttu-id="2a8fc-167">'</span><span class="sxs-lookup"><span data-stu-id="2a8fc-167">'</span></span>|<span data-ttu-id="2a8fc-168">guillemet simple</span><span class="sxs-lookup"><span data-stu-id="2a8fc-168">single quotation mark</span></span>|
|<>|<span data-ttu-id="2a8fc-169">chevrons</span><span class="sxs-lookup"><span data-stu-id="2a8fc-169">angle brackets</span></span>|
|<span data-ttu-id="2a8fc-170">&#124;</span><span class="sxs-lookup"><span data-stu-id="2a8fc-170">&#124;</span></span>|<span data-ttu-id="2a8fc-171">barre verticale</span><span class="sxs-lookup"><span data-stu-id="2a8fc-171">vertical bar</span></span>|
|<span data-ttu-id="2a8fc-172">?</span><span class="sxs-lookup"><span data-stu-id="2a8fc-172">?</span></span>|<span data-ttu-id="2a8fc-173">point d’interrogation</span><span class="sxs-lookup"><span data-stu-id="2a8fc-173">question mark</span></span>|
|@|<span data-ttu-id="2a8fc-174">arobase</span><span class="sxs-lookup"><span data-stu-id="2a8fc-174">at sign</span></span>|
|`|<span data-ttu-id="2a8fc-175">cycle d’arrière-plan (accent grave)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-175">back tick (grave accent)</span></span>|
|*|<span data-ttu-id="2a8fc-176">sert</span><span class="sxs-lookup"><span data-stu-id="2a8fc-176">asterisk</span></span>|
|%|<span data-ttu-id="2a8fc-177">signe de pourcentage</span><span class="sxs-lookup"><span data-stu-id="2a8fc-177">percent sign</span></span>|
|+|<span data-ttu-id="2a8fc-178">signe plus</span><span class="sxs-lookup"><span data-stu-id="2a8fc-178">plus sign</span></span>|
|=|<span data-ttu-id="2a8fc-179">signe égal</span><span class="sxs-lookup"><span data-stu-id="2a8fc-179">equals sign</span></span>|
|~|<span data-ttu-id="2a8fc-180">surmonté</span><span class="sxs-lookup"><span data-stu-id="2a8fc-180">tilde</span></span>|

### <a name="parameters-names-that-cannot-be-used-rd03"></a><span data-ttu-id="2a8fc-181">Noms de paramètres qui ne peuvent pas être utilisés (RD03)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-181">Parameters Names that cannot be Used (RD03)</span></span>

<span data-ttu-id="2a8fc-182">Windows PowerShell fournit un ensemble commun de paramètres à toutes les applets de commande, ainsi que des paramètres supplémentaires qui sont ajoutés dans des situations spécifiques.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-182">Windows PowerShell provides a common set a parameters to all cmdlets plus additional parameters that are added in specific situations.</span></span> <span data-ttu-id="2a8fc-183">Lorsque vous concevez vos propres applets de commande, vous ne pouvez pas utiliser les noms suivants: Confirm, Debug, ErrorAction, ErrorVariable, unbuffer, unvariable, WarningAction, WarningVariable, WhatIf, UseTransaction et Verbose.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-183">When designing your own cmdlets you cannot use the following names: Confirm, Debug, ErrorAction, ErrorVariable, OutBuffer, OutVariable, WarningAction, WarningVariable, WhatIf, UseTransaction, and Verbose.</span></span> <span data-ttu-id="2a8fc-184">Pour plus d’informations sur ces paramètres, consultez [noms de paramètres communs](./common-parameter-names.md).</span><span class="sxs-lookup"><span data-stu-id="2a8fc-184">For more information about these parameters, see [Common Parameter Names](./common-parameter-names.md).</span></span>

### <a name="support-confirmation-requests-rd04"></a><span data-ttu-id="2a8fc-185">Demandes de confirmation de support (RD04)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-185">Support Confirmation Requests (RD04)</span></span>

<span data-ttu-id="2a8fc-186">Pour les cmdlets qui effectuent une opération qui modifie le système, ils doivent appeler la méthode [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) pour demander confirmation et, dans certains cas, appeler l' [applet de commande Méthode System. Management. Automation. applet de commande. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) .</span><span class="sxs-lookup"><span data-stu-id="2a8fc-186">For cmdlets that perform an operation that modifies the system, they should call the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method to request confirmation, and in special cases call the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method.</span></span> <span data-ttu-id="2a8fc-187">(La méthode [System. Management. Automation. applet de commande. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) doit être appelée uniquement après l’appel de la méthode [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) .)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-187">(The [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method should be called only after the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method is called.)</span></span>

<span data-ttu-id="2a8fc-188">Pour effectuer ces appels, l’applet de commande doit spécifier qu’elle prend en charge `SupportsShouldProcess` les demandes de confirmation en définissant le mot clé de l’attribut d’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-188">To make these calls the cmdlet must specify that it supports confirmation requests by setting the `SupportsShouldProcess` keyword of the Cmdlet attribute.</span></span> <span data-ttu-id="2a8fc-189">Pour plus d’informations sur la définition de cet attribut, consultez [déclaration d’attribut d’applet](./cmdlet-attribute-declaration.md)de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-189">For more information about setting this attribute, see [Cmdlet Attribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

> [!NOTE]
> <span data-ttu-id="2a8fc-190">Si l’attribut d’applet de commande de la classe d’applet de commande indique que l’applet de commande prend en charge les appels à la méthode [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) et que l’applet de commande ne parvient pas à appeler l' [applet de commande Méthode System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) , l’utilisateur peut modifier le système de manière inattendue.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-190">If the Cmdlet attribute of the cmdlet class indicates that the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, and the cmdlet fails to make the call to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, the user could modify the system unexpectedly.</span></span>

<span data-ttu-id="2a8fc-191">Utilisez la méthode [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) pour toute modification du système.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-191">Use the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method for any system modification.</span></span> <span data-ttu-id="2a8fc-192">Une préférence de l’utilisateur `WhatIf` et le paramètre contrôlent la méthode [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) .</span><span class="sxs-lookup"><span data-stu-id="2a8fc-192">A user preference and the `WhatIf` parameter control the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="2a8fc-193">En revanche, l’appel [System. Management. Automation. applet de commande. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) effectue une vérification supplémentaire pour les modifications potentiellement dangereuses.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-193">In contrast, the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) call performs an additional check for potentially dangerous modifications.</span></span> <span data-ttu-id="2a8fc-194">Cette méthode n’est pas contrôlée par une préférence utilisateur ni `WhatIf` par le paramètre.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-194">This method is not controlled by any user preference or the `WhatIf` parameter.</span></span> <span data-ttu-id="2a8fc-195">Si votre applet de commande appelle la méthode [System. Management. Automation. applet de commande. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) , `Force` elle doit avoir un paramètre qui ignore les appels à ces deux méthodes et qui poursuit l’opération.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-195">If your cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method, it should have a `Force` parameter that bypasses the calls to these two methods and that proceeds with the operation.</span></span> <span data-ttu-id="2a8fc-196">C’est important, car cela permet d’utiliser votre applet de commande dans des hôtes et des scripts non interactifs.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-196">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span>

<span data-ttu-id="2a8fc-197">Si vos applets de commande prennent en charge ces appels, l’utilisateur peut déterminer si l’action doit réellement être effectuée.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-197">If your cmdlets support these calls, the user can determine whether the action should actually be performed.</span></span> <span data-ttu-id="2a8fc-198">Par exemple, l’applet de commande [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) appelle la méthode [System. Management. Automation. applet de commande. ShouldContinue \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) avant d’arrêter un ensemble de processus critiques, y compris les processus System, Winlogon et spoolsv.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-198">For example, the [Stop-Process](/powershell/module/microsoft.powershell.management/stop-process) cmdlet calls the [System.Management.Automation.Cmdlet.ShouldContinue\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) method before it stops a set of critical processes, including the System, Winlogon, and Spoolsv processes.</span></span>

<span data-ttu-id="2a8fc-199">Pour plus d’informations sur la prise en charge de ces méthodes, consultez [demande de confirmation](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="2a8fc-199">For more information about supporting these methods, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="support-force-parameter-for-interactive-sessions-rd05"></a><span data-ttu-id="2a8fc-200">Paramètre force de support pour les sessions interactives (RD05)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-200">Support Force Parameter for Interactive Sessions (RD05)</span></span>

<span data-ttu-id="2a8fc-201">Si votre applet de commande est utilisée de manière interactive, fournissez toujours un paramètre force pour remplacer les actions interactives, telles que les invites ou la lecture des lignes d’entrée.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-201">If your cmdlet is used interactively, always provide a Force parameter to override the interactive actions, such as prompts or reading lines of input).</span></span> <span data-ttu-id="2a8fc-202">C’est important, car cela permet d’utiliser votre applet de commande dans des hôtes et des scripts non interactifs.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-202">This is important because it allows your cmdlet to be used in non-interactive scripts and hosts.</span></span> <span data-ttu-id="2a8fc-203">Les méthodes suivantes peuvent être implémentées par un hôte interactif.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-203">The following methods can be implemented by an interactive host.</span></span>

- [<span data-ttu-id="2a8fc-204">System. Management. Automation. Host. PSHostUserInterface. prompt \*</span><span class="sxs-lookup"><span data-stu-id="2a8fc-204">System.Management.Automation.Host.PSHostUserInterface.Prompt\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.Prompt)

- [<span data-ttu-id="2a8fc-205">System. Management. Automation. Host. Pshostuserinterface. PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="2a8fc-205">System.Management.Automation.Host.Pshostuserinterface.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForChoice)

- [<span data-ttu-id="2a8fc-206">System. Management. Automation. Host. Ihostuisupportsmultiplechoiceselection. PromptForChoice</span><span class="sxs-lookup"><span data-stu-id="2a8fc-206">System.Management.Automation.Host.Ihostuisupportsmultiplechoiceselection.PromptForChoice</span></span>](/dotnet/api/System.Management.Automation.Host.IHostUISupportsMultipleChoiceSelection.PromptForChoice)

- [<span data-ttu-id="2a8fc-207">System. Management. Automation. Host. Pshostuserinterface. PromptForCredential \*</span><span class="sxs-lookup"><span data-stu-id="2a8fc-207">System.Management.Automation.Host.Pshostuserinterface.PromptForCredential\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.PromptForCredential)

- [<span data-ttu-id="2a8fc-208">System. Management. Automation. Host. Pshostuserinterface. ReadLine \*</span><span class="sxs-lookup"><span data-stu-id="2a8fc-208">System.Management.Automation.Host.Pshostuserinterface.ReadLine\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLine)

- [<span data-ttu-id="2a8fc-209">System. Management. Automation. Host. Pshostuserinterface. ReadLineAsSecureString \*</span><span class="sxs-lookup"><span data-stu-id="2a8fc-209">System.Management.Automation.Host.Pshostuserinterface.ReadLineAsSecureString\*</span></span>](/dotnet/api/System.Management.Automation.Host.PSHostUserInterface.ReadLineAsSecureString)

### <a name="document-output-objects-rd06"></a><span data-ttu-id="2a8fc-210">Objets de sortie de document (RD06)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-210">Document Output Objects (RD06)</span></span>

<span data-ttu-id="2a8fc-211">Windows PowerShell utilise les objets qui sont écrits dans le pipeline.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-211">Windows PowerShell uses the objects that are written to the pipeline.</span></span> <span data-ttu-id="2a8fc-212">Pour que les utilisateurs puissent tirer parti des objets retournés par chaque applet de commande, vous devez documenter les objets qui sont retournés, et vous devez documenter les membres desquels les objets retournés sont utilisés.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-212">In order for users to take advantage of the objects that are returned by each cmdlet, you must document the objects that are returned, and you must document what the members of those returned objects are used for.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="2a8fc-213">Instructions de code</span><span class="sxs-lookup"><span data-stu-id="2a8fc-213">Code Guidelines</span></span>

<span data-ttu-id="2a8fc-214">Les instructions suivantes doivent être suivies lors de l’écriture du code de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-214">The following guidelines must be followed when writing cmdlet code.</span></span> <span data-ttu-id="2a8fc-215">Lorsque vous trouvez une indication de code qui s’applique à votre situation, veillez à consulter les instructions de conception pour obtenir des instructions similaires.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-215">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="derive-from-the-cmdlet-or-pscmdlet-classes-rc01"></a><span data-ttu-id="2a8fc-216">Dérivation à partir de l’applet de commande ou des classes PSCmdlet (RC01)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-216">Derive from the Cmdlet or PSCmdlet Classes (RC01)</span></span>

<span data-ttu-id="2a8fc-217">Une applet de commande doit dériver de la classe de base [System. Management. Automation. applet](/dotnet/api/System.Management.Automation.Cmdlet) de commande ou [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) .</span><span class="sxs-lookup"><span data-stu-id="2a8fc-217">A cmdlet must derive from either the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) or [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="2a8fc-218">Les applets de commande qui dérivent de la classe [System. Management. Automation. applet](/dotnet/api/System.Management.Automation.Cmdlet) de commande ne dépendent pas du runtime Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-218">Cmdlets that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class do not depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="2a8fc-219">Elles peuvent être appelées directement à partir de n’importe quel langage Microsoft .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-219">They can be called directly from any Microsoft .NET Framework language.</span></span> <span data-ttu-id="2a8fc-220">Les applets de commande qui dérivent de la classe [System. Management. Automation. PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) dépendent du runtime Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-220">Cmdlets that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class depend on the Windows PowerShell runtime.</span></span> <span data-ttu-id="2a8fc-221">Par conséquent, elles s’exécutent dans une instance d’exécution.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-221">Therefore, they execute within a runspace.</span></span>

<span data-ttu-id="2a8fc-222">Toutes les classes d’applet de commande que vous implémentez doivent être des classes publiques.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-222">All cmdlet classes that you implement must be public classes.</span></span> <span data-ttu-id="2a8fc-223">Pour plus d’informations sur ces classes d’applet de commande, consultez [vue d’ensemble](./cmdlet-overview.md)des applets de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-223">For more information about these cmdlet classes, see [Cmdlet Overview](./cmdlet-overview.md).</span></span>

### <a name="specify-the-cmdlet-attribute-rc02"></a><span data-ttu-id="2a8fc-224">Spécifier l’attribut d’applet de commande (RC02)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-224">Specify the Cmdlet Attribute (RC02)</span></span>

<span data-ttu-id="2a8fc-225">Pour qu’une applet de commande soit reconnue par Windows PowerShell, sa classe .NET Framework doit être décorée avec l’attribut applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-225">For a cmdlet to be recognized by Windows PowerShell, its .NET Framework class must be decorated with the Cmdlet attribute.</span></span> <span data-ttu-id="2a8fc-226">Cet attribut spécifie les fonctionnalités suivantes de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-226">This attribute specifies the following features of the cmdlet.</span></span>

- <span data-ttu-id="2a8fc-227">Paire verbe-and-substantif qui identifie l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-227">The verb-and-noun pair that identifies the cmdlet.</span></span>

- <span data-ttu-id="2a8fc-228">Jeu de paramètres par défaut utilisé lorsque plusieurs jeux de paramètres sont spécifiés.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-228">The default parameter set that is used when multiple parameter sets are specified.</span></span> <span data-ttu-id="2a8fc-229">Le jeu de paramètres par défaut est utilisé lorsque Windows PowerShell ne dispose pas de suffisamment d’informations pour déterminer le jeu de paramètres à utiliser.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-229">The default parameter set is used when Windows PowerShell does not have enough information to determine which parameter set to use.</span></span>

- <span data-ttu-id="2a8fc-230">Indique si l’applet de commande prend en charge les appels à la méthode [System. Management. Automation. cmdlet. ShouldProcess \*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) .</span><span class="sxs-lookup"><span data-stu-id="2a8fc-230">Indicates if the cmdlet supports calls to the [System.Management.Automation.Cmdlet.ShouldProcess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="2a8fc-231">Cette méthode affiche un message de confirmation à l’utilisateur avant que l’applet de commande apporte une modification au système.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-231">This method displays a confirmation message to the user before the cmdlet makes a change to the system.</span></span> <span data-ttu-id="2a8fc-232">Pour plus d’informations sur la façon dont les demandes de confirmation sont effectuées, consultez [demande de confirmation](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="2a8fc-232">For more information about how confirmation requests are made, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

- <span data-ttu-id="2a8fc-233">Indiquez le niveau d’impact (gravité) de l’action associée au message de confirmation.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-233">Indicate the impact level (or severity) of the action associated with the confirmation message.</span></span> <span data-ttu-id="2a8fc-234">Dans la plupart des cas, la valeur par défaut moyenne doit être utilisée.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-234">In most cases, the default value of Medium should be used.</span></span> <span data-ttu-id="2a8fc-235">Pour plus d’informations sur la façon dont le niveau d’impact affecte les demandes de confirmation qui sont affichées à l’utilisateur, consultez [demande de confirmation](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="2a8fc-235">For more information about how the impact level affects the confirmation requests that are displayed to the user, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="2a8fc-236">Pour plus d’informations sur la façon de déclarer l’attribut d’applet de commande, consultez [déclaration CmdletAttribute](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="2a8fc-236">For more information about how to declare the cmdlet attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="override-an-input-processing-method-rc03"></a><span data-ttu-id="2a8fc-237">Remplacer une méthode de traitement d’entrée (RC03)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-237">Override an Input Processing Method (RC03)</span></span>

<span data-ttu-id="2a8fc-238">Pour que l’applet de commande participe à l’environnement Windows PowerShell, elle doit remplacer au moins l’une des *méthodes de traitement d’entrée*suivantes.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-238">For the cmdlet to participate in the Windows PowerShell environment, it must override at least one of the following *input processing methods*.</span></span>

<span data-ttu-id="2a8fc-239">[System. Management. Automation. applet de commande. BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) cette méthode est appelée une fois et elle est utilisée pour fournir des fonctionnalités de pré-traitement.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-239">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) This method is called one time, and it is used to provide pre-processing functionality.</span></span>

<span data-ttu-id="2a8fc-240">[System. Management. Automation. applet de commande. ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) cette méthode est appelée plusieurs fois, et elle est utilisée pour fournir des fonctionnalités d’enregistrement par enregistrement.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-240">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) This method is called multiple times, and it is used to provide record-by-record functionality.</span></span>

<span data-ttu-id="2a8fc-241">[System. Management. Automation. applet de commande. EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) cette méthode est appelée une fois, et elle est utilisée pour fournir la fonctionnalité de publication.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-241">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) This method is called one time, and it is used to provide post-processing functionality.</span></span>

### <a name="specify-the-outputtype-attribute-rc04"></a><span data-ttu-id="2a8fc-242">Spécifier l’attribut OutputType (RC04)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-242">Specify the OutputType Attribute (RC04)</span></span>

<span data-ttu-id="2a8fc-243">L’attribut OutputType (introduit dans Windows PowerShell 2,0) spécifie le type de .NET Framework que votre applet de commande retourne au pipeline.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-243">The OutputType attribute (introduced in Windows PowerShell 2.0) specifies the .NET Framework type that your cmdlet returns to the pipeline.</span></span> <span data-ttu-id="2a8fc-244">En spécifiant le type de sortie de vos applets de commande, vous rendez les objets retournés par votre applet de commande plus détectables par d’autres applets de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-244">By specifying the output type of your cmdlets you make the objects returned by your cmdlet more discoverable by other cmdlets.</span></span> <span data-ttu-id="2a8fc-245">Pour plus d’informations sur la décoration de la classe cmdlet avec cet attribut, consultez la [déclaration d’attribut OutputType](./outputtype-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="2a8fc-245">For more information about decorating the cmdlet class with this attribute, see [OutputType Attribute Declaration](./outputtype-attribute-declaration.md).</span></span>

### <a name="do-not-retain-handles-to-output-objects-rc05"></a><span data-ttu-id="2a8fc-246">Ne pas conserver les descripteurs des objets de sortie (RC05)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-246">Do Not Retain Handles to Output Objects (RC05)</span></span>

<span data-ttu-id="2a8fc-247">Votre applet de commande ne doit pas conserver les descripteurs des objets passés à la méthode [System. Management. Automation. cmdlet. WriteObject \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) .</span><span class="sxs-lookup"><span data-stu-id="2a8fc-247">Your cmdlet should not retain any handles to the objects that are passed to the [System.Management.Automation.Cmdlet.WriteObject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="2a8fc-248">Ces objets sont passés à l’applet de commande suivante dans le pipeline, ou ils sont utilisés par un script.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-248">These objects are passed to the next cmdlet in the pipeline, or they are used by a script.</span></span> <span data-ttu-id="2a8fc-249">Si vous conservez les descripteurs aux objets, deux entités posséderont chaque objet, ce qui génère des erreurs.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-249">If you retain the handles to the objects, two entities will own each object, which causes errors.</span></span>

### <a name="handle-errors-robustly-rc06"></a><span data-ttu-id="2a8fc-250">Gérer les erreurs de façon robuste (RC06)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-250">Handle Errors Robustly (RC06)</span></span>

<span data-ttu-id="2a8fc-251">Un environnement d’administration détecte par nature et apporte des modifications importantes au système que vous gérez.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-251">An administration environment inherently detects and makes important changes to the system that you are administering.</span></span> <span data-ttu-id="2a8fc-252">Par conséquent, il est vital que les applets de commande gèrent correctement les erreurs.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-252">Therefore, it is vital that cmdlets handle errors correctly.</span></span> <span data-ttu-id="2a8fc-253">Pour plus d’informations sur les enregistrements d’erreurs, consultez [rapport d’erreurs Windows PowerShell](./error-reporting-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="2a8fc-253">For more information about error records, see [Windows PowerShell Error Reporting](./error-reporting-concepts.md).</span></span>

- <span data-ttu-id="2a8fc-254">Lorsqu’une erreur empêche une applet de commande de continuer à traiter d’autres enregistrements, il s’agit d’une erreur de fin.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-254">When an error prevents a cmdlet from continuing to process any more records, it is a terminating error.</span></span> <span data-ttu-id="2a8fc-255">L’applet de commande doit appeler la méthode [System. Management. Automation. applet de commande. ThrowTerminatingError \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) qui référence un objet [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) .</span><span class="sxs-lookup"><span data-stu-id="2a8fc-255">The cmdlet must call the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="2a8fc-256">Si une exception n’est pas interceptée par l’applet de commande, le runtime Windows PowerShell lui-même lève une erreur de fin contenant moins d’informations.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-256">If an exception is not caught by the cmdlet, the Windows PowerShell runtime itself throws a terminating error that contains less information.</span></span>

- <span data-ttu-id="2a8fc-257">Pour une erreur sans fin d’exécution qui n’arrête pas l’opération sur l’enregistrement suivant provenant du pipeline (par exemple, un enregistrement produit par un processus différent), l’applet de commande doit appeler la méthode [System. Management. Automation. applet de commande. WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) qui fait référence à un objet [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) .</span><span class="sxs-lookup"><span data-stu-id="2a8fc-257">For a non-terminating error that does not stop operation on the next record that is coming from the pipeline (for example, a record produced by a different process), the cmdlet must call the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method that references an [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object.</span></span> <span data-ttu-id="2a8fc-258">Un exemple d’erreur sans fin d’exécution est l’erreur qui se produit en cas d’échec de l’arrêt d’un processus particulier.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-258">An example of a non-terminating error is the error that occurs if a particular process fails to stop.</span></span> <span data-ttu-id="2a8fc-259">L’appel de la méthode [System. Management. Automation. applet de commande. WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) permet à l’utilisateur d’effectuer de manière cohérente les actions demandées et de conserver les informations pour des actions particulières qui échouent.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-259">Calling the [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) method allows the user to consistently perform the actions requested and to retain the information for particular actions that fail.</span></span> <span data-ttu-id="2a8fc-260">Votre applet de commande doit gérer chaque enregistrement de la manière la plus indépendante possible.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-260">Your cmdlet should handle each record as independently as possible.</span></span>

- <span data-ttu-id="2a8fc-261">L’objet [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) qui est référencé par les méthodes [System. Management. Automation. applet de commande. ThrowTerminatingError \*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) et [System. Management. Automation. cmdlet. WriteError \*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) requiert un exception à son noyau.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-261">The [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object that is referenced by the [System.Management.Automation.Cmdlet.ThrowTerminatingError\*](/dotnet/api/System.Management.Automation.Cmdlet.ThrowTerminatingError) and [System.Management.Automation.Cmdlet.WriteError\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteError) methods requires an exception at its core.</span></span> <span data-ttu-id="2a8fc-262">Suivez les instructions de conception de .NET Framework lorsque vous déterminez l’exception à utiliser.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-262">Follow the .NET Framework design guidelines when you determine the exception to use.</span></span> <span data-ttu-id="2a8fc-263">Si l’erreur est sémantiquement identique à une exception existante, utilisez cette exception ou dérivez de cette exception.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-263">If the error is semantically the same as an existing exception, use that exception or derive from that exception.</span></span> <span data-ttu-id="2a8fc-264">Sinon, dérivez une nouvelle exception ou une nouvelle hiérarchie d’exception directement à partir du type [System. exception](/dotnet/api/System.Exception) .</span><span class="sxs-lookup"><span data-stu-id="2a8fc-264">Otherwise, derive a new exception or exception hierarchy directly from the [System.Exception](/dotnet/api/System.Exception) type.</span></span>

<span data-ttu-id="2a8fc-265">Un objet [System. Management. Automation. ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) nécessite également une catégorie d’erreur qui regroupe les erreurs de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-265">An [System.Management.Automation.ErrorRecord](/dotnet/api/System.Management.Automation.ErrorRecord) object also requires an error category that groups errors for the user.</span></span> <span data-ttu-id="2a8fc-266">L’utilisateur peut afficher les erreurs en fonction de la catégorie en définissant la `$ErrorView` valeur de la variable d’interpréteur de commandes sur CategoryView.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-266">The user can view errors based on the category by setting the value of the `$ErrorView` shell variable to CategoryView.</span></span> <span data-ttu-id="2a8fc-267">Les catégories possibles sont définies par l’énumération [System. Management. Automation. ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) .</span><span class="sxs-lookup"><span data-stu-id="2a8fc-267">The possible categories are defined by the [System.Management.Automation.ErrorCategory](/dotnet/api/System.Management.Automation.ErrorCategory) enumeration.</span></span>

- <span data-ttu-id="2a8fc-268">Si une applet de commande crée un nouveau thread et si le code qui s’exécute dans ce thread lève une exception non gérée, Windows PowerShell n’intercepte pas l’erreur et met fin au processus.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-268">If a cmdlet creates a new thread, and if the code that is running in that thread throws an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span>

- <span data-ttu-id="2a8fc-269">Si un objet a du code dans son destructeur qui provoque une exception non gérée, Windows PowerShell n’intercepte pas l’erreur et met fin au processus.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-269">If an object has code in its destructor that causes an unhandled exception, Windows PowerShell will not catch the error and will terminate the process.</span></span> <span data-ttu-id="2a8fc-270">Cela se produit également si un objet appelle des méthodes dispose qui provoquent une exception non gérée.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-270">This also occurs if an object calls Dispose methods that cause an unhandled exception.</span></span>

### <a name="use-a-windows-powershell-module-to-deploy-your-cmdlets-rc07"></a><span data-ttu-id="2a8fc-271">Utiliser un module Windows PowerShell pour déployer vos applets de commande (RC07)</span><span class="sxs-lookup"><span data-stu-id="2a8fc-271">Use a Windows PowerShell Module to Deploy your Cmdlets (RC07)</span></span>

<span data-ttu-id="2a8fc-272">Créez un module Windows PowerShell pour empaqueter et déployer vos applets de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-272">Create a Windows PowerShell module to package and deploy your cmdlets.</span></span> <span data-ttu-id="2a8fc-273">La prise en charge des modules est introduite dans Windows PowerShell 2,0.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-273">Support for modules is introduced in Windows PowerShell 2.0.</span></span> <span data-ttu-id="2a8fc-274">Vous pouvez utiliser les assemblys qui contiennent vos classes d’applet de commande directement comme fichiers de module binaire (cette fonctionnalité est très utile lors du test de vos applets de commande), ou vous pouvez créer un manifeste de module qui référence les assemblys d’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="2a8fc-274">You can use the assemblies that contain your cmdlet classes directly as binary module files (this is very useful when testing your cmdlets), or you can create a module manifest that references the cmdlet assemblies.</span></span> <span data-ttu-id="2a8fc-275">(Vous pouvez également ajouter des assemblys de composant logiciel enfichable existants lors de l’utilisation de modules.) Pour plus d’informations sur les modules, consultez [écriture d’un module Windows PowerShell](../module/writing-a-windows-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="2a8fc-275">(You can also add existing snap-in assemblies when using modules.) For more information about modules, see [Writing a Windows PowerShell Module](../module/writing-a-windows-powershell-module.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="2a8fc-276">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2a8fc-276">See Also</span></span>

[<span data-ttu-id="2a8fc-277">Instructions de développement vivement encouragées</span><span class="sxs-lookup"><span data-stu-id="2a8fc-277">Strongly Encouraged Development Guidelines</span></span>](./strongly-encouraged-development-guidelines.md)

[<span data-ttu-id="2a8fc-278">Conseils pour le développement d’avis</span><span class="sxs-lookup"><span data-stu-id="2a8fc-278">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="2a8fc-279">Écriture d’une applet de commande Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="2a8fc-279">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
