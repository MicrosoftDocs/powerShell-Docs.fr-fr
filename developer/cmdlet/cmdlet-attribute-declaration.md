---
title: Déclaration d’attribut de l’applet de commande | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- Cmdlet attribute, described
- attributes, Cmdlet
- Cmdlet attribute
ms.assetid: 1d323332-f773-4c0e-8a69-2aada765afb2
caps.latest.revision: 12
ms.openlocfilehash: 2bc03aaade1f18d48f65ecf5f9ee437ffaf07f92
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/03/2019
ms.locfileid: "56863425"
---
# <a name="cmdlet-attribute-declaration"></a><span data-ttu-id="d52cf-102">Déclaration de l’attribut Cmdlet</span><span class="sxs-lookup"><span data-stu-id="d52cf-102">Cmdlet Attribute Declaration</span></span>

<span data-ttu-id="d52cf-103">L’attribut de l’applet de commande identifie une classe Microsoft .NET Framework en tant qu’une applet de commande et spécifie le verbe et substantif, utilisé pour appeler l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="d52cf-103">The Cmdlet attribute identifies a Microsoft .NET Framework class as a cmdlet and specifies the verb and noun used to invoke the cmdlet.</span></span>

## <a name="syntax"></a><span data-ttu-id="d52cf-104">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="d52cf-104">Syntax</span></span>

```csharp
[Cmdlet("verbName", "nounName")]
[Cmdlet("verbName", "nounName", Named Parameters...)]
```

#### <a name="parameters"></a><span data-ttu-id="d52cf-105">Paramètres</span><span class="sxs-lookup"><span data-stu-id="d52cf-105">Parameters</span></span>

<span data-ttu-id="d52cf-106">`VerbName` ([System.String](/dotnet/api/System.String)) requis.</span><span class="sxs-lookup"><span data-stu-id="d52cf-106">`VerbName` ([System.String](/dotnet/api/System.String)) Required.</span></span> <span data-ttu-id="d52cf-107">Spécifie le verbe de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="d52cf-107">Specifies the cmdlet verb.</span></span> <span data-ttu-id="d52cf-108">Ce verbe Spécifie l’action effectuée par l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="d52cf-108">This verb specifies the action taken by the cmdlet.</span></span> <span data-ttu-id="d52cf-109">Pour plus d’informations sur les verbes d’applet de commande approuvés, consultez [les noms de verbe Cmdlet](./approved-verbs-for-windows-powershell-commands.md) et [directives de développement requis](./required-development-guidelines.md).</span><span class="sxs-lookup"><span data-stu-id="d52cf-109">For more information about approved cmdlet verbs, see [Cmdlet Verb Names](./approved-verbs-for-windows-powershell-commands.md) and [Required Development Guidelines](./required-development-guidelines.md).</span></span>

<span data-ttu-id="d52cf-110">`NounName` ([System.String](/dotnet/api/System.String)) requis.</span><span class="sxs-lookup"><span data-stu-id="d52cf-110">`NounName` ([System.String](/dotnet/api/System.String)) Required.</span></span> <span data-ttu-id="d52cf-111">Spécifie le nom de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="d52cf-111">Specifies the cmdlet noun.</span></span> <span data-ttu-id="d52cf-112">Ce nom spécifie la ressource à laquelle l’applet de commande agit.</span><span class="sxs-lookup"><span data-stu-id="d52cf-112">This noun specifies the resource that the cmdlet acts upon.</span></span> <span data-ttu-id="d52cf-113">Pour plus d’informations sur les noms d’applet de commande, consultez [déclaration de l’applet de commande](./cmdlet-class-declaration.md) et [fortement encouragés les directives de développement](./strongly-encouraged-development-guidelines.md).</span><span class="sxs-lookup"><span data-stu-id="d52cf-113">For more information about cmdlet nouns, see [Cmdlet Declaration](./cmdlet-class-declaration.md) and [Strongly Encouraged Development Guidelines](./strongly-encouraged-development-guidelines.md).</span></span>

<span data-ttu-id="d52cf-114">`SupportsShouldProcess` ([System.Boolean](/dotnet/api/System.Boolean)) paramètre nommé facultatif.</span><span class="sxs-lookup"><span data-stu-id="d52cf-114">`SupportsShouldProcess` ([System.Boolean](/dotnet/api/System.Boolean)) Optional named parameter.</span></span> <span data-ttu-id="d52cf-115">`True` Indique que l’applet de commande prend en charge les appels à la [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) (méthode), qui fournit un moyen d’inviter l’utilisateur avant l’exécution d’une action qui modifie le système à l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="d52cf-115">`True` indicates that the cmdlet supports calls to the [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method, which provides the cmdlet with a way to prompt the user before an action that changes the system is performed.</span></span> <span data-ttu-id="d52cf-116">`False`, la valeur par défaut, indique que l’applet de commande ne prend pas en charge les appels à la [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) (méthode).</span><span class="sxs-lookup"><span data-stu-id="d52cf-116">`False`, the default value, indicates that the cmdlet does not support calls to the [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="d52cf-117">Pour plus d’informations sur les demandes de confirmation, consultez [demande une Confirmation](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="d52cf-117">For more information about confirmation requests, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="d52cf-118">`ConfirmImpact` ([System.Management.Automation.Confirmimpact](/dotnet/api/System.Management.Automation.ConfirmImpact)) paramètre nommé facultatif.</span><span class="sxs-lookup"><span data-stu-id="d52cf-118">`ConfirmImpact` ([System.Management.Automation.Confirmimpact](/dotnet/api/System.Management.Automation.ConfirmImpact)) Optional named parameter.</span></span> <span data-ttu-id="d52cf-119">Spécifie quand l’action de l’applet de commande doit être confirmée par un appel à la [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) (méthode).</span><span class="sxs-lookup"><span data-stu-id="d52cf-119">Specifies when the action of the cmdlet should be confirmed by a call to the [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method.</span></span> <span data-ttu-id="d52cf-120">[System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) sera appelée lorsque la valeur de ConfirmImpact de l’applet de commande (par défaut, les moyennes) est égale ou supérieure à la valeur de la `$ConfirmPreference` variable.</span><span class="sxs-lookup"><span data-stu-id="d52cf-120">[System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) will only be called when the ConfirmImpact value of the cmdlet (by default, Medium) is equal to or greater than the value of the `$ConfirmPreference` variable.</span></span> <span data-ttu-id="d52cf-121">Ce paramètre doit être spécifié uniquement lorsque le `SupportsShouldProcess` est précisé.</span><span class="sxs-lookup"><span data-stu-id="d52cf-121">This parameter should be specified only when the `SupportsShouldProcess` parameter is specified.</span></span>

<span data-ttu-id="d52cf-122">`DefaultParameterSetName` ([System.String](/dotnet/api/System.String)) paramètre nommé facultatif.</span><span class="sxs-lookup"><span data-stu-id="d52cf-122">`DefaultParameterSetName` ([System.String](/dotnet/api/System.String)) Optional named parameter.</span></span> <span data-ttu-id="d52cf-123">Le paramètre par défaut Spécifie que le runtime Windows PowerShell tente d’utiliser lorsqu’il ne peut pas déterminer le jeu de paramètres à utiliser.</span><span class="sxs-lookup"><span data-stu-id="d52cf-123">Specifies the default parameter set that the Windows PowerShell runtime attempts to use when it cannot determine which parameter set to use.</span></span> <span data-ttu-id="d52cf-124">Notez que cette situation peut être éliminée en rendant le paramètre unique de chaque paramètre à définir un paramètre obligatoire.</span><span class="sxs-lookup"><span data-stu-id="d52cf-124">Notice that this situation can be eliminated by making the unique parameter of each parameter set a mandatory parameter.</span></span>

<span data-ttu-id="d52cf-125">Il existe un cas où Windows PowerShell ne peut pas utiliser le paramètre par défaut défini même si un nom de jeu de paramètre par défaut est spécifié.</span><span class="sxs-lookup"><span data-stu-id="d52cf-125">There is one case where Windows PowerShell cannot use the default parameter set even if a default parameter set name is specified.</span></span> <span data-ttu-id="d52cf-126">Le runtime Windows PowerShell ne peut pas faire la distinction entre les jeux de paramètres basées uniquement sur le type d’objet.</span><span class="sxs-lookup"><span data-stu-id="d52cf-126">The Windows PowerShell runtime cannot distinguish between parameter sets based solely on object type.</span></span> <span data-ttu-id="d52cf-127">Par exemple, si vous avez un jeu de paramètres qui prend une chaîne en tant que le chemin d’accès de fichier et un autre ensemble qui prend un **FileInfo** objet directement, Windows PowerShell ne peut pas déterminer quel paramètre configuré pour utiliser selon les valeurs passées à la l’applet de commande, et n’utilise pas le jeu de paramètres par défaut.</span><span class="sxs-lookup"><span data-stu-id="d52cf-127">For example, if you have one parameter set that takes a string as the file path, and another set that takes a **FileInfo** object directly, Windows PowerShell cannot determine which parameter set to use based on the values passed to the cmdlet, nor does it use the default parameter set.</span></span> <span data-ttu-id="d52cf-128">Dans ce cas, même si vous spécifiez un paramètre par défaut nom, Windows PowerShell génère un message d’erreur ambigu paramètre ensemble.</span><span class="sxs-lookup"><span data-stu-id="d52cf-128">In this case, even if you specify a default parameter set name, Windows PowerShell throws an ambiguous parameter set error message.</span></span>

<span data-ttu-id="d52cf-129">`SupportsTransactions` ([System.Boolean](/dotnet/api/System.Boolean)) paramètre nommé facultatif.</span><span class="sxs-lookup"><span data-stu-id="d52cf-129">`SupportsTransactions` ([System.Boolean](/dotnet/api/System.Boolean)) Optional named parameter.</span></span> <span data-ttu-id="d52cf-130">`True` Indique que l’applet de commande peut être utilisé dans une transaction.</span><span class="sxs-lookup"><span data-stu-id="d52cf-130">`True` indicates that the cmdlet can be used within a transaction.</span></span> <span data-ttu-id="d52cf-131">Lorsque `True` est spécifié, le runtime Windows PowerShell ajoute le `UseTransaction` paramètre à la liste des paramètres de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="d52cf-131">When `True` is specified, the Windows PowerShell runtime adds the `UseTransaction` parameter to the parameter list of the cmdlet.</span></span> <span data-ttu-id="d52cf-132">`False`, la valeur par défaut, indique que l’applet de commande ne peut pas être utilisé dans une transaction.</span><span class="sxs-lookup"><span data-stu-id="d52cf-132">`False`, the default value, indicates that the cmdlet cannot be used within a transaction.</span></span>

## <a name="remarks"></a><span data-ttu-id="d52cf-133">Remarques</span><span class="sxs-lookup"><span data-stu-id="d52cf-133">Remarks</span></span>

- <span data-ttu-id="d52cf-134">Ensemble, le verbe et substantif servent à identifier votre applet de commande inscrit et pour appeler votre applet de commande au sein d’un script.</span><span class="sxs-lookup"><span data-stu-id="d52cf-134">Together, the verb and noun are used to identify your registered cmdlet and to invoke your cmdlet within a script.</span></span>

- <span data-ttu-id="d52cf-135">Lors de l’applet de commande est appelée à partir de la console Windows PowerShell, la commande ressemble à la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="d52cf-135">When the cmdlet is invoked from the Windows PowerShell console, the command resembles the following command:</span></span>

<span data-ttu-id="d52cf-136">**VerbName-NounName**</span><span class="sxs-lookup"><span data-stu-id="d52cf-136">**VerbName-NounName**</span></span>

- <span data-ttu-id="d52cf-137">Toutes les applets de commande qui modifient les ressources en dehors de Windows PowerShell doivent inclure le `SupportsShouldProcess` mot clé lors de l’attribut de l’applet de commande est déclaré, ce qui permet à l’applet de commande appeler le [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) méthode avant que l’applet de commande effectue son action.</span><span class="sxs-lookup"><span data-stu-id="d52cf-137">All cmdlets that change resources outside of Windows PowerShell should include the `SupportsShouldProcess` keyword when the Cmdlet attribute is declared, which allows the cmdlet to call the [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) method before the cmdlet performs its action.</span></span> <span data-ttu-id="d52cf-138">Si le [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) appeler retourne `false`, l’action ne doit pas être effectuée.</span><span class="sxs-lookup"><span data-stu-id="d52cf-138">If the [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) call returns `false`, the action should not be taken.</span></span> <span data-ttu-id="d52cf-139">Pour plus d’informations sur les demandes de confirmation générées par le [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) appeler, consultez [demande une Confirmation](./requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="d52cf-139">For more information about the confirmation requests generated by the [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) call, see [Requesting Confirmation](./requesting-confirmation-from-cmdlets.md).</span></span>

<span data-ttu-id="d52cf-140">Le `Confirm` et `WhatIf` paramètres de l’applet de commande sont disponibles uniquement pour les applets de commande qui prennent en charge [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) appels.</span><span class="sxs-lookup"><span data-stu-id="d52cf-140">The `Confirm` and `WhatIf` cmdlet parameters are available only for cmdlets that support [System.Management.Automation.Cmdlet.Shouldprocess\*](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) calls.</span></span>

## <a name="example"></a><span data-ttu-id="d52cf-141">Exemple</span><span class="sxs-lookup"><span data-stu-id="d52cf-141">Example</span></span>

<span data-ttu-id="d52cf-142">La définition de classe suivante utilise l’attribut de l’applet de commande pour identifier la classe .NET Framework pour un **Get-Process** applet de commande qui Récupère des informations sur les processus en cours d’exécution sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="d52cf-142">The following class definition uses the Cmdlet attribute to identify the .NET Framework class for a **Get-Proc** cmdlet that retrieves information about the processes running on the local computer.</span></span>

```csharp
[Cmdlet(VerbsCommon.Get, "Proc")]
public class GetProcCommand : Cmdlet
```

<span data-ttu-id="d52cf-143">Pour plus d’informations sur la **Get-Process** applet de commande, consultez [GetProc didacticiel](./getproc-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="d52cf-143">For more information about the **Get-Proc** cmdlet, see [GetProc Tutorial](./getproc-tutorial.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="d52cf-144">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d52cf-144">See Also</span></span>

[<span data-ttu-id="d52cf-145">Écriture d’une applet de commande Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="d52cf-145">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
