---
title: Nous recommandons fortement d’indications de développement | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 4d68a8f3-fba0-44c5-97b9-9fc191d269a5
caps.latest.revision: 13
ms.openlocfilehash: c11e50913d2654b786e0e8cfeaf41454999bf75e
ms.sourcegitcommit: 5990f04b8042ef2d8e571bec6d5b051e64c9921c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/12/2019
ms.locfileid: "57794967"
---
# <a name="strongly-encouraged-development-guidelines"></a><span data-ttu-id="ac16c-102">Instructions dont le suivi est fortement recommandé pour le développement</span><span class="sxs-lookup"><span data-stu-id="ac16c-102">Strongly Encouraged Development Guidelines</span></span>

<span data-ttu-id="ac16c-103">Cette section décrit les instructions que vous devez suivre lorsque vous écrivez vos applets de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-103">This section describes guidelines that you should follow when you write your cmdlets.</span></span> <span data-ttu-id="ac16c-104">Ils sont divisés en instructions pour la conception des applets de commande et des instructions pour l’écriture de votre code de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-104">They are separated into guidelines for designing cmdlets and guidelines for writing your cmdlet code.</span></span> <span data-ttu-id="ac16c-105">Vous pouvez constater que ces instructions ne sont pas applicables pour chaque scénario.</span><span class="sxs-lookup"><span data-stu-id="ac16c-105">You might find that these guidelines are not applicable for every scenario.</span></span> <span data-ttu-id="ac16c-106">Toutefois, si elles s’appliquent et que vous ne suivez pas ces instructions, vos utilisateurs peuvent avoir une mauvaise expérience lorsqu’ils utilisent vos applets de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-106">However, if they do apply and you do not follow these guidelines, your users might have a poor experience when they use your cmdlets.</span></span>

## <a name="design-guidelines"></a><span data-ttu-id="ac16c-107">Règles de conception</span><span class="sxs-lookup"><span data-stu-id="ac16c-107">Design Guidelines</span></span>

- [<span data-ttu-id="ac16c-108">Utiliser un nom spécifique pour un nom de l’applet de commande (SD01)</span><span class="sxs-lookup"><span data-stu-id="ac16c-108">Use a Specific Noun for a Cmdlet Name (SD01)</span></span>](./strongly-encouraged-development-guidelines.md#use-a-specific-noun-for-a-cmdlet-name-sd01)

- [<span data-ttu-id="ac16c-109">Utilisez la casse Pascal pour les noms d’applet de commande (SD02)</span><span class="sxs-lookup"><span data-stu-id="ac16c-109">Use Pascal Case for Cmdlet Names (SD02)</span></span>](./strongly-encouraged-development-guidelines.md#use-pascal-case-for-cmdlet-names-sd02)

- [<span data-ttu-id="ac16c-110">Instructions de conception de paramètre (SD03)</span><span class="sxs-lookup"><span data-stu-id="ac16c-110">Parameter Design Guidelines (SD03)</span></span>](./strongly-encouraged-development-guidelines.md#parameter-design-guidelines-sd03)

- [<span data-ttu-id="ac16c-111">Fournir des commentaires à l’utilisateur (SD04)</span><span class="sxs-lookup"><span data-stu-id="ac16c-111">Provide Feedback to the User (SD04)</span></span>](./strongly-encouraged-development-guidelines.md#provide-feedback-to-the-user-sd04)

- [<span data-ttu-id="ac16c-112">Créer un fichier d’aide de l’applet de commande (SD05)</span><span class="sxs-lookup"><span data-stu-id="ac16c-112">Create a Cmdlet Help File (SD05)</span></span>](./strongly-encouraged-development-guidelines.md#create-a-cmdlet-help-file-sd05)

## <a name="code-guidelines"></a><span data-ttu-id="ac16c-113">Instructions de code</span><span class="sxs-lookup"><span data-stu-id="ac16c-113">Code Guidelines</span></span>

- [<span data-ttu-id="ac16c-114">Paramètres de codage (SC01)</span><span class="sxs-lookup"><span data-stu-id="ac16c-114">Coding Parameters (SC01)</span></span>](./strongly-encouraged-development-guidelines.md#coding-parameters-sc01)

- [<span data-ttu-id="ac16c-115">Prise en charge d’entrée de Pipeline bien défini (SC02)</span><span class="sxs-lookup"><span data-stu-id="ac16c-115">Support Well Defined Pipeline Input (SC02)</span></span>](./strongly-encouraged-development-guidelines.md#support-well-defined-pipeline-input-sc02)

- [<span data-ttu-id="ac16c-116">Écrire des enregistrements uniques dans le Pipeline (SC03)</span><span class="sxs-lookup"><span data-stu-id="ac16c-116">Write Single Records to the Pipeline (SC03)</span></span>](./strongly-encouraged-development-guidelines.md#write-single-records-to-the-pipeline-sc03)

- [<span data-ttu-id="ac16c-117">Rendre les applets de commande non-respect de la casse et de la casse (SC04)</span><span class="sxs-lookup"><span data-stu-id="ac16c-117">Make Cmdlets Case-Insensitive and Case-Preserving (SC04)</span></span>](./strongly-encouraged-development-guidelines.md#make-cmdlets-case-insensitive-and-case-preserving-sc04)

## <a name="design-guidelines"></a><span data-ttu-id="ac16c-118">Règles de conception</span><span class="sxs-lookup"><span data-stu-id="ac16c-118">Design Guidelines</span></span>

<span data-ttu-id="ac16c-119">Vous devraient suivre les indications suivantes lors de la conception des applets de commande pour garantir une expérience utilisateur cohérente entre l’utilisation de vos applets de commande et d’autres applets de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-119">The following guidelines should be followed when designing cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="ac16c-120">Lorsque vous trouvez une indication de conception qui s’appliquent à votre situation, veillez à consulter les instructions de Code pour obtenir des instructions similaires.</span><span class="sxs-lookup"><span data-stu-id="ac16c-120">When you find a Design guideline that applies to your situation, be sure to look at the Code guidelines for similar guidelines.</span></span>

### <a name="use-a-specific-noun-for-a-cmdlet-name-sd01"></a><span data-ttu-id="ac16c-121">Utiliser un nom spécifique pour un nom de l’applet de commande (SD01)</span><span class="sxs-lookup"><span data-stu-id="ac16c-121">Use a Specific Noun for a Cmdlet Name (SD01)</span></span>

<span data-ttu-id="ac16c-122">Les noms utilisés dans l’applet de commande d’affectation de noms doivent être très spécifique pour que l’utilisateur puisse détecter vos applets de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-122">Nouns used in cmdlet naming need to be very specific so that the user can discover your cmdlets.</span></span> <span data-ttu-id="ac16c-123">Préfixe des noms génériques tels que « server » avec une version abrégée du nom du produit.</span><span class="sxs-lookup"><span data-stu-id="ac16c-123">Prefix generic nouns such as "server" with a shortened version of the product name.</span></span> <span data-ttu-id="ac16c-124">Par exemple, si un nom fait référence à un serveur qui exécute une instance de Microsoft SQL Server, utilisez un nom, par exemple « SQLServer ».</span><span class="sxs-lookup"><span data-stu-id="ac16c-124">For example, if a noun refers to a server that is running an instance of Microsoft SQL Server, use a noun such as "SQLServer".</span></span> <span data-ttu-id="ac16c-125">La combinaison de noms spécifiques et une brève liste des verbes approuvés permettre à l’utilisateur de découvrir rapidement et d’anticiper leurs fonctionnalités tout en évitant les doublons parmi les noms de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-125">The combination of specific nouns and the short list of approved verbs enable the user to quickly discover and anticipate functionality while avoiding duplication among cmdlet names.</span></span>

<span data-ttu-id="ac16c-126">Pour améliorer l’expérience utilisateur, le nom que vous choisissez pour un nom de l’applet de commande doit être au singulier.</span><span class="sxs-lookup"><span data-stu-id="ac16c-126">To enhance the user experience, the noun that you choose for a cmdlet name should be singular.</span></span> <span data-ttu-id="ac16c-127">Par exemple, utilisez le nom `Get-Process` au lieu de **Get-processus**.</span><span class="sxs-lookup"><span data-stu-id="ac16c-127">For example, use the name `Get-Process` instead of **Get-Processes**.</span></span> <span data-ttu-id="ac16c-128">Il est préférable de suivre cette règle pour tous les noms d’applet de commande, même si une applet de commande est susceptible d’agir sur plusieurs éléments.</span><span class="sxs-lookup"><span data-stu-id="ac16c-128">It is best to follow this rule for all cmdlet names, even when a cmdlet is likely to act upon more than one item.</span></span>

### <a name="use-pascal-case-for-cmdlet-names-sd02"></a><span data-ttu-id="ac16c-129">Utilisez la casse Pascal pour les noms d’applet de commande (SD02)</span><span class="sxs-lookup"><span data-stu-id="ac16c-129">Use Pascal Case for Cmdlet Names (SD02)</span></span>

<span data-ttu-id="ac16c-130">Utilisez la casse Pascal pour les noms de paramètre.</span><span class="sxs-lookup"><span data-stu-id="ac16c-130">Use Pascal case for parameter names.</span></span> <span data-ttu-id="ac16c-131">En d’autres termes, mettre en majuscule la première lettre du verbe et tous les termes utilisés dans le substantif.</span><span class="sxs-lookup"><span data-stu-id="ac16c-131">In other words, capitalize the first letter of verb and all terms used in the noun.</span></span> <span data-ttu-id="ac16c-132">Par exemple, «`Clear-ItemProperty`».</span><span class="sxs-lookup"><span data-stu-id="ac16c-132">For example, "`Clear-ItemProperty`".</span></span>

### <a name="parameter-design-guidelines-sd03"></a><span data-ttu-id="ac16c-133">Instructions de conception de paramètre (SD03)</span><span class="sxs-lookup"><span data-stu-id="ac16c-133">Parameter Design Guidelines (SD03)</span></span>

<span data-ttu-id="ac16c-134">Paramètres qui reçoivent les données sur lequel il doit fonctionner a besoin d’une applet de commande et paramètres qui renvoient des informations qui sont utilisées pour déterminer les caractéristiques de l’opération.</span><span class="sxs-lookup"><span data-stu-id="ac16c-134">A cmdlet needs parameters that receive the data on which it must operate, and parameters that indicate information that is used to determine the characteristics of the operation.</span></span> <span data-ttu-id="ac16c-135">Par exemple, une applet de commande peut avoir un `Name` paramètre qui reçoit des données à partir du pipeline et l’applet de commande peut avoir un `Force` paramètre pour indiquer que l’applet de commande peut être forcé pour effectuer son opération.</span><span class="sxs-lookup"><span data-stu-id="ac16c-135">For example, a cmdlet might have a `Name` parameter that receives data from the pipeline, and the cmdlet might have a `Force` parameter to indicate that the cmdlet can be forced to perform its operation.</span></span> <span data-ttu-id="ac16c-136">Il n’existe aucune limite au nombre de paramètres permettant de définir une applet de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-136">There is no limit to the number of parameters that a cmdlet can define.</span></span>

#### <a name="use-standard-parameter-names"></a><span data-ttu-id="ac16c-137">Utiliser des noms de paramètres Standard</span><span class="sxs-lookup"><span data-stu-id="ac16c-137">Use Standard Parameter Names</span></span>

<span data-ttu-id="ac16c-138">Votre applet de commande doit utiliser des noms de paramètres standard afin que l’utilisateur peut rapidement déterminer ce que signifie un paramètre particulier.</span><span class="sxs-lookup"><span data-stu-id="ac16c-138">Your cmdlet should use standard parameter names so that the user can quickly determine what a particular parameter means.</span></span> <span data-ttu-id="ac16c-139">Si un nom plus spécifique est requis, utilisez un nom de paramètre standard, puis spécifiez un nom plus spécifique en tant qu’alias.</span><span class="sxs-lookup"><span data-stu-id="ac16c-139">If a more specific name is required, use a standard parameter name, and then specify a more specific name as an alias.</span></span> <span data-ttu-id="ac16c-140">Par exemple, le `Get-Service` applet de commande possède un paramètre qui a un nom générique (`Name`) et un alias plus spécifique (`ServiceName`).</span><span class="sxs-lookup"><span data-stu-id="ac16c-140">For example, the `Get-Service` cmdlet has a  parameter that has a generic name (`Name`) and a more specific alias (`ServiceName`).</span></span> <span data-ttu-id="ac16c-141">Les deux termes peuvent être utilisés pour spécifier le paramètre.</span><span class="sxs-lookup"><span data-stu-id="ac16c-141">Both terms can be used to specify the parameter.</span></span>

<span data-ttu-id="ac16c-142">Pour plus d’informations sur les noms de paramètres et leurs types de données, consultez [nom de paramètre d’applet de commande et des instructions de la fonctionnalité](./standard-cmdlet-parameter-names-and-types.md).</span><span class="sxs-lookup"><span data-stu-id="ac16c-142">For more information about parameter names and their data types, see [Cmdlet Parameter Name and Functionality Guidelines](./standard-cmdlet-parameter-names-and-types.md).</span></span>

#### <a name="use-singular-parameter-names"></a><span data-ttu-id="ac16c-143">Utiliser des noms de paramètre au singulier</span><span class="sxs-lookup"><span data-stu-id="ac16c-143">Use Singular Parameter Names</span></span>

<span data-ttu-id="ac16c-144">Évitez d’utiliser des noms au pluriel pour les paramètres dont la valeur est un élément unique.</span><span class="sxs-lookup"><span data-stu-id="ac16c-144">Avoid using plural names for parameters whose value is a single element.</span></span> <span data-ttu-id="ac16c-145">Cela inclut des paramètres qui acceptent les tableaux ou listes car l’utilisateur peut fournir un tableau ou une liste avec un seul élément.</span><span class="sxs-lookup"><span data-stu-id="ac16c-145">This includes parameters that take arrays or lists because the user might supply an array or list with only one element.</span></span>

<span data-ttu-id="ac16c-146">Les noms de paramètre au pluriel doivent être utilisés uniquement dans les cas où la valeur du paramètre est toujours une valeur de plusieurs éléments.</span><span class="sxs-lookup"><span data-stu-id="ac16c-146">Plural parameter names should be used only in those cases where the value of the parameter is always a multiple-element value.</span></span> <span data-ttu-id="ac16c-147">Dans ce cas, l’applet de commande doit vérifier que plusieurs éléments sont fournis, et l’applet de commande doit afficher un avertissement à l’utilisateur si plusieurs éléments ne sont pas fournis.</span><span class="sxs-lookup"><span data-stu-id="ac16c-147">In these cases, the cmdlet should verify that multiple elements are supplied, and the cmdlet should display a warning to the user if multiple elements are not supplied.</span></span>

#### <a name="use-pascal-case-for-parameter-names"></a><span data-ttu-id="ac16c-148">Utilisez la casse Pascal pour les noms de paramètre</span><span class="sxs-lookup"><span data-stu-id="ac16c-148">Use Pascal Case for Parameter Names</span></span>

<span data-ttu-id="ac16c-149">Utilisez la casse Pascal pour les noms de paramètre.</span><span class="sxs-lookup"><span data-stu-id="ac16c-149">Use Pascal case for parameter names.</span></span> <span data-ttu-id="ac16c-150">En d’autres termes, mettre en majuscule la première lettre de chaque mot dans le nom du paramètre, y compris la première lettre du nom.</span><span class="sxs-lookup"><span data-stu-id="ac16c-150">In other words, capitalize the first letter of each word in the parameter name, including the first letter of the name.</span></span> <span data-ttu-id="ac16c-151">Par exemple, le nom du paramètre `ErrorAction` utilise la casse correcte.</span><span class="sxs-lookup"><span data-stu-id="ac16c-151">For example, the parameter name `ErrorAction` uses the correct capitalization.</span></span> <span data-ttu-id="ac16c-152">Les noms de paramètre suivants utilisent la mise en majuscule :</span><span class="sxs-lookup"><span data-stu-id="ac16c-152">The following parameter names use incorrect capitalization:</span></span>

- `errorAction`

- `erroraction`

#### <a name="parameters-that-take-a-list-of-options"></a><span data-ttu-id="ac16c-153">Paramètres qui acceptent une liste d’Options</span><span class="sxs-lookup"><span data-stu-id="ac16c-153">Parameters That Take a List of Options</span></span>

<span data-ttu-id="ac16c-154">Il existe deux façons de créer un paramètre dont la valeur peut être sélectionnée à partir d’un ensemble d’options.</span><span class="sxs-lookup"><span data-stu-id="ac16c-154">There are two ways to create a parameter whose value can be selected from a set of options.</span></span>

- <span data-ttu-id="ac16c-155">Définir un type d’énumération (ou utiliser un type énumération existant) qui spécifie les valeurs valides.</span><span class="sxs-lookup"><span data-stu-id="ac16c-155">Define an enumeration type (or use an existing enumeration type) that specifies the valid values.</span></span> <span data-ttu-id="ac16c-156">Ensuite, utilisez le type d’énumération pour créer un paramètre de ce type.</span><span class="sxs-lookup"><span data-stu-id="ac16c-156">Then, use the enumeration type to create a parameter of that type.</span></span>

- <span data-ttu-id="ac16c-157">Ajouter le **ValidateSet** à la déclaration de paramètre d’attribut.</span><span class="sxs-lookup"><span data-stu-id="ac16c-157">Add the **ValidateSet** attribute to the parameter declaration.</span></span> <span data-ttu-id="ac16c-158">Pour plus d’informations sur cet attribut, consultez [déclaration d’attribut ValidateSet](./validateset-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="ac16c-158">For more information about this attribute, see [ValidateSet Attribute Declaration](./validateset-attribute-declaration.md).</span></span>

#### <a name="use-standard-types-for-parameters"></a><span data-ttu-id="ac16c-159">Utilisez les Types Standard pour les paramètres</span><span class="sxs-lookup"><span data-stu-id="ac16c-159">Use Standard Types for Parameters</span></span>

<span data-ttu-id="ac16c-160">Pour garantir la cohérence avec les autres applets de commande, utilisez les types standard pour les paramètres maximum.</span><span class="sxs-lookup"><span data-stu-id="ac16c-160">To ensure consistency with other cmdlets, use standard types for parameters where ever possible.</span></span> <span data-ttu-id="ac16c-161">Pour plus d’informations sur les types qui doit être utilisé pour le paramètre différentes, consultez [Standard noms de paramètre d’applet de commande et les Types](./standard-cmdlet-parameter-names-and-types.md).</span><span class="sxs-lookup"><span data-stu-id="ac16c-161">For more information about the types that should be used for different parameter, see [Standard Cmdlet Parameter Names and Types](./standard-cmdlet-parameter-names-and-types.md).</span></span> <span data-ttu-id="ac16c-162">Cette rubrique fournit des liens vers des rubriques qui décrivent les noms et types .NET Framework pour les groupes de paramètres standard, tels que les paramètres « activité ».</span><span class="sxs-lookup"><span data-stu-id="ac16c-162">This topic provides links to several topics that describe the names and .NET Framework types for groups of standard parameters, such as the "activity parameters".</span></span>

#### <a name="use-strongly-typed-net-framework-types"></a><span data-ttu-id="ac16c-163">Utiliser des Types fortement typée de .NET Framework</span><span class="sxs-lookup"><span data-stu-id="ac16c-163">Use Strongly-Typed .NET Framework Types</span></span>

<span data-ttu-id="ac16c-164">Les paramètres doivent être définis en tant que types .NET Framework pour fournir une meilleure validation de paramètre.</span><span class="sxs-lookup"><span data-stu-id="ac16c-164">Parameters should be defined as .NET Framework types to provide better parameter validation.</span></span> <span data-ttu-id="ac16c-165">Par exemple, les paramètres qui sont limitées à une seule valeur à partir d’un ensemble de valeurs doivent être définis comme un type d’énumération.</span><span class="sxs-lookup"><span data-stu-id="ac16c-165">For example, parameters that are restricted to one value from a set of values should be defined as an enumeration type.</span></span> <span data-ttu-id="ac16c-166">Pour prendre en charge une valeur de l’identificateur URI (Uniform Resource), définissez le paramètre comme un [System.Uri](/dotnet/api/System.Uri) type.</span><span class="sxs-lookup"><span data-stu-id="ac16c-166">To support a Uniform Resource Identifier (URI) value, define the parameter as a [System.Uri](/dotnet/api/System.Uri) type.</span></span> <span data-ttu-id="ac16c-167">Éviter les paramètres de chaînes de base pour les propriétés de tout sauf texte libre.</span><span class="sxs-lookup"><span data-stu-id="ac16c-167">Avoid basic string parameters for all but free-form text properties.</span></span>

#### <a name="use-consistent-parameter-types"></a><span data-ttu-id="ac16c-168">Utiliser des Types de paramètre cohérents</span><span class="sxs-lookup"><span data-stu-id="ac16c-168">Use Consistent Parameter Types</span></span>

<span data-ttu-id="ac16c-169">Quand le même paramètre est utilisé par plusieurs applets de commande, utilisez toujours le même type de paramètre.</span><span class="sxs-lookup"><span data-stu-id="ac16c-169">When the same parameter is used by multiple cmdlets, always use the same parameter type.</span></span>  <span data-ttu-id="ac16c-170">Par exemple, si le `Process` paramètre est un [System.Int16](/dotnet/api/System.Int16) type pour une applet de commande, n’apportez pas les `Process` paramètre pour une autre applet de commande un [System.Uint16](/dotnet/api/System.UInt16) type.</span><span class="sxs-lookup"><span data-stu-id="ac16c-170">For example, if the `Process` parameter is an [System.Int16](/dotnet/api/System.Int16) type for one cmdlet, do not make the `Process` parameter for another cmdlet a [System.Uint16](/dotnet/api/System.UInt16) type.</span></span>

#### <a name="parameters-that-take-true-and-false"></a><span data-ttu-id="ac16c-171">Paramètres qui acceptent True et False</span><span class="sxs-lookup"><span data-stu-id="ac16c-171">Parameters That Take True and False</span></span>

<span data-ttu-id="ac16c-172">Si votre paramètre accepte uniquement `true` et `false`, définissez le paramètre en tant que type [System.Management.Automation.Switchparameter](/dotnet/api/System.Management.Automation.SwitchParameter).</span><span class="sxs-lookup"><span data-stu-id="ac16c-172">If your parameter takes only `true` and `false`, define the parameter as type [System.Management.Automation.Switchparameter](/dotnet/api/System.Management.Automation.SwitchParameter).</span></span> <span data-ttu-id="ac16c-173">Un paramètre de commutateur est traité comme `true` lorsqu’il est spécifié dans une commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-173">A switch parameter is treated as `true` when it is specified in a command.</span></span> <span data-ttu-id="ac16c-174">Si le paramètre n’est pas inclus dans une commande, Windows PowerShell considère que la valeur du paramètre à être `false`.</span><span class="sxs-lookup"><span data-stu-id="ac16c-174">If the parameter is not included in a command, Windows PowerShell considers the value of the parameter to be `false`.</span></span> <span data-ttu-id="ac16c-175">Ne définissez pas les paramètres booléens.</span><span class="sxs-lookup"><span data-stu-id="ac16c-175">Do not define Boolean parameters.</span></span>

<span data-ttu-id="ac16c-176">Si votre paramètre doit faire la distinction entre les 3 valeurs : $true, $false et « non spécifiée », puis définir un paramètre de type Nullable\<bool >.</span><span class="sxs-lookup"><span data-stu-id="ac16c-176">If your parameter needs to differentiate between 3 values: $true, $false and "unspecified", then define a parameter of type Nullable\<bool>.</span></span>  <span data-ttu-id="ac16c-177">La nécessité d’un 3e, valeur « non spécifiée » se produit généralement lorsque l’applet de commande peut modifier la propriété booléenne d’un objet.</span><span class="sxs-lookup"><span data-stu-id="ac16c-177">The need for a 3rd, "unspecified" value typically occurs when the cmdlet can modify a Boolean property of an object.</span></span> <span data-ttu-id="ac16c-178">Dans ce cas « non spécifiée » signifie de ne pas modifier la valeur actuelle de la propriété.</span><span class="sxs-lookup"><span data-stu-id="ac16c-178">In this case "unspecified" means to not change the current value of the property.</span></span>

#### <a name="support-arrays-for-parameters"></a><span data-ttu-id="ac16c-179">Prise en charge des tableaux de paramètres</span><span class="sxs-lookup"><span data-stu-id="ac16c-179">Support Arrays for Parameters</span></span>

<span data-ttu-id="ac16c-180">Souvent, les utilisateurs doivent effectuer la même opération par rapport à plusieurs arguments.</span><span class="sxs-lookup"><span data-stu-id="ac16c-180">Frequently, users must perform the same operation against multiple arguments.</span></span> <span data-ttu-id="ac16c-181">Pour ces utilisateurs, une applet de commande doit accepter un tableau en tant que paramètre d’entrée afin qu’un utilisateur peut passer les arguments dans le paramètre comme une variable Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="ac16c-181">For these users, a cmdlet should accept an array as parameter input so that a user can pass the arguments into the parameter as a Windows PowerShell variable.</span></span> <span data-ttu-id="ac16c-182">Par exemple, le [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) applet de commande utilise un tableau pour les chaînes qui identifient les noms des processus à récupérer.</span><span class="sxs-lookup"><span data-stu-id="ac16c-182">For example, the [Get-Process](/powershell/module/Microsoft.PowerShell.Management/Get-Process) cmdlet uses an array for the strings that identify the names of the processes to retrieve.</span></span>

#### <a name="support-the-passthru-parameter"></a><span data-ttu-id="ac16c-183">Prend en charge le paramètre PassThru</span><span class="sxs-lookup"><span data-stu-id="ac16c-183">Support the PassThru Parameter</span></span>

<span data-ttu-id="ac16c-184">Par défaut, nombreuses applets de commande qui modifient le système, telles que la [Stop-Process](/powershell/module/Microsoft.PowerShell.Management/Stop-Process) applet de commande, agir en tant que « récepteurs » pour les objets et ne retournent pas un résultat.</span><span class="sxs-lookup"><span data-stu-id="ac16c-184">By default, many cmdlets that modify the system, such as the [Stop-Process](/powershell/module/Microsoft.PowerShell.Management/Stop-Process) cmdlet, act as "sinks" for objects and do not return a result.</span></span> <span data-ttu-id="ac16c-185">Ces cmdlet doit implémenter le `PassThru` paramètre pour forcer l’applet de commande pour retourner un objet.</span><span class="sxs-lookup"><span data-stu-id="ac16c-185">These cmdlet should implement the `PassThru` parameter to force the cmdlet to return an object.</span></span> <span data-ttu-id="ac16c-186">Lorsque le `PassThru` paramètre est spécifié, l’applet de commande retourne un objet à l’aide d’un appel à la [System.Management.Automation.Cmdlet.Writeobject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) (méthode).</span><span class="sxs-lookup"><span data-stu-id="ac16c-186">When the `PassThru` parameter is specified, the cmdlet returns an object by using a call to the [System.Management.Automation.Cmdlet.Writeobject\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="ac16c-187">Par exemple, la commande suivante arrête le processus Calc et transmet le processus résultant au pipeline.</span><span class="sxs-lookup"><span data-stu-id="ac16c-187">For example, the following command stops the Calc process and passes the resultant process to the pipeline.</span></span>

```powershell
Stop-Process calc -passthru
```

<span data-ttu-id="ac16c-188">Dans la plupart des cas, les applets de commande Add, Set et New doit prendre en charge un `PassThru` paramètre.</span><span class="sxs-lookup"><span data-stu-id="ac16c-188">In most cases, Add, Set, and New cmdlets should support a `PassThru` parameter.</span></span>

#### <a name="support-parameter-sets"></a><span data-ttu-id="ac16c-189">Prise en charge les jeux de paramètres</span><span class="sxs-lookup"><span data-stu-id="ac16c-189">Support Parameter Sets</span></span>

<span data-ttu-id="ac16c-190">Une applet de commande est destinée à accomplir une seule fonction.</span><span class="sxs-lookup"><span data-stu-id="ac16c-190">A cmdlet is intended to accomplish a single purpose.</span></span> <span data-ttu-id="ac16c-191">Toutefois, il est souvent plusieurs façons pour décrire l’opération ou la cible de l’opération.</span><span class="sxs-lookup"><span data-stu-id="ac16c-191">However, there is frequently more than one way to describe the operation or the operation target.</span></span> <span data-ttu-id="ac16c-192">Par exemple, un processus peut être identifié par son nom, par son identificateur ou par un processus.</span><span class="sxs-lookup"><span data-stu-id="ac16c-192">For example, a process might be identified by its name, by its identifier, or by a process object.</span></span> <span data-ttu-id="ac16c-193">L’applet de commande doit prendre en charge toutes les représentations raisonnables de ses cibles.</span><span class="sxs-lookup"><span data-stu-id="ac16c-193">The cmdlet should support all the reasonable representations of its targets.</span></span> <span data-ttu-id="ac16c-194">Normalement, l’applet de commande répond à cette exigence en spécifiant des jeux de paramètres (appelés jeux de paramètres) qui fonctionnent ensemble.</span><span class="sxs-lookup"><span data-stu-id="ac16c-194">Normally, the cmdlet satisfies this requirement by specifying sets of parameters (referred to as parameter sets) that operate together.</span></span> <span data-ttu-id="ac16c-195">Un seul paramètre peut appartenir à n’importe quel nombre de jeux de paramètres.</span><span class="sxs-lookup"><span data-stu-id="ac16c-195">A single parameter can belong to any number of parameter sets.</span></span> <span data-ttu-id="ac16c-196">Pour plus d’informations sur les jeux de paramètres, consultez [définit des paramètres d’applet de commande](./cmdlet-parameter-sets.md).</span><span class="sxs-lookup"><span data-stu-id="ac16c-196">For more information about parameter sets, see [Cmdlet Parameter Sets](./cmdlet-parameter-sets.md).</span></span>

<span data-ttu-id="ac16c-197">Lorsque vous spécifiez des jeux de paramètres, ne définissez qu’un seul paramètre dans le jeu de ValueFromPipeline.</span><span class="sxs-lookup"><span data-stu-id="ac16c-197">When you specify parameter sets, set only one parameter in the set to ValueFromPipeline.</span></span> <span data-ttu-id="ac16c-198">Pour plus d’informations sur la façon de déclarer la **paramètre** d’attribut, consultez [ParameterAttribute déclaration](./parameter-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="ac16c-198">For more information about how to declare the **Parameter** attribute, see [ParameterAttribute Declaration](./parameter-attribute-declaration.md).</span></span>

<span data-ttu-id="ac16c-199">Lorsque les jeux de paramètres sont utilisés, le jeu de paramètres par défaut est défini par le **applet de commande** attribut.</span><span class="sxs-lookup"><span data-stu-id="ac16c-199">When parameter sets are used, the default parameter set is defined by the **Cmdlet** attribute.</span></span> <span data-ttu-id="ac16c-200">Le jeu de paramètres par défaut doit inclure les paramètres susceptibles d’être utilisé dans une session Windows PowerShell interactive.</span><span class="sxs-lookup"><span data-stu-id="ac16c-200">The default parameter set should include the parameters most likely to be used in an interactive Windows PowerShell session.</span></span> <span data-ttu-id="ac16c-201">Pour plus d’informations sur la façon de déclarer la **applet de commande** d’attribut, consultez [déclaration CmdletAttribute](./cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="ac16c-201">For more information about how to declare the **Cmdlet** attribute, see [CmdletAttribute Declaration](./cmdlet-attribute-declaration.md).</span></span>

### <a name="provide-feedback-to-the-user-sd04"></a><span data-ttu-id="ac16c-202">Fournir des commentaires à l’utilisateur (SD04)</span><span class="sxs-lookup"><span data-stu-id="ac16c-202">Provide Feedback to the User (SD04)</span></span>

<span data-ttu-id="ac16c-203">Utilisez les instructions de cette section pour fournir des commentaires à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ac16c-203">Use the guidelines in this section to provide feedback to the user.</span></span> <span data-ttu-id="ac16c-204">Ces commentaires permet à l’utilisateur pour être conscient de ce qui se produit dans le système et prendre des décisions mieux d’administration.</span><span class="sxs-lookup"><span data-stu-id="ac16c-204">This feedback allows the user to be aware of what is occurring in the system and to make better administrative decisions.</span></span>

<span data-ttu-id="ac16c-205">Le runtime de Windows PowerShell autorise un utilisateur de spécifier comment gérer la sortie à partir de chaque appel à la `Write` méthode en définissant une variable de préférence.</span><span class="sxs-lookup"><span data-stu-id="ac16c-205">The Windows PowerShell runtime allows a user to specify how to handle output from each call to the `Write` method by setting a preference variable.</span></span> <span data-ttu-id="ac16c-206">L’utilisateur peut définir plusieurs variables de préférence, y compris une variable qui détermine si le système doit afficher des informations et une variable qui détermine si le système doit interroger l’utilisateur avant d’entreprendre une autre action.</span><span class="sxs-lookup"><span data-stu-id="ac16c-206">The user can set several preference variables, including a variable that determines whether the system should display information and a variable that determines whether the system should query the user before taking further action.</span></span>

#### <a name="support-the-writewarning-writeverbose-and-writedebug-methods"></a><span data-ttu-id="ac16c-207">Prise en charge des WriteWarning, WriteVerbose, WriteDebug méthodes</span><span class="sxs-lookup"><span data-stu-id="ac16c-207">Support the WriteWarning, WriteVerbose, and WriteDebug Methods</span></span>

<span data-ttu-id="ac16c-208">Une applet de commande doit appeler le [System.Management.Automation.Cmdlet.Writewarning\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) méthode lors de l’applet de commande est sur le point d’effectuer une opération qui peut avoir un résultat inattendu.</span><span class="sxs-lookup"><span data-stu-id="ac16c-208">A cmdlet should call the [System.Management.Automation.Cmdlet.Writewarning\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteWarning) method when the cmdlet is about to perform an operation that might have an unintended result.</span></span> <span data-ttu-id="ac16c-209">Par exemple, une applet de commande doit appeler cette méthode si l’applet de commande est sur le point de remplacer un fichier en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="ac16c-209">For example, a cmdlet should call this method if the cmdlet is about to overwrite a read-only file.</span></span>

<span data-ttu-id="ac16c-210">Une applet de commande doit appeler le [System.Management.Automation.Cmdlet.Writeverbose\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) méthode lorsque l’utilisateur requiert certains détails sur ce que fait l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-210">A cmdlet should call the [System.Management.Automation.Cmdlet.Writeverbose\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method when the user requires some detail about what the cmdlet is doing.</span></span> <span data-ttu-id="ac16c-211">Par exemple, une applet de commande doit appeler ces informations si l’auteur de l’applet de commande pense qu’il existe des scénarios qui peuvent nécessiter plus d’informations sur ce que fait l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-211">For example, a cmdlet should call this information if the cmdlet author feels that there are scenarios that might require more information about what the cmdlet is doing.</span></span>

<span data-ttu-id="ac16c-212">L’applet de commande doit appeler le [System.Management.Automation.Cmdlet.Writedebug\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) méthode lorsqu’un ingénieur du support produit ou le développeur doit comprendre ce qui a endommagé l’opération de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-212">The cmdlet should call the [System.Management.Automation.Cmdlet.Writedebug\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method when a developer or product support engineer must understand what has corrupted the cmdlet operation.</span></span> <span data-ttu-id="ac16c-213">Il n’est pas nécessaire pour l’applet de commande pour appeler le [System.Management.Automation.Cmdlet.Writedebug\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) méthode dans le même code qui appelle le [System.Management.Automation.Cmdlet.Writeverbose\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) méthode, car le `Debug` paramètre présente deux ensembles d’informations.</span><span class="sxs-lookup"><span data-stu-id="ac16c-213">It is not necessary for the cmdlet to call the [System.Management.Automation.Cmdlet.Writedebug\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteDebug) method in the same code that calls the [System.Management.Automation.Cmdlet.Writeverbose\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteVerbose) method because the `Debug` parameter presents both sets of information.</span></span>

#### <a name="support-writeprogress-for-operations-that-take-a-long-time"></a><span data-ttu-id="ac16c-214">WriteProgress prise en charge pour les opérations qui prennent beaucoup de temps</span><span class="sxs-lookup"><span data-stu-id="ac16c-214">Support WriteProgress for Operations that take a Long Time</span></span>

<span data-ttu-id="ac16c-215">Opérations de l’applet de commande qui prennent beaucoup de temps et qui ne peut pas s’exécuter en arrière-plan doit prendre en charge les cours de création de rapports via des appels périodiques à la [System.Management.Automation.Cmdlet.Writeprogress\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) (méthode).</span><span class="sxs-lookup"><span data-stu-id="ac16c-215">Cmdlet operations that take a long time to complete and that cannot run in the background should support progress reporting through periodic calls to the [System.Management.Automation.Cmdlet.Writeprogress\*](/dotnet/api/System.Management.Automation.Cmdlet.WriteProgress) method.</span></span>

#### <a name="use-the-host-interfaces"></a><span data-ttu-id="ac16c-216">Utiliser les Interfaces de l’hôte</span><span class="sxs-lookup"><span data-stu-id="ac16c-216">Use the Host Interfaces</span></span>

<span data-ttu-id="ac16c-217">Parfois, une applet de commande doit communiquer directement avec l’utilisateur au lieu d’à l’aide de divers écrivant ou doivent les méthodes prises en charge par le [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) classe.</span><span class="sxs-lookup"><span data-stu-id="ac16c-217">Occasionally, a cmdlet must communicate directly with the user instead of by using the various Write or Should methods supported by the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span> <span data-ttu-id="ac16c-218">Dans ce cas, l’applet de commande doit dériver de la [System.Management.Automation.Pscmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) classe et d’utiliser le [System.Management.Automation.Pscmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) propriété.</span><span class="sxs-lookup"><span data-stu-id="ac16c-218">In this case, the cmdlet should derive from the [System.Management.Automation.Pscmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class and use the [System.Management.Automation.Pscmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="ac16c-219">Cette propriété prend en charge différents niveaux de type de communication, y compris les types PromptForChoice, une invite et WriteLine/ReadLine.</span><span class="sxs-lookup"><span data-stu-id="ac16c-219">This property supports different levels of communication type, including the PromptForChoice, Prompt, and WriteLine/ReadLine types.</span></span> <span data-ttu-id="ac16c-220">Niveau au plus spécifique, il fournit également les méthodes pour lire et écrire des clés individuelles et faire face aux mémoires tampons.</span><span class="sxs-lookup"><span data-stu-id="ac16c-220">At the most specific level, it also provides ways to read and write individual keys and to deal with buffers.</span></span>

<span data-ttu-id="ac16c-221">Sauf si une applet de commande est spécifiquement conçu pour générer une interface utilisateur graphique (GUI), il ne doit pas contourner l’hôte à l’aide de la [System.Management.Automation.Pscmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) propriété.</span><span class="sxs-lookup"><span data-stu-id="ac16c-221">Unless a cmdlet is specifically designed to generate a graphical user interface (GUI), it should not bypass the host by using the [System.Management.Automation.Pscmdlet.Host\*](/dotnet/api/System.Management.Automation.PSCmdlet.Host) property.</span></span> <span data-ttu-id="ac16c-222">Est un exemple d’une applet de commande qui est conçu pour générer une interface utilisateur graphique la [Out-GridView](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView) applet de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-222">An example of a cmdlet that is designed to generate a GUI is the [Out-GridView](/powershell/module/Microsoft.PowerShell.Utility/Out-GridView) cmdlet.</span></span>

> [!NOTE]
> <span data-ttu-id="ac16c-223">Applets de commande ne doivent pas utiliser le [System.Console](/dotnet/api/System.Console) API.</span><span class="sxs-lookup"><span data-stu-id="ac16c-223">Cmdlets should not use the [System.Console](/dotnet/api/System.Console) API.</span></span>

### <a name="create-a-cmdlet-help-file-sd05"></a><span data-ttu-id="ac16c-224">Créer un fichier d’aide de l’applet de commande (SD05)</span><span class="sxs-lookup"><span data-stu-id="ac16c-224">Create a Cmdlet Help File (SD05)</span></span>

<span data-ttu-id="ac16c-225">Pour chaque assembly de l’applet de commande, créez un fichier Help.xml qui contient des informations sur l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-225">For each cmdlet assembly, create a Help.xml file that contains information about the cmdlet.</span></span> <span data-ttu-id="ac16c-226">Ces informations comprennent une description de l’applet de commande, les descriptions des paramètres de l’applet de commande, les exemples d’utilisation de l’applet de commande et bien plus encore.</span><span class="sxs-lookup"><span data-stu-id="ac16c-226">This information includes a description of the cmdlet, descriptions of the cmdlet's parameters, examples of the cmdlet's use, and more.</span></span>

## <a name="code-guidelines"></a><span data-ttu-id="ac16c-227">Instructions de code</span><span class="sxs-lookup"><span data-stu-id="ac16c-227">Code Guidelines</span></span>

<span data-ttu-id="ac16c-228">Les instructions suivantes doivent être observées lors du codage des applets de commande pour garantir une expérience utilisateur cohérente entre l’utilisation de vos applets de commande et d’autres applets de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-228">The following guidelines should be followed when coding cmdlets to ensure a consistent user experience between using your cmdlets and other cmdlets.</span></span> <span data-ttu-id="ac16c-229">Lorsque vous trouvez une indication de Code qui s’appliquent à votre situation, veillez à examiner les règles de conception pour obtenir des instructions similaires.</span><span class="sxs-lookup"><span data-stu-id="ac16c-229">When you find a Code guideline that applies to your situation, be sure to look at the Design guidelines for similar guidelines.</span></span>

### <a name="coding-parameters-sc01"></a><span data-ttu-id="ac16c-230">Paramètres de codage (SC01)</span><span class="sxs-lookup"><span data-stu-id="ac16c-230">Coding Parameters (SC01)</span></span>

<span data-ttu-id="ac16c-231">Définir un paramètre en déclarant une propriété publique de la classe d’applet de commande qui est décorée avec le **paramètre** attribut.</span><span class="sxs-lookup"><span data-stu-id="ac16c-231">Define a parameter by declaring a public property of the cmdlet class that is decorated with the **Parameter** attribute.</span></span> <span data-ttu-id="ac16c-232">Paramètres n’ont pas à être des membres statiques de la classe dérivée de .NET Framework pour l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-232">Parameters do not have to be static members of the derived .NET Framework class for the cmdlet.</span></span> <span data-ttu-id="ac16c-233">Pour plus d’informations sur la façon de déclarer la **paramètre** d’attribut, consultez [déclaration d’attribut de paramètre](./parameter-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="ac16c-233">For more information about how to declare the **Parameter** attribute, see [Parameter Attribute Declaration](./parameter-attribute-declaration.md).</span></span>

#### <a name="support-windows-powershell-paths"></a><span data-ttu-id="ac16c-234">Prend en charge les chemins d’accès de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="ac16c-234">Support Windows PowerShell Paths</span></span>

<span data-ttu-id="ac16c-235">Le chemin d’accès Windows PowerShell est le mécanisme de normaliser l’accès aux espaces de noms.</span><span class="sxs-lookup"><span data-stu-id="ac16c-235">The Windows PowerShell path is the mechanism for normalizing access to namespaces.</span></span> <span data-ttu-id="ac16c-236">Lorsque vous affectez un chemin d’accès Windows PowerShell à un paramètre dans l’applet de commande, l’utilisateur peut définir un personnalisé « lecteur » qui agit comme un raccourci vers un chemin d’accès spécifique.</span><span class="sxs-lookup"><span data-stu-id="ac16c-236">When you assign a Windows PowerShell path to a parameter in the cmdlet, the user can define a custom "drive" that acts as a shortcut to a specific path.</span></span> <span data-ttu-id="ac16c-237">Lorsqu’un utilisateur désigne un lecteur de ce type, les données stockées, telles que les données dans le Registre, peuvent être utilisées de manière cohérente.</span><span class="sxs-lookup"><span data-stu-id="ac16c-237">When a user designates such a drive, stored data, such as data in the Registry, can be used in a consistent way.</span></span>

<span data-ttu-id="ac16c-238">Si votre applet de commande permet à l’utilisateur spécifier un fichier ou une source de données, elle doit définir un paramètre de type [System.String](/dotnet/api/System.String).</span><span class="sxs-lookup"><span data-stu-id="ac16c-238">If your cmdlet allows the user to specify a file or a data source, it should define a parameter of type [System.String](/dotnet/api/System.String).</span></span> <span data-ttu-id="ac16c-239">Si la prise en charge de plusieurs lecteurs, le type doit être un tableau.</span><span class="sxs-lookup"><span data-stu-id="ac16c-239">If more than one drive is supported, the type should be an array.</span></span> <span data-ttu-id="ac16c-240">Le nom du paramètre doit être `Path`, avec un alias de `PSPath`.</span><span class="sxs-lookup"><span data-stu-id="ac16c-240">The name of the parameter should be `Path`, with an alias of `PSPath`.</span></span> <span data-ttu-id="ac16c-241">En outre, le `Path` paramètre doit prendre en charge les caractères génériques.</span><span class="sxs-lookup"><span data-stu-id="ac16c-241">Additionally, the `Path` parameter should support wildcard characters.</span></span> <span data-ttu-id="ac16c-242">Si prise en charge des caractères génériques n’est pas nécessaire, définissez un `LiteralPath` paramètre.</span><span class="sxs-lookup"><span data-stu-id="ac16c-242">If support for wildcard characters is not required, define a `LiteralPath` parameter.</span></span>

<span data-ttu-id="ac16c-243">Si les données que l’applet de commande lit ou écrit doit être un fichier, l’applet de commande doit accepter l’entrée de chemin d’accès Windows PowerShell, et l’applet de commande doit utiliser le [System.Management.Automation.Sessionstate.Path](/dotnet/api/System.Management.Automation.SessionState.Path) propriété à traduire le Windows Chemins d’accès PowerShell en chemins d’accès qui reconnaît le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ac16c-243">If the data that the cmdlet reads or writes has to be a file, the cmdlet should accept Windows PowerShell path input, and the cmdlet should use the [System.Management.Automation.Sessionstate.Path](/dotnet/api/System.Management.Automation.SessionState.Path) property to translate the Windows PowerShell paths into paths that the file system recognizes.</span></span> <span data-ttu-id="ac16c-244">Les mécanismes spécifiques incluent les méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="ac16c-244">The specific mechanisms include the following methods:</span></span>

- [<span data-ttu-id="ac16c-245">System.Management.Automation.Pscmdlet.Getresolvedproviderpathfrompspath</span><span class="sxs-lookup"><span data-stu-id="ac16c-245">System.Management.Automation.Pscmdlet.Getresolvedproviderpathfrompspath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetResolvedProviderPathFromPSPath)

- [<span data-ttu-id="ac16c-246">System.Management.Automation.Pscmdlet.Getunresolvedproviderpathfrompspath</span><span class="sxs-lookup"><span data-stu-id="ac16c-246">System.Management.Automation.Pscmdlet.Getunresolvedproviderpathfrompspath</span></span>](/dotnet/api/System.Management.Automation.PSCmdlet.GetUnresolvedProviderPathFromPSPath)

- [<span data-ttu-id="ac16c-247">System.Management.Automation.Pathintrinsics.Getresolvedproviderpathfrompspath</span><span class="sxs-lookup"><span data-stu-id="ac16c-247">System.Management.Automation.Pathintrinsics.Getresolvedproviderpathfrompspath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetResolvedProviderPathFromPSPath)

- [<span data-ttu-id="ac16c-248">System.Management.Automation.Pathintrinsics.Getunresolvedproviderpathfrompspath</span><span class="sxs-lookup"><span data-stu-id="ac16c-248">System.Management.Automation.Pathintrinsics.Getunresolvedproviderpathfrompspath</span></span>](/dotnet/api/System.Management.Automation.PathIntrinsics.GetUnresolvedProviderPathFromPSPath)

<span data-ttu-id="ac16c-249">Si les données que l’applet de commande lit ou écrit sont uniquement un ensemble de chaînes au lieu d’un fichier, l’applet de commande doit utiliser les informations de fournisseur de contenu (`Content` membre) pour lire et écrire.</span><span class="sxs-lookup"><span data-stu-id="ac16c-249">If the data that the cmdlet reads or writes is only a set of strings instead of a file, the cmdlet should use the provider content information (`Content` member) to read and write.</span></span> <span data-ttu-id="ac16c-250">Ces informations sont obtenues à partir de la [System.Management.Automation.Provider.Cmdletprovider.Invokeprovider\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider) propriété.</span><span class="sxs-lookup"><span data-stu-id="ac16c-250">This information is obtained from the [System.Management.Automation.Provider.Cmdletprovider.Invokeprovider\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.InvokeProvider) property.</span></span> <span data-ttu-id="ac16c-251">Ces mécanismes offrent d’autres magasins de données de participer à la lecture et l’écriture des données.</span><span class="sxs-lookup"><span data-stu-id="ac16c-251">These mechanisms allow other data stores to participate in the reading and writing of data.</span></span>

#### <a name="support-wildcard-characters"></a><span data-ttu-id="ac16c-252">Prise en charge des caractères génériques</span><span class="sxs-lookup"><span data-stu-id="ac16c-252">Support Wildcard Characters</span></span>

<span data-ttu-id="ac16c-253">Une applet de commande doit prendre en charge les caractères génériques si possible.</span><span class="sxs-lookup"><span data-stu-id="ac16c-253">A cmdlet should support wildcard characters if possible.</span></span> <span data-ttu-id="ac16c-254">Prise en charge des caractères génériques se produit à plusieurs emplacements dans une applet de commande (en particulier lorsqu’un paramètre accepte une chaîne pour identifier un objet à partir d’un ensemble d’objets).</span><span class="sxs-lookup"><span data-stu-id="ac16c-254">Support for wildcard characters occurs in many places in a cmdlet (especially when a parameter takes a string to identify one object from a set of objects).</span></span> <span data-ttu-id="ac16c-255">Par exemple, l’exemple **Stop-Process** applet de commande à partir de la [StopProc didacticiel](./stopproc-tutorial.md) définit un `Name` paramètre pour traiter les chaînes qui représentent les noms de processus.</span><span class="sxs-lookup"><span data-stu-id="ac16c-255">For example, the sample **Stop-Proc** cmdlet from the [StopProc Tutorial](./stopproc-tutorial.md) defines a `Name` parameter to handle strings that represent process names.</span></span> <span data-ttu-id="ac16c-256">Ce paramètre prend en charge les caractères génériques afin que l’utilisateur peut spécifier facilement les processus à arrêter.</span><span class="sxs-lookup"><span data-stu-id="ac16c-256">This parameter supports wildcard characters so that the user can easily specify the processes to stop.</span></span>

<span data-ttu-id="ac16c-257">Lorsque la prise en charge pour le caractère générique caractères est disponible, une opération de l’applet de commande génère généralement un tableau.</span><span class="sxs-lookup"><span data-stu-id="ac16c-257">When support for wildcard characters is available, a cmdlet operation usually produces an array.</span></span> <span data-ttu-id="ac16c-258">Parfois, il est inutile pour prendre en charge d’un tableau, car l’utilisateur peut utiliser qu’un seul élément à la fois.</span><span class="sxs-lookup"><span data-stu-id="ac16c-258">Occasionally, it does not make sense to support an array because the user might use only a single item at a time.</span></span> <span data-ttu-id="ac16c-259">Par exemple, le [Set-Location](/powershell/module/Microsoft.PowerShell.Management/Set-Location) applet de commande n’a pas besoin prendre en charge d’un tableau, car l’utilisateur consiste à définir qu’un seul emplacement.</span><span class="sxs-lookup"><span data-stu-id="ac16c-259">For example, the [Set-Location](/powershell/module/Microsoft.PowerShell.Management/Set-Location) cmdlet does not need to support an array because the user is setting only a single location.</span></span> <span data-ttu-id="ac16c-260">Dans ce cas, l’applet de commande prend toujours en charge les caractères génériques, mais il force la résolution vers un emplacement unique.</span><span class="sxs-lookup"><span data-stu-id="ac16c-260">In this instance, the cmdlet still supports wildcard characters, but it forces resolution to a single location.</span></span>

<span data-ttu-id="ac16c-261">Pour plus d’informations sur les modèles de caractère générique-caractères, consultez [prenant en charge les caractères génériques dans les paramètres de l’applet de commande](./supporting-wildcard-characters-in-cmdlet-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="ac16c-261">For more information about wildcard-character patterns, see [Supporting Wildcard Characters in Cmdlet Parameters](./supporting-wildcard-characters-in-cmdlet-parameters.md).</span></span>

#### <a name="defining-objects"></a><span data-ttu-id="ac16c-262">Définition d’objets</span><span class="sxs-lookup"><span data-stu-id="ac16c-262">Defining Objects</span></span>

<span data-ttu-id="ac16c-263">Cette section contient des instructions pour définir les objets pour les applets de commande et pour étendre les objets existants.</span><span class="sxs-lookup"><span data-stu-id="ac16c-263">This section contains guidelines for defining objects for cmdlets and for extending existing objects.</span></span>

##### <a name="define-standard-members"></a><span data-ttu-id="ac16c-264">Définir les membres Standard</span><span class="sxs-lookup"><span data-stu-id="ac16c-264">Define Standard Members</span></span>

<span data-ttu-id="ac16c-265">Définir des membres standards pour étendre un type d’objet dans un fichier Types.ps1xml personnalisé (utilisez le fichier PowerShell Types.ps1xml de Windows en tant que modèle).</span><span class="sxs-lookup"><span data-stu-id="ac16c-265">Define standard members to extend an object type in a custom Types.ps1xml file (use the Windows PowerShell Types.ps1xml file as a template).</span></span> <span data-ttu-id="ac16c-266">Les membres standards sont définis par un nœud portant le nom PSStandardMembers.</span><span class="sxs-lookup"><span data-stu-id="ac16c-266">Standard members are defined by a node with the name PSStandardMembers.</span></span> <span data-ttu-id="ac16c-267">Ces définitions autorisent d’autres applets de commande et l’exécution de Windows PowerShell pour travailler avec votre objet de manière cohérente.</span><span class="sxs-lookup"><span data-stu-id="ac16c-267">These definitions allow other cmdlets and the Windows PowerShell runtime to work with your object in a consistent way.</span></span>

##### <a name="define-objectmembers-to-be-used-as-parameters"></a><span data-ttu-id="ac16c-268">Définir ObjectMembers à utiliser en tant que paramètres</span><span class="sxs-lookup"><span data-stu-id="ac16c-268">Define ObjectMembers to Be Used as Parameters</span></span>

<span data-ttu-id="ac16c-269">Si vous créez un objet pour une applet de commande, assurez-vous que ses membres sont mappés directement aux paramètres des applets de commande qui va l’utiliser.</span><span class="sxs-lookup"><span data-stu-id="ac16c-269">If you are designing an object for a cmdlet, ensure that its members map directly to the parameters of the cmdlets that will use it.</span></span> <span data-ttu-id="ac16c-270">Ce mappage permet à l’objet à envoyer facilement au pipeline et à passer d’une cmdlet vers un autre.</span><span class="sxs-lookup"><span data-stu-id="ac16c-270">This mapping allows the object to be easily sent to the pipeline and to be passed from one cmdlet to another.</span></span>

<span data-ttu-id="ac16c-271">Objets .NET Framework qui sont retournés par les applets de commande fréquemment manque certains membres importants ou pratiques qui sont requises par le développeur de scripts ou l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ac16c-271">Preexisting .NET Framework objects that are returned by cmdlets are frequently missing some important or convenient members that are needed by the script developer or user.</span></span> <span data-ttu-id="ac16c-272">Ces membres manquants peuvent être particulièrement importantes pour l’affichage et la création des noms le membre approprié afin que l’objet peut être correctement transmis au pipeline.</span><span class="sxs-lookup"><span data-stu-id="ac16c-272">These missing members can be particularly important for display and for creating the correct member names so that the object can be correctly passed to the pipeline.</span></span> <span data-ttu-id="ac16c-273">Créer un fichier Types.ps1xml personnalisé pour documenter ces membres requis.</span><span class="sxs-lookup"><span data-stu-id="ac16c-273">Create a custom Types.ps1xml file to document these required members.</span></span> <span data-ttu-id="ac16c-274">Lorsque vous créez ce fichier, nous vous recommandons de la convention d’affectation de noms suivante : *< Your_Product_Name >*. Types.ps1xml.</span><span class="sxs-lookup"><span data-stu-id="ac16c-274">When you create this file, we recommend the following naming convention: *<Your_Product_Name>*.Types.ps1xml.</span></span>

<span data-ttu-id="ac16c-275">Par exemple, vous pouvez ajouter un `Mode` script de propriété pour le [System.IO.Fileinfo](/dotnet/api/System.IO.FileInfo) type pour afficher les attributs d’un fichier plus clairement.</span><span class="sxs-lookup"><span data-stu-id="ac16c-275">For example, you could add a `Mode` script property to the [System.IO.Fileinfo](/dotnet/api/System.IO.FileInfo) type to display the attributes of a file more clearly.</span></span> <span data-ttu-id="ac16c-276">En outre, vous pouvez ajouter un `Count` propriété d’alias vers la [System.Array](/dotnet/api/System.Array) type pour autoriser l’utilisation cohérente de ce nom de propriété (au lieu de `Length`).</span><span class="sxs-lookup"><span data-stu-id="ac16c-276">Additionally, you could add a `Count` alias property to the [System.Array](/dotnet/api/System.Array) type to allow the consistent use of that property name (instead of `Length`).</span></span>

##### <a name="implement-the-icomparable-interface"></a><span data-ttu-id="ac16c-277">Implémentez l’Interface IComparable</span><span class="sxs-lookup"><span data-stu-id="ac16c-277">Implement the IComparable Interface</span></span>

<span data-ttu-id="ac16c-278">Implémentez un [System.Icomparable](/dotnet/api/System.IComparable) interface sur tous les objets de sortie.</span><span class="sxs-lookup"><span data-stu-id="ac16c-278">Implement a [System.Icomparable](/dotnet/api/System.IComparable) interface on all output objects.</span></span> <span data-ttu-id="ac16c-279">Ainsi, les objets de sortie être facilement transmis à diverses applets de commande de tri et l’analyse.</span><span class="sxs-lookup"><span data-stu-id="ac16c-279">This allows the output objects to be easily piped to various sorting and analysis cmdlets.</span></span>

##### <a name="update-display-information"></a><span data-ttu-id="ac16c-280">Mettre à jour les informations d’affichage</span><span class="sxs-lookup"><span data-stu-id="ac16c-280">Update Display Information</span></span>

<span data-ttu-id="ac16c-281">Si l’affichage d’un objet ne fournit pas les résultats attendus, créer un personnalisé  *\<YourProductName >*. Fichier format.ps1xml pour cet objet.</span><span class="sxs-lookup"><span data-stu-id="ac16c-281">If the display for an object does not provide the expected results, create a custom *\<YourProductName>*.Format.ps1xml file for that object.</span></span>

### <a name="support-well-defined-pipeline-input-sc02"></a><span data-ttu-id="ac16c-282">Prise en charge d’entrée de Pipeline bien défini (SC02)</span><span class="sxs-lookup"><span data-stu-id="ac16c-282">Support Well Defined Pipeline Input (SC02)</span></span>

#### <a name="implement-for-the-middle-of-a-pipeline"></a><span data-ttu-id="ac16c-283">Implémentez pour la partie centrale d’un Pipeline</span><span class="sxs-lookup"><span data-stu-id="ac16c-283">Implement for the Middle of a Pipeline</span></span>

<span data-ttu-id="ac16c-284">Implémenter une applet de commande en supposant qu’elle sera appelée à partir du milieu d’un pipeline (autrement dit, autres applets de commande sera produire son entrée ou utiliser sa sortie).</span><span class="sxs-lookup"><span data-stu-id="ac16c-284">Implement a cmdlet assuming that it will be called from the middle of a pipeline (that is, other cmdlets will produce its input or consume its output).</span></span> <span data-ttu-id="ac16c-285">Par exemple, vous pouvez supposer que le `Get-Process` applet de commande, car elle génère des données, est utilisé uniquement comme la première applet de commande dans un pipeline.</span><span class="sxs-lookup"><span data-stu-id="ac16c-285">For example, you might assume that the `Get-Process` cmdlet, because it generates data, is used only as the first cmdlet in a pipeline.</span></span> <span data-ttu-id="ac16c-286">Toutefois, étant donné que cette applet de commande est destinée au milieu d’un pipeline, cette applet de commande permet d’applets de commande précédente ou les données dans le pipeline pour spécifier les processus à récupérer.</span><span class="sxs-lookup"><span data-stu-id="ac16c-286">However, because this cmdlet is designed for the middle of a pipeline, this cmdlet allows previous cmdlets or data in the pipeline to specify the processes to retrieve.</span></span>

#### <a name="support-input-from-the-pipeline"></a><span data-ttu-id="ac16c-287">Entrée de prise en charge du pipeline</span><span class="sxs-lookup"><span data-stu-id="ac16c-287">Support Input from the Pipeline</span></span>

<span data-ttu-id="ac16c-288">Dans chaque jeu de paramètres pour une applet de commande, inclure au moins un paramètre qui prend en charge d’entrée provenant du pipeline.</span><span class="sxs-lookup"><span data-stu-id="ac16c-288">In each parameter set for a cmdlet, include at least one parameter that supports input from the pipeline.</span></span> <span data-ttu-id="ac16c-289">Prise en charge pour l’entrée de pipeline permet à l’utilisateur à récupérer des données ou objets, de les envoyer à l’ensemble de paramètres corrects et pour passer les résultats directement à une applet de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-289">Support for pipeline input allows the user to retrieve data or objects, to send them to the correct parameter set, and to pass the results directly to a cmdlet.</span></span>

<span data-ttu-id="ac16c-290">Un paramètre accepte une entrée du pipeline si la **paramètre** attribut inclut le `ValueFromPipeline` mot clé, le `ValueFromPipelineByPropertyName` attribut de mot clé, ou les deux mots clés dans sa déclaration.</span><span class="sxs-lookup"><span data-stu-id="ac16c-290">A parameter accepts input from the pipeline if the **Parameter** attribute includes the `ValueFromPipeline` keyword, the `ValueFromPipelineByPropertyName` keyword attribute, or both keywords in its  declaration.</span></span> <span data-ttu-id="ac16c-291">Si aucun des paramètres dans un paramètre de prise en charge set le `ValueFromPipeline` ou `ValueFromPipelineByPropertyName` mots clés, l’applet de commande concrètement ne peut pas être placés après une autre applet de commande, car il ignore toute entrée de pipeline.</span><span class="sxs-lookup"><span data-stu-id="ac16c-291">If none of the parameters in a parameter set support the `ValueFromPipeline` or `ValueFromPipelineByPropertyName` keywords, the cmdlet cannot meaningfully be placed after another cmdlet because it will ignore any pipeline input.</span></span>

#### <a name="support-the-processrecord-method"></a><span data-ttu-id="ac16c-292">Prend en charge la méthode ProcessRecord</span><span class="sxs-lookup"><span data-stu-id="ac16c-292">Support the ProcessRecord Method</span></span>

<span data-ttu-id="ac16c-293">Pour accepter tous les enregistrements à partir de l’applet de commande précédent dans le pipeline, votre applet de commande doit implémenter le [System.Management.Automation.Cmdlet.Processrecord\*](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) (méthode).</span><span class="sxs-lookup"><span data-stu-id="ac16c-293">To accept all the records from the preceding cmdlet in the pipeline, your cmdlet must implement the [System.Management.Automation.Cmdlet.Processrecord\*](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method.</span></span> <span data-ttu-id="ac16c-294">Windows PowerShell appelle cette méthode plusieurs fois, une fois pour chaque enregistrement qui est envoyé à votre applet de commande.</span><span class="sxs-lookup"><span data-stu-id="ac16c-294">Windows PowerShell calls this method multiple times, once for every record that is sent to your cmdlet.</span></span>

### <a name="write-single-records-to-the-pipeline-sc03"></a><span data-ttu-id="ac16c-295">Écrire des enregistrements uniques dans le Pipeline (SC03)</span><span class="sxs-lookup"><span data-stu-id="ac16c-295">Write Single Records to the Pipeline (SC03)</span></span>

<span data-ttu-id="ac16c-296">Quand une applet de commande retourne des objets, l’applet de commande doit écrire les objets immédiatement qu’ils sont générés.</span><span class="sxs-lookup"><span data-stu-id="ac16c-296">When a cmdlet returns objects, the cmdlet should write the objects immediately as they are generated.</span></span> <span data-ttu-id="ac16c-297">L’applet de commande ne devriez pas les conserver afin de les mettre en mémoire tampon dans un tableau combiné.</span><span class="sxs-lookup"><span data-stu-id="ac16c-297">The cmdlet should not hold them in order to buffer them into a combined array.</span></span> <span data-ttu-id="ac16c-298">Les applets de commande qui reçoivent les objets en tant qu’entrée sera ensuite en mesure de traiter, afficher, ou traiter et afficher les objets de sortie sans délai.</span><span class="sxs-lookup"><span data-stu-id="ac16c-298">The cmdlets that receive the objects as input will then be able to process, display, or process and display the output objects without delay.</span></span> <span data-ttu-id="ac16c-299">Objets d’une applet de commande qui génère une sortie à la fois doit appeler le [System.Management.Automation.Cmdlet.Writeobject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) (méthode).</span><span class="sxs-lookup"><span data-stu-id="ac16c-299">A cmdlet that generates output objects one at a time should call the [System.Management.Automation.Cmdlet.Writeobject](/dotnet/api/System.Management.Automation.Cmdlet.WriteObject) method.</span></span> <span data-ttu-id="ac16c-300">Une applet de commande qui génère des objets de sortie par lots (par exemple, car une API sous-jacente retourne un tableau d’objets de sortie) doit appeler la [System.Managemet.Automation.Cmdlet.Writeobject](/dotnet/api/System.Managemet.Automation.Cmdlet.WriteObject) défini avec son deuxième paramètre (méthode) à `true`.</span><span class="sxs-lookup"><span data-stu-id="ac16c-300">A cmdlet that generates output objects in batches (for example, because an underlying API returns an array of output objects) should call the [System.Managemet.Automation.Cmdlet.Writeobject](/dotnet/api/System.Managemet.Automation.Cmdlet.WriteObject) Method with its second parameter set to `true`.</span></span>

### <a name="make-cmdlets-case-insensitive-and-case-preserving-sc04"></a><span data-ttu-id="ac16c-301">Rendre les applets de commande non-respect de la casse et de la casse (SC04)</span><span class="sxs-lookup"><span data-stu-id="ac16c-301">Make Cmdlets Case-Insensitive and Case-Preserving (SC04)</span></span>

<span data-ttu-id="ac16c-302">Par défaut, Windows PowerShell respecte la casse.</span><span class="sxs-lookup"><span data-stu-id="ac16c-302">By default, Windows PowerShell itself is case-insensitive.</span></span> <span data-ttu-id="ac16c-303">Toutefois, comme il traite avec de nombreux systèmes préexistants, Windows PowerShell conserve les cas pour la facilité de fonctionnement et de compatibilité.</span><span class="sxs-lookup"><span data-stu-id="ac16c-303">However, because it deals with many preexisting systems, Windows PowerShell does preserve case for ease of operation and compatibility.</span></span> <span data-ttu-id="ac16c-304">En d’autres termes, si un caractère est fourni en lettres majuscules, Windows PowerShell met constamment en lettres majuscules.</span><span class="sxs-lookup"><span data-stu-id="ac16c-304">In other words, if a character is supplied in uppercase letters, Windows PowerShell keeps it in uppercase letters.</span></span> <span data-ttu-id="ac16c-305">Pour les systèmes pour un fonctionnement optimal, une applet de commande doit suivre cette convention.</span><span class="sxs-lookup"><span data-stu-id="ac16c-305">For systems to work well, a cmdlet needs to follow this convention.</span></span> <span data-ttu-id="ac16c-306">Si possible, il doit fonctionner de la casse.</span><span class="sxs-lookup"><span data-stu-id="ac16c-306">If possible, it should operate in a case-insensitive way.</span></span> <span data-ttu-id="ac16c-307">Il doit, cependant, conserver le cas d’origine pour les applets de commande qui se produisent ultérieurement dans une commande ou dans le pipeline.</span><span class="sxs-lookup"><span data-stu-id="ac16c-307">It should, however, preserve the original case for cmdlets that occur later in a command or in the pipeline.</span></span>

## <a name="see-also"></a><span data-ttu-id="ac16c-308">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ac16c-308">See Also</span></span>

[<span data-ttu-id="ac16c-309">Directives de développement requis</span><span class="sxs-lookup"><span data-stu-id="ac16c-309">Required Development Guidelines</span></span>](./required-development-guidelines.md)

[<span data-ttu-id="ac16c-310">Directives de développement de Conseil</span><span class="sxs-lookup"><span data-stu-id="ac16c-310">Advisory Development Guidelines</span></span>](./advisory-development-guidelines.md)

[<span data-ttu-id="ac16c-311">Écriture d’une applet de commande Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="ac16c-311">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)
