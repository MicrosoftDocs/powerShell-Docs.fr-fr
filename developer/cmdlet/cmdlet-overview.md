---
title: Vue d’ensemble de l’applet de commande | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- cmdlets [PowerShell SDK]
- cmdlets [PowerShell SDK], described
ms.assetid: 0aa32589-4447-4ead-a5dd-a3be99113140
caps.latest.revision: 21
ms.openlocfilehash: 14200aed2fb94c37c8b8af29650f602945e7ac1c
ms.sourcegitcommit: 58fb23c854f5a8b40ad1f952d3323aeeccac7a24
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/07/2019
ms.locfileid: "65229364"
---
# <a name="cmdlet-overview"></a><span data-ttu-id="065fb-102">Vue d’ensemble des applets de commande</span><span class="sxs-lookup"><span data-stu-id="065fb-102">Cmdlet Overview</span></span>

<span data-ttu-id="065fb-103">Une applet de commande est une commande légère utilisée dans l’environnement Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="065fb-103">A cmdlet is a lightweight command that is used in the Windows PowerShell environment.</span></span> <span data-ttu-id="065fb-104">Le runtime de Windows PowerShell appelle ces applets de commande dans le contexte des scripts d’automatisation qui sont fournies à la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-104">The Windows PowerShell runtime invokes these cmdlets within the context of automation scripts that are provided at the command line.</span></span> <span data-ttu-id="065fb-105">Le runtime Windows PowerShell également les appelle par programme via Windows APIs PowerShell.</span><span class="sxs-lookup"><span data-stu-id="065fb-105">The Windows PowerShell runtime also invokes them programmatically through Windows PowerShell APIs.</span></span>

## <a name="cmdlets"></a><span data-ttu-id="065fb-106">Applets de commande</span><span class="sxs-lookup"><span data-stu-id="065fb-106">Cmdlets</span></span>

<span data-ttu-id="065fb-107">Applets de commande effectuent une action et retournent généralement un objet Microsoft .NET Framework à la commande suivante dans le pipeline.</span><span class="sxs-lookup"><span data-stu-id="065fb-107">Cmdlets perform an action and typically return a Microsoft .NET Framework object to the next command in the pipeline.</span></span> <span data-ttu-id="065fb-108">Pour écrire une applet de commande, vous devez implémenter une classe d’applet de commande qui dérive d’une des deux classes de base d’applet de commande spécialisé.</span><span class="sxs-lookup"><span data-stu-id="065fb-108">To write a cmdlet, you must implement a cmdlet class that derives from one of two specialized cmdlet base classes.</span></span> <span data-ttu-id="065fb-109">La classe dérivée doit :</span><span class="sxs-lookup"><span data-stu-id="065fb-109">The derived class must:</span></span>

- <span data-ttu-id="065fb-110">Déclarer un attribut qui identifie la classe dérivée en tant qu’une applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-110">Declare an attribute that identifies the derived class as a cmdlet.</span></span>

- <span data-ttu-id="065fb-111">Définir des propriétés publiques qui sont décorées avec des attributs qui identifient les propriétés publiques en tant que paramètres de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-111">Define public properties that are decorated with attributes that identify the public properties as cmdlet parameters.</span></span>

- <span data-ttu-id="065fb-112">Substituez une ou plusieurs de l’entrée de méthodes pour traiter les enregistrements de traitement.</span><span class="sxs-lookup"><span data-stu-id="065fb-112">Override one or more of the input processing methods to process records.</span></span>

<span data-ttu-id="065fb-113">Vous pouvez charger l’assembly qui contient la classe directement à l’aide du [Import-Module](/powershell/module/microsoft.powershell.core/import-module) applet de commande, ou vous pouvez créer une application hôte qui charge l’assembly à l’aide de la [ System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API.</span><span class="sxs-lookup"><span data-stu-id="065fb-113">You can load the assembly that contains the class directly by using the [Import-Module](/powershell/module/microsoft.powershell.core/import-module) cmdlet, or you can create a host application that loads the assembly by using the [System.Management.Automation.Runspaces.Initialsessionstate](/dotnet/api/System.Management.Automation.Runspaces.InitialSessionState) API.</span></span> <span data-ttu-id="065fb-114">Les deux méthodes fournissent un accès par programmation et de ligne de commande pour les fonctionnalités de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-114">Both methods provide programmatic and command-line access to the functionality of the cmdlet.</span></span>

## <a name="cmdlet-terms"></a><span data-ttu-id="065fb-115">Termes du contrat de l’applet de commande</span><span class="sxs-lookup"><span data-stu-id="065fb-115">Cmdlet Terms</span></span>

<span data-ttu-id="065fb-116">Les termes suivants sont fréquemment utilisées dans la documentation d’applet de commande Windows PowerShell :</span><span class="sxs-lookup"><span data-stu-id="065fb-116">The following terms are used frequently in the Windows PowerShell cmdlet documentation:</span></span>

### <a name="cmdlet-attribute"></a><span data-ttu-id="065fb-117">Attribut de l’applet de commande</span><span class="sxs-lookup"><span data-stu-id="065fb-117">Cmdlet attribute</span></span>

<span data-ttu-id="065fb-118">Un attribut .NET Framework qui est utilisé pour déclarer une classe de l’applet de commande comme une applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-118">A .NET Framework attribute that is used to declare a cmdlet class as a cmdlet.</span></span>
<span data-ttu-id="065fb-119">Bien que PowerShell utilise plusieurs autres attributs sont facultatifs, l’attribut de l’applet de commande est requis.</span><span class="sxs-lookup"><span data-stu-id="065fb-119">Although PowerShell uses several other attributes that are optional, the Cmdlet attribute is required.</span></span>
<span data-ttu-id="065fb-120">Pour plus d’informations sur cet attribut, consultez [déclaration d’attribut applet de commande](cmdlet-attribute-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-120">For more information about this attribute, see [Cmdlet Attribute Declaration](cmdlet-attribute-declaration.md).</span></span>

### <a name="cmdlet-parameter"></a><span data-ttu-id="065fb-121">Paramètre d'applet de commande</span><span class="sxs-lookup"><span data-stu-id="065fb-121">Cmdlet parameter</span></span>

<span data-ttu-id="065fb-122">Les propriétés publiques qui définissent les paramètres qui sont disponibles à l’utilisateur ou à l’application qui exécute l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-122">The public properties that define the parameters that are available to the user or to the application that is running the cmdlet.</span></span>
<span data-ttu-id="065fb-123">Applets de commande peut avoir requis, nommé, positionnels, et *basculer* paramètres.</span><span class="sxs-lookup"><span data-stu-id="065fb-123">Cmdlets can have required, named, positional, and *switch* parameters.</span></span>
<span data-ttu-id="065fb-124">Paramètres de commutateur permettent de définir des paramètres qui sont évaluées uniquement si les paramètres sont spécifiés dans l’appel.</span><span class="sxs-lookup"><span data-stu-id="065fb-124">Switch parameters allow you to define parameters that are evaluated only if the parameters are specified in the call.</span></span>
<span data-ttu-id="065fb-125">Pour plus d’informations sur les différents types de paramètres, consultez [paramètres de l’applet de commande](cmdlet-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-125">For more information about the different types of parameters, see [Cmdlet Parameters](cmdlet-parameters.md).</span></span>

### <a name="parameter-set"></a><span data-ttu-id="065fb-126">Jeu de paramètres</span><span class="sxs-lookup"><span data-stu-id="065fb-126">Parameter set</span></span>

<span data-ttu-id="065fb-127">Groupe de paramètres qui peut être utilisé dans la même commande pour effectuer une action spécifique.</span><span class="sxs-lookup"><span data-stu-id="065fb-127">A group of parameters that can be used in the same command to perform a specific action.</span></span>
<span data-ttu-id="065fb-128">Une applet de commande peut avoir plusieurs jeux de paramètres, mais chaque jeu de paramètres doit avoir au moins un paramètre qui est unique.</span><span class="sxs-lookup"><span data-stu-id="065fb-128">A cmdlet can have multiple parameter sets, but each parameter set must have at least one parameter that is unique.</span></span>
<span data-ttu-id="065fb-129">Conception de l’applet de commande bonne suggère fortement que le paramètre unique doit également être un paramètre obligatoire.</span><span class="sxs-lookup"><span data-stu-id="065fb-129">Good cmdlet design strongly suggests that the unique parameter also be a required parameter.</span></span>
<span data-ttu-id="065fb-130">Pour plus d’informations sur les jeux de paramètres, consultez [définit des paramètres d’applet de commande](cmdlet-parameter-sets.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-130">For more information about parameter sets, see [Cmdlet Parameter Sets](cmdlet-parameter-sets.md).</span></span>

### <a name="dynamic-parameter"></a><span data-ttu-id="065fb-131">Paramètre dynamique</span><span class="sxs-lookup"><span data-stu-id="065fb-131">Dynamic parameter</span></span>

<span data-ttu-id="065fb-132">Un paramètre qui est ajouté à l’applet de commande lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="065fb-132">A parameter that is added to the cmdlet at runtime.</span></span>
<span data-ttu-id="065fb-133">En règle générale, les paramètres dynamiques sont ajoutés à l’applet de commande quand un autre paramètre est défini sur une valeur spécifique.</span><span class="sxs-lookup"><span data-stu-id="065fb-133">Typically, the dynamic parameters are added to the cmdlet when another parameter is set to a specific value.</span></span>
<span data-ttu-id="065fb-134">Pour plus d’informations sur les paramètres dynamiques, consultez [applet de commande des paramètres dynamiques](cmdlet-dynamic-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-134">For more information about dynamic parameters, see [Cmdlet Dynamic Parameters](cmdlet-dynamic-parameters.md).</span></span>

### <a name="input-processing-method"></a><span data-ttu-id="065fb-135">Méthode de traitement d’entrée</span><span class="sxs-lookup"><span data-stu-id="065fb-135">Input processing method</span></span>

<span data-ttu-id="065fb-136">Méthode qu’une applet de commande peut utiliser pour traiter les enregistrements qu’elle reçoit en entrée.</span><span class="sxs-lookup"><span data-stu-id="065fb-136">A method that a cmdlet can use to process the records it receives as input.</span></span>
<span data-ttu-id="065fb-137">Les méthodes de traitement d’entrée incluent la [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) (méthode), le [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) (méthode), le [ System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) (méthode) et le [System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing) (méthode).</span><span class="sxs-lookup"><span data-stu-id="065fb-137">The input processing methods include the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method, the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method, the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method, and the [System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing) method.</span></span> <span data-ttu-id="065fb-138">Lorsque vous implémentez une applet de commande, vous devez substituer au moins de la [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing), [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord)et [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) méthodes.</span><span class="sxs-lookup"><span data-stu-id="065fb-138">When you implement a cmdlet, you must override at least one of the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing), [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord), and [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) methods.</span></span>
<span data-ttu-id="065fb-139">En règle générale, le [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) méthode est la méthode que vous substituez parce qu’elle est appelée pour chaque enregistrement qui traite de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-139">Typically, the [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method is the method that you override because it is called for every record that the cmdlet processes.</span></span>
<span data-ttu-id="065fb-140">En revanche, le [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) (méthode) et le [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) méthode est appelée une fois pour effectuer prétraitement ou de post-traitement des enregistrements.</span><span class="sxs-lookup"><span data-stu-id="065fb-140">In contrast, the [System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing) method and the [System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing) method are called one time to perform pre-processing or post-processing of the records.</span></span>
<span data-ttu-id="065fb-141">Pour plus d’informations sur ces méthodes, consultez [méthodes de traitement d’entrée](cmdlet-input-processing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-141">For more information about these methods, see [Input Processing Methods](cmdlet-input-processing-methods.md).</span></span>

### <a name="shouldprocess-feature"></a><span data-ttu-id="065fb-142">Fonctionnalité de ShouldProcess</span><span class="sxs-lookup"><span data-stu-id="065fb-142">ShouldProcess feature</span></span>

<span data-ttu-id="065fb-143">PowerShell vous permet de créer des applets de commande qui invite l’utilisateur pour envoyer des commentaires avant que l’applet de commande effectue une modification dans le système.</span><span class="sxs-lookup"><span data-stu-id="065fb-143">PowerShell allows you to create cmdlets that prompt the user for feedback before the cmdlet makes a change to the system.</span></span>
<span data-ttu-id="065fb-144">Pour utiliser cette fonctionnalité, l’applet de commande doit déclarer qu’il prend en charge la fonctionnalité de ShouldProcess quand vous déclarez l’attribut de l’applet de commande et l’applet de commande doit appeler le [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) et [ System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) méthodes à partir d’au sein d’une méthode de traitement des entrées.</span><span class="sxs-lookup"><span data-stu-id="065fb-144">To use this feature, the cmdlet must declare that it supports the ShouldProcess feature when you declare the Cmdlet attribute, and the cmdlet must call the [System.Management.Automation.Cmdlet.ShouldProcess](/dotnet/api/System.Management.Automation.Cmdlet.ShouldProcess) and [System.Management.Automation.Cmdlet.ShouldContinue](/dotnet/api/System.Management.Automation.Cmdlet.ShouldContinue) methods from within an input processing method.</span></span>
<span data-ttu-id="065fb-145">Pour plus d’informations sur la prise en charge la fonctionnalité de ShouldProcess, consultez [demande une Confirmation](requesting-confirmation-from-cmdlets.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-145">For more information about how to support the ShouldProcess functionality, see [Requesting Confirmation](requesting-confirmation-from-cmdlets.md).</span></span>

### <a name="transaction"></a><span data-ttu-id="065fb-146">Transaction</span><span class="sxs-lookup"><span data-stu-id="065fb-146">Transaction</span></span>

<span data-ttu-id="065fb-147">Un groupe logique de commandes qui sont traitées comme une seule tâche.</span><span class="sxs-lookup"><span data-stu-id="065fb-147">A logical group of commands that are treated as a single task.</span></span>
<span data-ttu-id="065fb-148">Automatiquement, la tâche échoue si une commande dans le groupe échoue et l’utilisateur a le choix d’accepter ou rejeter les actions effectuées au sein de la transaction.</span><span class="sxs-lookup"><span data-stu-id="065fb-148">The task automatically fails if any command in the group fails, and the user has the choice to accept or reject the actions performed within the transaction.</span></span>
<span data-ttu-id="065fb-149">Pour participer à une transaction, l’applet de commande doit être déclarée qu’il prend en charge les transactions lorsque l’attribut de l’applet de commande est déclaré.</span><span class="sxs-lookup"><span data-stu-id="065fb-149">To participate in a transaction, the cmdlet must declare that it supports transactions when the Cmdlet attribute is declared.</span></span>
<span data-ttu-id="065fb-150">Prise en charge des transactions a été introduite dans Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="065fb-150">Support for transactions was introduced in Windows PowerShell 2.0.</span></span>
<span data-ttu-id="065fb-151">Pour plus d’informations sur les transactions, consultez [comment la prise en charge des Transactions](how-to-support-transactions.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-151">For more information about transactions, see [How to Support Transactions](how-to-support-transactions.md).</span></span>

## <a name="how-cmdlets-differ-from-commands"></a><span data-ttu-id="065fb-152">Comment diffèrent des applets de commande des commandes</span><span class="sxs-lookup"><span data-stu-id="065fb-152">How Cmdlets Differ from Commands</span></span>

<span data-ttu-id="065fb-153">Applets de commande diffèrent des commandes dans d’autres environnements de l’interface de commande comme suit :</span><span class="sxs-lookup"><span data-stu-id="065fb-153">Cmdlets differ from commands in other command-shell environments in the following ways:</span></span>

- <span data-ttu-id="065fb-154">Applets de commande sont des instances de classes .NET Framework ; ils ne sont pas exécutables autonomes.</span><span class="sxs-lookup"><span data-stu-id="065fb-154">Cmdlets are instances of .NET Framework classes; they are not stand-alone executables.</span></span>

- <span data-ttu-id="065fb-155">Applets de commande peuvent être créés à partir d’une dizaine de lignes de code seulement.</span><span class="sxs-lookup"><span data-stu-id="065fb-155">Cmdlets can be created from as few as a dozen lines of code.</span></span>

- <span data-ttu-id="065fb-156">Applets de commande ne procédez pas généralement leurs propres l’analyse, présentation de l’erreur ou la mise en forme de sortie.</span><span class="sxs-lookup"><span data-stu-id="065fb-156">Cmdlets do not generally do their own parsing, error presentation, or output formatting.</span></span> <span data-ttu-id="065fb-157">L’analyse, la présentation de l’erreur et la mise en forme de sortie sont gérées par le runtime de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="065fb-157">Parsing, error presentation, and output formatting are handled by the Windows PowerShell runtime.</span></span>

- <span data-ttu-id="065fb-158">Processus des applets de commande d’entrée d’objets du pipeline, plutôt qu’à partir de flux de texte et applets de commande fournissent généralement des objets en tant que sortie au pipeline.</span><span class="sxs-lookup"><span data-stu-id="065fb-158">Cmdlets process input objects from the pipeline rather than from streams of text, and cmdlets typically deliver objects as output to the pipeline.</span></span>

- <span data-ttu-id="065fb-159">Applets de commande sont orientées par enregistrement, car ils traitent un seul objet à la fois.</span><span class="sxs-lookup"><span data-stu-id="065fb-159">Cmdlets are record-oriented because they process a single object at a time.</span></span>

## <a name="cmdlet-base-classes"></a><span data-ttu-id="065fb-160">Classes de Base de l’applet de commande</span><span class="sxs-lookup"><span data-stu-id="065fb-160">Cmdlet Base Classes</span></span>

<span data-ttu-id="065fb-161">Windows PowerShell prend en charge les applets de commande qui sont dérivées de deux classes de base suivantes.</span><span class="sxs-lookup"><span data-stu-id="065fb-161">Windows PowerShell supports cmdlets that are derived from the following two base classes.</span></span>

- <span data-ttu-id="065fb-162">La plupart des applets de commande sont basées sur les classes de .NET Framework qui dérivent de la [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) classe de base.</span><span class="sxs-lookup"><span data-stu-id="065fb-162">Most cmdlets are based on .NET Framework classes that derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) base class.</span></span> <span data-ttu-id="065fb-163">Dérivation à partir de cette classe permet à une applet de commande à utiliser l’ensemble minimal de dépendances sur le runtime de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="065fb-163">Deriving from this class allows a cmdlet to use the minimum set of dependencies on the Windows PowerShell runtime.</span></span> <span data-ttu-id="065fb-164">Cela présente deux avantages.</span><span class="sxs-lookup"><span data-stu-id="065fb-164">This has two benefits.</span></span> <span data-ttu-id="065fb-165">Le premier avantage est que les objets de l’applet de commande sont plus petits, et vous êtes moins susceptible d’être affecté par les modifications à l’exécution de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="065fb-165">The first benefit is that the cmdlet objects are smaller, and you are less likely to be affected by changes to the Windows PowerShell runtime.</span></span> <span data-ttu-id="065fb-166">Le deuxième avantage est que, si vous devez, vous pouvez créer directement une instance de l’objet de l’applet de commande, puis l’appeler directement au lieu d’appeler via le runtime de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="065fb-166">The second benefit is that, if you have to, you can directly create an instance of the cmdlet object and then invoke it directly instead of invoking it through the Windows PowerShell runtime.</span></span>

- <span data-ttu-id="065fb-167">Les applets de commande plus complexes sont basés sur les classes .NET Framework qui dérivent de la [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) classe de base.</span><span class="sxs-lookup"><span data-stu-id="065fb-167">The more-complex cmdlets are based on .NET Framework classes that derive from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) base class.</span></span> <span data-ttu-id="065fb-168">Dérivation à partir de cette classe vous donne un accès beaucoup plus à l’exécution de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="065fb-168">Deriving from this class gives you much more access to the Windows PowerShell runtime.</span></span> <span data-ttu-id="065fb-169">Cet accès permet à votre applet de commande à appeler des scripts, pour accéder aux fournisseurs et à accéder à l’état de session en cours.</span><span class="sxs-lookup"><span data-stu-id="065fb-169">This access allows your cmdlet to call scripts, to access providers, and to access the current session state.</span></span> <span data-ttu-id="065fb-170">(Pour accéder à l’état de session actuel, vous obtenez et définissez les préférences et les variables de session.) Toutefois, dérivation à partir de cette classe augmente la taille de l’objet de l’applet de commande, et cela signifie que votre applet de commande est plus étroitement lié à la version actuelle du runtime Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="065fb-170">(To access the current session state, you get and set session variables and preferences.) However, deriving from this class increases the size of the cmdlet object, and it means that your cmdlet is more tightly coupled to the current version of the Windows PowerShell runtime.</span></span>

<span data-ttu-id="065fb-171">En règle générale, sauf si vous avez besoin de l’accès étendu à l’exécution de Windows PowerShell, vous devez dériver de la [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) classe.</span><span class="sxs-lookup"><span data-stu-id="065fb-171">In general, unless you need the extended access to the Windows PowerShell runtime, you should derive from the [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class.</span></span> <span data-ttu-id="065fb-172">Toutefois, le runtime de Windows PowerShell a des fonctions de journalisation étendues pour l’exécution d’applets de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-172">However, the Windows PowerShell runtime has extensive logging capabilities for the execution of cmdlets.</span></span> <span data-ttu-id="065fb-173">Si votre modèle audit dépend de cette journalisation, vous pouvez empêcher l’exécution de votre applet de commande à partir d’une autre applet de commande en dérivant le [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) classe.</span><span class="sxs-lookup"><span data-stu-id="065fb-173">If your auditing model depends on this logging, you can prevent the execution of your cmdlet from within another cmdlet by deriving from the [System.Management.Automation.PSCmdlet](/dotnet/api/System.Management.Automation.PSCmdlet) class.</span></span>

## <a name="input-processing-methods"></a><span data-ttu-id="065fb-174">Méthodes de traitement d’entrée</span><span class="sxs-lookup"><span data-stu-id="065fb-174">Input Processing Methods</span></span>

<span data-ttu-id="065fb-175">Le [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) classe fournit les méthodes virtuelles suivantes qui sont utilisés pour traiter les enregistrements.</span><span class="sxs-lookup"><span data-stu-id="065fb-175">The [System.Management.Automation.Cmdlet](/dotnet/api/System.Management.Automation.Cmdlet) class provides the following virtual methods that are used to process records.</span></span> <span data-ttu-id="065fb-176">Toutes les classes de l’applet de commande dérivées doivent remplacer une ou plusieurs des trois premières méthodes :</span><span class="sxs-lookup"><span data-stu-id="065fb-176">All the derived cmdlet classes must override one or more of the first three methods:</span></span>

- <span data-ttu-id="065fb-177">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): Utilisé pour fournir une fonctionnalité de prétraitement unique facultative pour l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-177">[System.Management.Automation.Cmdlet.BeginProcessing](/dotnet/api/System.Management.Automation.Cmdlet.BeginProcessing): Used to provide optional one-time, pre-processing functionality for the cmdlet.</span></span>

- <span data-ttu-id="065fb-178">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): Utilisé pour fournir des fonctionnalités de traitement de l’enregistrement par enregistrement pour l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-178">[System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord): Used to provide record-by-record processing functionality for the cmdlet.</span></span> <span data-ttu-id="065fb-179">Le [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) méthode peut être appelée à n’importe quel nombre de fois ou pas du tout, selon les entrées de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-179">The [System.Management.Automation.Cmdlet.ProcessRecord](/dotnet/api/System.Management.Automation.Cmdlet.ProcessRecord) method might be called any number of times, or not at all, depending on the input of the cmdlet.</span></span>

- <span data-ttu-id="065fb-180">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): Utilisé pour fournir une fonctionnalité de post-traitement unique facultative pour l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-180">[System.Management.Automation.Cmdlet.EndProcessing](/dotnet/api/System.Management.Automation.Cmdlet.EndProcessing): Used to provide optional one-time, post-processing functionality for the cmdlet.</span></span>

- <span data-ttu-id="065fb-181">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): Utilisé pour arrêter le traitement lorsque l’utilisateur arrête l’applet de commande de façon asynchrone (par exemple, en appuyant sur CTRL + C).</span><span class="sxs-lookup"><span data-stu-id="065fb-181">[System.Management.Automation.Cmdlet.StopProcessing](/dotnet/api/System.Management.Automation.Cmdlet.StopProcessing): Used to stop processing when the user stops the cmdlet asynchronously (for example,  by pressing CTRL+C).</span></span>

<span data-ttu-id="065fb-182">Pour plus d’informations sur ces méthodes, consultez [méthodes de traitement entrée applet de commande](./cmdlet-input-processing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-182">For more information about these methods, see [Cmdlet Input Processing Methods](./cmdlet-input-processing-methods.md).</span></span>

## <a name="cmdlet-attributes"></a><span data-ttu-id="065fb-183">Attributs des applets de commande</span><span class="sxs-lookup"><span data-stu-id="065fb-183">Cmdlet Attributes</span></span>

<span data-ttu-id="065fb-184">Windows PowerShell définit plusieurs attributs de .NET Framework qui sont utilisées pour gérer des applets de commande et pour spécifier des fonctionnalités communes, qui est fournie par Windows PowerShell et qui peut être requis par l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-184">Windows PowerShell defines several .NET Framework attributes that are used to manage cmdlets and to specify common functionality that is provided by Windows PowerShell and that might be required by the cmdlet.</span></span> <span data-ttu-id="065fb-185">Par exemple, les attributs sont utilisés pour désigner une classe comme une applet de commande pour spécifier les paramètres de l’applet de commande et pour demander la validation d’entrée afin que les développeurs de l’applet de commande n’ont pas à implémenter cette fonctionnalité dans leur code de l’applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-185">For example, attributes are used to designate a class as a cmdlet, to specify the parameters of the cmdlet, and to request the validation of input so that cmdlet developers do not have to implement that functionality in their cmdlet code.</span></span> <span data-ttu-id="065fb-186">Pour plus d’informations sur les attributs, consultez [Windows PowerShell attributs](./cmdlet-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-186">For more information about attributes, see [Windows PowerShell Attributes](./cmdlet-attributes.md).</span></span>

## <a name="cmdlet-names"></a><span data-ttu-id="065fb-187">Noms d’applet de commande</span><span class="sxs-lookup"><span data-stu-id="065fb-187">Cmdlet Names</span></span>

<span data-ttu-id="065fb-188">Windows PowerShell utilise une paire de nom de type verbe-substantif aux applets de commande de nom.</span><span class="sxs-lookup"><span data-stu-id="065fb-188">Windows PowerShell uses a verb-and-noun name pair to name cmdlets.</span></span> <span data-ttu-id="065fb-189">Par exemple, le `Get-Command` applet de commande inclus dans Windows PowerShell est utilisé pour obtenir toutes les applets de commande qui sont inscrits dans l’interface de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-189">For example, the `Get-Command` cmdlet included in Windows PowerShell is used to get all the cmdlets that are registered in the command shell.</span></span> <span data-ttu-id="065fb-190">Le verbe identifie l’action qui exécute l’applet de commande, et le substantif identifie la ressource sur laquelle l’applet de commande effectue son action.</span><span class="sxs-lookup"><span data-stu-id="065fb-190">The verb identifies the action that the cmdlet performs, and the noun identifies the resource on which the cmdlet performs its action.</span></span>

<span data-ttu-id="065fb-191">Ces noms sont spécifiés lors de la classe .NET Framework est déclarée comme une applet de commande.</span><span class="sxs-lookup"><span data-stu-id="065fb-191">These names are specified when the .NET Framework class is declared as a cmdlet.</span></span> <span data-ttu-id="065fb-192">Pour plus d’informations sur la façon de déclarer une classe .NET Framework en tant qu’une applet de commande, consultez [déclaration d’attribut applet de commande](./cmdlet-class-declaration.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-192">For more information about how to declare a .NET Framework class as a cmdlet, see [Cmdlet Attribute Declaration](./cmdlet-class-declaration.md).</span></span>

## <a name="writing-cmdlet-code"></a><span data-ttu-id="065fb-193">Écriture de Code applet de commande</span><span class="sxs-lookup"><span data-stu-id="065fb-193">Writing Cmdlet Code</span></span>

<span data-ttu-id="065fb-194">Ce document fournit deux méthodes pour découvrir comment le code de l’applet de commande est écrit.</span><span class="sxs-lookup"><span data-stu-id="065fb-194">This document provides two ways to discover how cmdlet code is written.</span></span> <span data-ttu-id="065fb-195">Si vous préférez afficher le code sans trop d’explications, consultez [exemples de Code d’applet de commande](./examples-of-cmdlet-code.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-195">If you prefer to see the code without much explanation, see [Examples of Cmdlet Code](./examples-of-cmdlet-code.md).</span></span> <span data-ttu-id="065fb-196">Si vous préférez une explication plus détaillée concernant le code, consultez le [GetProc didacticiel](./getproc-tutorial.md), [StopProc didacticiel](./stopproc-tutorial.md), ou [SelectStr didacticiel](./selectstr-tutorial.md) rubriques.</span><span class="sxs-lookup"><span data-stu-id="065fb-196">If you prefer more explanation about the code, see the [GetProc Tutorial](./getproc-tutorial.md),  [StopProc Tutorial](./stopproc-tutorial.md), or [SelectStr Tutorial](./selectstr-tutorial.md) topics.</span></span>

<span data-ttu-id="065fb-197">Pour plus d’informations sur les instructions pour les applets de commande écriture, consultez [directives de développement d’applet de commande](./cmdlet-development-guidelines.md).</span><span class="sxs-lookup"><span data-stu-id="065fb-197">For more information about the guidelines for writing cmdlets, see [Cmdlet Development Guidelines](./cmdlet-development-guidelines.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="065fb-198">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="065fb-198">See Also</span></span>

[<span data-ttu-id="065fb-199">Concepts d’applet de commande PowerShell de Windows</span><span class="sxs-lookup"><span data-stu-id="065fb-199">Windows PowerShell Cmdlet Concepts</span></span>](./windows-powershell-cmdlet-concepts.md)

[<span data-ttu-id="065fb-200">Écriture d’une applet de commande Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="065fb-200">Writing a Windows PowerShell Cmdlet</span></span>](./writing-a-windows-powershell-cmdlet.md)

[<span data-ttu-id="065fb-201">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="065fb-201">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)
