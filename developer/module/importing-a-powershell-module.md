---
title: Importation d’un Module PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 697791b3-2135-4a39-b9d7-8566ed67acf2
caps.latest.revision: 13
ms.openlocfilehash: bb5d036e5658c365a4fafa2cac05c0bba9f87019
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/03/2019
ms.locfileid: "56854055"
---
# <a name="importing-a-powershell-module"></a><span data-ttu-id="8b5ff-102">Importation d’un module PowerShell</span><span class="sxs-lookup"><span data-stu-id="8b5ff-102">Importing a PowerShell Module</span></span>

<span data-ttu-id="8b5ff-103">Une fois votre avez installé un module sur un système, vous pouvez importer le module.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-103">Once your have installed a module on a system, you will likely want to import the module.</span></span> <span data-ttu-id="8b5ff-104">L’importation d’est le processus qui charge le module dans la mémoire active, afin qu’un utilisateur puisse accéder à ce module dans leur session PowerShell.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-104">Importing is the process that loads the module into active memory, so that a user can access that module in their PowerShell session.</span></span> <span data-ttu-id="8b5ff-105">Dans PowerShell 2.0, vous pouvez importer un module PowerShell qui vient d’être installé avec un appel à [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) applet de commande.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-105">In PowerShell 2.0, you can import a newly-installed PowerShell module with a call to [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet.</span></span> <span data-ttu-id="8b5ff-106">Dans PowerShell 3.0, PowerShell est en mesure d’importer implicitement un module lorsque l’une des fonctions ou des applets de commande dans le module est appelée par un utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-106">In PowerShell 3.0, PowerShell is able to implicitly import a module when one of the functions or cmdlets in the module is called by a user.</span></span> <span data-ttu-id="8b5ff-107">Notez que les deux versions supposent que vous installez votre module dans un emplacement où PowerShell peut s’avérer ; Pour plus d’informations, consultez [installation d’un PowerShell Module](./installing-a-powershell-module.md).</span><span class="sxs-lookup"><span data-stu-id="8b5ff-107">Note that both versions assume that you install your module in a location where PowerShell is able to find it; for more information, see [Installing a PowerShell Module](./installing-a-powershell-module.md).</span></span> <span data-ttu-id="8b5ff-108">Un manifeste de module permet de restreindre les parties de votre module sont exportées, et vous pouvez utiliser les paramètres de la `Import-Module` appel pour restreindre les parties sont importés.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-108">You can use a module manifest to restrict what parts of your module are exported, and you can use parameters of the `Import-Module` call to restrict what parts are imported.</span></span>

## <a name="importing-a-snap-in-powershell-10"></a><span data-ttu-id="8b5ff-109">Importation d’un composant logiciel enfichable (PowerShell 1.0)</span><span class="sxs-lookup"><span data-stu-id="8b5ff-109">Importing a Snap-In (PowerShell 1.0)</span></span>

<span data-ttu-id="8b5ff-110">Modules n’existait pas dans PowerShell 1.0 : au lieu de cela, vous deviez enregistrer et utiliser des composants logiciel enfichables. Toutefois, il est déconseillé que vous utilisez cette technologie à ce stade, comme les modules sont généralement plus faciles à installer et importer.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-110">Modules did not exist in PowerShell 1.0: instead, you had to register and use snap-ins. However, it is not recommended that you use this technology at this point, as modules are generally easier to install and import.</span></span> <span data-ttu-id="8b5ff-111">Pour plus d’informations, consultez [comment créer un Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="8b5ff-111">For more information, see [How to Create a Windows PowerShell Snap-in](../cmdlet/how-to-create-a-windows-powershell-snap-in.md).</span></span>

## <a name="importing-a-module-with-import-module-powershell-20"></a><span data-ttu-id="8b5ff-112">Importation d’un Module avec Import-Module (PowerShell 2.0)</span><span class="sxs-lookup"><span data-stu-id="8b5ff-112">Importing a Module with Import-Module (PowerShell 2.0)</span></span>

<span data-ttu-id="8b5ff-113">PowerShell 2.0 utilise le nommé de manière adéquate [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) applet de commande pour importer des modules.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-113">PowerShell 2.0 uses the appropriately-named [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet to import modules.</span></span> <span data-ttu-id="8b5ff-114">Lors de l’exécution de cette applet de commande, Windows PowerShell recherche le module spécifié dans les répertoires spécifiés dans le `PSModulePath` variable.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-114">When this cmdlet is run, Windows PowerShell searches for the specified module within the directories specified in the `PSModulePath` variable.</span></span> <span data-ttu-id="8b5ff-115">Lorsque le répertoire spécifié est trouvé, Windows PowerShell recherche les fichiers dans l’ordre suivant : fichiers de manifeste de module (.psd1), fichiers de script module (.psm1), fichiers de module binaire (.dll).</span><span class="sxs-lookup"><span data-stu-id="8b5ff-115">When the specified directory is found, Windows PowerShell searches for files in the following order: module manifest files (.psd1), script module files (.psm1), binary module files (.dll).</span></span> <span data-ttu-id="8b5ff-116">Pour plus d’informations sur l’ajout de répertoires à la recherche, consultez [modifier le chemin d’Installation de PSModulePath](./modifying-the-psmodulepath-installation-path.md).</span><span class="sxs-lookup"><span data-stu-id="8b5ff-116">For more information about adding directories to the search, see [Modifying the PSModulePath Installation Path](./modifying-the-psmodulepath-installation-path.md).</span></span> <span data-ttu-id="8b5ff-117">Le code suivant explique comment importer un module :</span><span class="sxs-lookup"><span data-stu-id="8b5ff-117">The following code describes how to import a module:</span></span>

```powershell
Import-Module myModule
```

<span data-ttu-id="8b5ff-118">En supposant que myModule était située dans le `PSModulePath`, PowerShell chargerait myModule dans la mémoire active.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-118">Assuming that myModule was located in the `PSModulePath`, PowerShell would load myModule into active memory.</span></span> <span data-ttu-id="8b5ff-119">Si myModule n’était pas situé sur un `PSModulePath` chemin d’accès, vous pouvez toujours explicitement demander PowerShell où les trouver :</span><span class="sxs-lookup"><span data-stu-id="8b5ff-119">If myModule was not located on a `PSModulePath` path, you could still explicitly tell PowerShell where to find it:</span></span>

```powershell
Import-Module -Name C:\myRandomDirectory\myModule -Verbose
```

<span data-ttu-id="8b5ff-120">Vous pouvez également utiliser le paramètre - verbose pour identifier ce qui est en cours d’exportation hors du module, et ce qui est en cours d’importation dans la mémoire active.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-120">You can also use the -verbose parameter to identify what is being exported out of the module, and what is being imported into active memory.</span></span> <span data-ttu-id="8b5ff-121">Exportations et importations limiter ce qui est exposé à l’utilisateur : la différence est qui contrôle la visibilité.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-121">Both exports and imports restrict what is exposed to the user: the difference is who is controlling the visibility.</span></span> <span data-ttu-id="8b5ff-122">Pour l’essentiel, les exportations sont contrôlées par le code dans le module.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-122">Essentially, exports are controlled by code within the module.</span></span> <span data-ttu-id="8b5ff-123">En revanche, les importations sont contrôlées par le `Import-Module` appeler.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-123">In contrast, imports are controlled by the `Import-Module` call.</span></span> <span data-ttu-id="8b5ff-124">Pour plus d’informations, consultez **limitant les membres que sont importés**, ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-124">For more information, see **Restricting Members That Are Imported**, below.</span></span>

## <a name="implicitly-importing-a-module-powershell-30"></a><span data-ttu-id="8b5ff-125">Implicitement l’importation d’un Module (PowerShell 3.0)</span><span class="sxs-lookup"><span data-stu-id="8b5ff-125">Implicitly Importing a Module (PowerShell 3.0)</span></span>

<span data-ttu-id="8b5ff-126">Modules à compter de Windows PowerShell 3.0, sont importés automatiquement lorsqu’une applet de commande ou une fonction dans le module est utilisée dans une commande.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-126">Beginning in Windows PowerShell 3.0, modules are imported automatically when any cmdlet or function in the module is used in a command.</span></span> <span data-ttu-id="8b5ff-127">Cette fonctionnalité fonctionne sur n’importe quel module dans un répertoire inclus dans la valeur de la **PSModulePath** variable d’environnement.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-127">This feature works on any module in a directory that this included in the value of the **PSModulePath** environment variable.</span></span> <span data-ttu-id="8b5ff-128">Si vous n’enregistrez pas toutefois de votre module sur un chemin d’accès valide, vous pouvez toujours charger à l’aide de la commande explicite [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, décrite ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-128">If you do not save your module on a valid path however, you can still load them using the explicit [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) option, described above.</span></span>

<span data-ttu-id="8b5ff-129">Les actions suivantes déclenchent l’importation automatique d’un module, également appelé « module de chargement automatique. »</span><span class="sxs-lookup"><span data-stu-id="8b5ff-129">The following actions trigger automatic importing of a module, also known as "module auto-loading."</span></span>

- <span data-ttu-id="8b5ff-130">À l’aide d’une applet de commande dans une commande.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-130">Using a cmdlet in a command.</span></span> <span data-ttu-id="8b5ff-131">Par exemple, si vous saisissez `Get-ExecutionPolicy` importe le module Microsoft.PowerShell.Security qui contient le `Get-ExecutionPolicy` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-131">For example, typing `Get-ExecutionPolicy` imports the Microsoft.PowerShell.Security module that contains the `Get-ExecutionPolicy` cmdlet.</span></span>

- <span data-ttu-id="8b5ff-132">À l’aide de la [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) pour obtenir la commande.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-132">Using the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet to get the command.</span></span>  <span data-ttu-id="8b5ff-133">Par exemple, si vous saisissez `Get-Command Get-JobTrigger` importe le **PSScheduledJob** module qui contient le `Get-JobTrigger` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-133">For example, typing `Get-Command Get-JobTrigger` imports the **PSScheduledJob** module that contains the `Get-JobTrigger` cmdlet.</span></span> <span data-ttu-id="8b5ff-134">Un `Get-Command` commande qui inclut des caractères génériques est considéré comme étant la découverte et ne déclenche pas l’importation d’un module.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-134">A `Get-Command` command that includes wildcard characters is considered to be discovery and does not trigger importing of a module.</span></span>

- <span data-ttu-id="8b5ff-135">À l’aide de la [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) applet de commande pour obtenir de l’aide pour une applet de commande.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-135">Using the [Get-Help](/powershell/module/Microsoft.PowerShell.Core/Get-Help) cmdlet to get help for a cmdlet.</span></span> <span data-ttu-id="8b5ff-136">Par exemple, si vous saisissez `Get-Help Get-WinEvent` importe le module Microsoft.PowerShell.Diagnostics qui contient le `Get-WinEvent` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-136">For example, typing `Get-Help Get-WinEvent` imports the Microsoft.PowerShell.Diagnostics module that contains the `Get-WinEvent` cmdlet.</span></span>

<span data-ttu-id="8b5ff-137">Pour prendre en charge l’importation automatique des modules, la `Get-Command` applet de commande Obtient toutes les applets de commande et fonctions dans tous les modules installés, même si le module n’est pas importé dans la session.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-137">To support automatic importing of modules, the `Get-Command` cmdlet gets all cmdlets and functions in all installed modules, even if the module is not imported into the session.</span></span> <span data-ttu-id="8b5ff-138">Pour plus d’informations, consultez la rubrique d’aide pour le [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) applet de commande.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-138">For more information, see the help topic for the [Get-Command](/powershell/module/Microsoft.PowerShell.Core/Get-Command) cmdlet.</span></span>

## <a name="the-importing-process"></a><span data-ttu-id="8b5ff-139">Le processus d’importation</span><span class="sxs-lookup"><span data-stu-id="8b5ff-139">The Importing Process</span></span>

<span data-ttu-id="8b5ff-140">Lorsqu’un module est importé, un état de nouvelle session est créé pour le module et un [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) objet est créé en mémoire.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-140">When a module is imported, a new session state is created for the module, and a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object is created in memory.</span></span> <span data-ttu-id="8b5ff-141">Un état de session est créé pour chaque module est importé (Cela inclut le module racine et tous les modules imbriqués).</span><span class="sxs-lookup"><span data-stu-id="8b5ff-141">A session-state is created for each module that is imported (this includes the root module and any nested modules).</span></span> <span data-ttu-id="8b5ff-142">Les membres qui sont exportés à partir du module racine, y compris tous les membres qui ont été exportées vers le module racine par tous les modules imbriqués, sont ensuite importés dans l’état de session de l’appelant.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-142">The members that are exported from the root module, including any members that were exported to the root module by any nested modules, are then imported into the caller's session state.</span></span>

<span data-ttu-id="8b5ff-143">Les métadonnées des membres qui sont exportés à partir d’un module ont une propriété de nom du module.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-143">The metadata of members that are exported from a module have a ModuleName property.</span></span> <span data-ttu-id="8b5ff-144">Cette propriété est remplie avec le nom du module qui les exporté.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-144">This property is populated with the name of the module that exported them.</span></span>

> [!WARNING]
> <span data-ttu-id="8b5ff-145">Si le nom d’un membre exporté utilise un verbe non approuvé ou si le nom du membre utilise des caractères interdits, un avertissement s’affiche lorsque le [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) applet de commande est exécutée.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-145">If the name of an exported member uses an unapproved verb or if the name of the member uses restricted characters, a warning is displayed when the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet is run.</span></span>

<span data-ttu-id="8b5ff-146">Par défaut, le [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) applet de commande ne retourne pas d’objets dans le pipeline.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-146">By default, the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet does not return any objects to the pipeline.</span></span> <span data-ttu-id="8b5ff-147">Toutefois, l’applet de commande prend en charge un `PassThru` paramètre qui peut être utilisée pour retourner un [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) objet pour chaque module est importé.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-147">However, the cmdlet supports a `PassThru` parameter that can be used to return a [System.Management.Automation.PSModuleInfo](/dotnet/api/System.Management.Automation.PSModuleInfo) object for each module that is imported.</span></span> <span data-ttu-id="8b5ff-148">Pour envoyer la sortie à l’hôte, les utilisateurs doivent exécuter la [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) applet de commande.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-148">To send output to the host, users should run the [Write-Host](/powershell/module/Microsoft.PowerShell.Utility/Write-Host) cmdlet.</span></span>

## <a name="restricting--the-members-that-are-imported"></a><span data-ttu-id="8b5ff-149">Limiter les membres qui sont importés</span><span class="sxs-lookup"><span data-stu-id="8b5ff-149">Restricting  the Members That Are Imported</span></span>

<span data-ttu-id="8b5ff-150">Lorsqu’un module est importé à l’aide de la [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) applet de commande, par défaut, tous les modules exportés membres sont importés dans la session, y compris toutes les commandes exportées vers le module par un module imbriqué.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-150">When a module is imported by using the [Import-Module](/powershell/module/Microsoft.PowerShell.Core/Import-Module) cmdlet, by default, all exported module members are imported into the session, including any commands exported to the module by a nested module.</span></span> <span data-ttu-id="8b5ff-151">Par défaut, les variables et les alias ne sont pas exportés.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-151">By default, variables and aliases are not exported.</span></span> <span data-ttu-id="8b5ff-152">Pour limiter les membres qui sont exportées, utilisez un [manifeste de module](./how-to-write-a-powershell-module-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="8b5ff-152">To restrict the members that are exported, use a [module manifest](./how-to-write-a-powershell-module-manifest.md).</span></span> <span data-ttu-id="8b5ff-153">Pour restreindre les membres qui sont importés, utilisez les paramètres suivants de la `Import-Module` applet de commande.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-153">To restrict the members that are imported, use the following parameters of the `Import-Module` cmdlet.</span></span>

- <span data-ttu-id="8b5ff-154">`Function` : Ce paramètre limite les fonctions qui sont exportées.</span><span class="sxs-lookup"><span data-stu-id="8b5ff-154">`Function`: This parameter restricts the functions that are exported.</span></span> <span data-ttu-id="8b5ff-155">(Si vous utilisez un manifeste de module, consultez la clé de FunctionsToExport.)</span><span class="sxs-lookup"><span data-stu-id="8b5ff-155">(If you are using a module manifest, see the FunctionsToExport key.)</span></span>

- <span data-ttu-id="8b5ff-156">`Cmdlet` : Ce paramètre limite les applets de commande qui sont exportés (si vous utilisez un manifeste, voir module la clé de CmdletsToExport.)</span><span class="sxs-lookup"><span data-stu-id="8b5ff-156">`Cmdlet`: This parameter restricts the cmdlets that are exported (If you are using a module manifest, see the CmdletsToExport key.)</span></span>

- <span data-ttu-id="8b5ff-157">`Variable` : Ce paramètre limite les variables qui sont exportés (si vous utilisez un manifeste, voir module la clé VariablesToExport.)</span><span class="sxs-lookup"><span data-stu-id="8b5ff-157">`Variable`: This parameter restricts the variables that are exported (If you are using a module manifest, see the VariablesToExport key.)</span></span>

- <span data-ttu-id="8b5ff-158">`Alias` : Ce paramètre limite les alias qui sont exportés (si vous utilisez un manifeste, voir module la clé AliasesToExport.)</span><span class="sxs-lookup"><span data-stu-id="8b5ff-158">`Alias`: This parameter restricts the aliases that are exported (If you are using a module manifest, see the AliasesToExport key.)</span></span>

## <a name="see-also"></a><span data-ttu-id="8b5ff-159">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="8b5ff-159">See Also</span></span>

[<span data-ttu-id="8b5ff-160">Écrire un Module PowerShell de Windows</span><span class="sxs-lookup"><span data-stu-id="8b5ff-160">Writing a Windows PowerShell Module</span></span>](./writing-a-windows-powershell-module.md)
